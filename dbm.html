<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>DBM Module &#8212; Database Release Manager</title>
    
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/dbrm.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootswatch-3.3.6/superhero/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Logfile Module" href="logfile.html" />
    <link rel="prev" title="&lt;no title&gt;" href="index.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          Database Release Manager</a>
        <span class="navbar-text navbar-version pull-left"><b>0.1.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Dbm Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="logfile.html">Logfile Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="common.html">Commons API</a></li>
<li class="toctree-l1"><a class="reference internal" href="mysql.html">Mysql API</a></li>
<li class="toctree-l1"><a class="reference internal" href="sqlplus.html">Sqlplus API</a></li>
<li class="toctree-l1"><a class="reference internal" href="psql.html">Psql API</a></li>
<li class="toctree-l1"><a class="reference internal" href="commons_mariadb.html">Commons Mariadb API</a></li>
<li class="toctree-l1"><a class="reference internal" href="commons_oracle.html">Commons Oracle API</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">DBM Module</a><ul>
<li><a class="reference internal" href="#variables">Variables</a></li>
<li><a class="reference internal" href="#commands">Commands</a><ul>
<li><a class="reference internal" href="#dbm-version">dbm version</a></li>
<li><a class="reference internal" href="#dbm-info">dbm info</a></li>
<li><a class="reference internal" href="#dbm-initenv">dbm initenv</a><ul>
<li><a class="reference internal" href="#initenv-options">initenv options:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dbm-shell">dbm shell</a></li>
<li><a class="reference internal" href="#dbm-show-profiles">dbm show_profiles</a></li>
<li><a class="reference internal" href="#dbm-show-releases">dbm show_releases</a><ul>
<li><a class="reference internal" href="#show-releases-options">show_releases options:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dbm-show-scripts">dbm show_scripts</a></li>
<li><a class="reference internal" href="#dbm-show-script-types">dbm show_script_types</a></li>
<li><a class="reference internal" href="#dbm-show-rel-dep">dbm show_rel_dep</a></li>
<li><a class="reference internal" href="#dbm-show-inhibit-scripts">dbm show_inhibit_scripts</a></li>
<li><a class="reference internal" href="#dbm-show-rel-ded-scripts">dbm show_rel_ded_scripts</a></li>
<li><a class="reference internal" href="#dbm-show-adapters">dbm show_adapters</a></li>
<li><a class="reference internal" href="#dbm-move-release">dbm move_release</a><ul>
<li><a class="reference internal" href="#move-release-options">move_release options:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dbm-update-release">dbm update_release</a><ul>
<li><a class="reference internal" href="#update-release-options">update_release options:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dbm-add-profile">dbm add_profile</a><ul>
<li><a class="reference internal" href="#app-profile-options">app_profile options:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dbm-del-profile">dbm del_profile</a><ul>
<li><a class="reference internal" href="#del-profile-options">del_profile options:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dbm-set-profile">dbm set_profile</a><ul>
<li><a class="reference internal" href="#set-profile-options">set_profile options:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dbm-insert-release">dbm insert_release</a><ul>
<li><a class="reference internal" href="#insert-release-options">insert_release options:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dbm-remove-release">dbm remove_release</a><ul>
<li><a class="reference internal" href="#remove-release-options">remove_release options:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dbm-remove-script">dbm remove_script</a><ul>
<li><a class="reference internal" href="#remove-script-options">remove_script options:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dbm-update-script">dbm update_script</a><ul>
<li><a class="reference internal" href="#update-script-options">update_script options:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dbm-insert-script">dbm insert_script</a><ul>
<li><a class="reference internal" href="#insert-script-options">insert_script options:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dbm-insert-script-type">dbm insert_script_type</a><ul>
<li><a class="reference internal" href="#insert-script-type-options">insert_script_type options:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dbm-insert-rel-dep">dbm insert_rel_dep</a><ul>
<li><a class="reference internal" href="#insert-rel-dep-options">insert_rel_dep options:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dbm-remove-rel-dep">dbm remove_rel_dep</a><ul>
<li><a class="reference internal" href="#remove-rel-dep-options">remove_rel_dep options:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dbm-insert-inhibit-script">dbm insert_inhibit_script</a><ul>
<li><a class="reference internal" href="#insert-inhibit-script-options">insert_inhibit_script options:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dbm-insert-ded-script">dbm insert_ded_script</a><ul>
<li><a class="reference internal" href="#insert-ded-script-options">insert_ded_script options:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dbm-remove-inhibit-script">dbm remove_inhibit_script</a><ul>
<li><a class="reference internal" href="#remove-inhibit-script-options">remove_inhibit_script options:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dbm-remove-ded-script">dbm remove_ded_script</a><ul>
<li><a class="reference internal" href="#remove-ded-script-options">remove_ded_script options:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dbm-show-branches">dbm show_branches</a></li>
<li><a class="reference internal" href="#dbm-insert-branch">dbm insert_branch</a><ul>
<li><a class="reference internal" href="#insert-branch-options">insert_branch options:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dbm-move-script">dbm move_script</a><ul>
<li><a class="reference internal" href="#move-script-options">move_script options:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dbm-upgrade">dbm upgrade</a></li>
</ul>
</li>
<li><a class="reference internal" href="#api">API</a><ul>
<li><a class="reference internal" href="#dbm-init">_dbm_init</a></li>
<li><a class="reference internal" href="#dbm-post-init">_dbm_post_init</a></li>
<li><a class="reference internal" href="#dbm-upgrade">_dbm_upgrade</a></li>
<li><a class="reference internal" href="#dbm-how-many-profiles">_dbm_how_many_profiles</a></li>
<li><a class="reference internal" href="#dbm-get-profile-by-name">_dbm_get_profile_by_name</a></li>
<li><a class="reference internal" href="#dbm-get-default-profile-filepath">_dbm_get_default_profile_filepath</a></li>
<li><a class="reference internal" href="#dbm-check-if-exist-prof-byid">_dbm_check_if_exist_prof_byid</a></li>
<li><a class="reference internal" href="#dbm-check-if-exist-prof-byname">_dbm_check_if_exist_prof_byname</a></li>
<li><a class="reference internal" href="#dbm-check-if-exist-rel">_dbm_check_if_exist_rel</a></li>
<li><a class="reference internal" href="#dbm-retrieve-script-data">_dbm_retrieve_script_data</a></li>
<li><a class="reference internal" href="#dbm-retrieve-first-release">_dbm_retrieve_first_release</a></li>
<li><a class="reference internal" href="#dbm-check-if-exist-id-script">_dbm_check_if_exist_id_script</a></li>
<li><a class="reference internal" href="#dbm-check-if-exist-id-branch">_dbm_check_if_exist_id_branch</a></li>
<li><a class="reference internal" href="#dbm-check-if-exist-id-rel">_dbm_check_if_exist_id_rel</a></li>
<li><a class="reference internal" href="#dbm-retrieve-field-rel">_dbm_retrieve_field_rel</a></li>
<li><a class="reference internal" href="#dbm-retrieve-field-rel-byid">_dbm_retrieve_field_rel_byid</a></li>
<li><a class="reference internal" href="#dbm-retrieve-field-script">_dbm_retrieve_field_script</a></li>
<li><a class="reference internal" href="#dbm-get-table-schema">_dbm_get_table_schema</a></li>
<li><a class="reference internal" href="#dbm-remove-all-scripts-rel-inhib">_dbm_remove_all_scripts_rel_inhib</a></li>
<li><a class="reference internal" href="#dbm-remove-release">_dbm_remove_release</a></li>
<li><a class="reference internal" href="#dbm-update-idorder">_dbm_update_idorder</a></li>
<li><a class="reference internal" href="#dbm-remove-all-scripts-rel-ded">_dbm_remove_all_scripts_rel_ded</a></li>
<li><a class="reference internal" href="#dbm-save2undo">_dbm_save2undo</a></li>
<li><a class="reference internal" href="#dbm-save2history">_dbm_save2history</a></li>
<li><a class="reference internal" href="#dbm-exts-check-extensions">_dbm_exts_check_extensions</a></li>
<li><a class="reference internal" href="#dbm-exts-is-present">_dbm_exts_is_present</a></li>
<li><a class="reference internal" href="#dbm-exts-inst-extension">_dbm_exts_inst_extension</a></li>
<li><a class="reference internal" href="#dbm-exts-update-extension">_dbm_exts_update_extension</a></li>
<li><a class="reference internal" href="#dbm-exts-update-extension">_dbm_exts_update_extension</a></li>
<li><a class="reference internal" href="#dbm-exts-check-dbm">_dbm_exts_check_dbm</a></li>
<li><a class="reference internal" href="#dbm-initenv-help">_dbm_initenv_help</a></li>
<li><a class="reference internal" href="#dbm-check-initenv-args">_dbm_check_initenv_args</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="index.html" title="Previous Chapter: <no title>"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; <no title></span>
    </a>
  </li>
  <li>
    <a href="logfile.html" title="Next Chapter: Logfile Module"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Logfile Module &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row" >
    <div class="col-md-12 content">
      
  <div class="section" id="dbm-module">
<span id="dbm-module"></span><h1>DBM Module<a class="headerlink" href="#dbm-module" title="Permalink to this headline">¶</a></h1>
<p>Core module that contains features for manage <code class="docutils literal"><span class="pre">dbrm</span></code> configuration and projects management.
Currently, only management of profiles is a stable features; all others features to store and manage scripts and releases are under heavy development.</p>
<div class="section" id="variables">
<span id="variables"></span><h2>Variables<a class="headerlink" href="#variables" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><table border="1" class="colwidths-given docutils">
<colgroup>
<col width="33%" />
<col width="67%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Variable</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">DEBUG</span></code></td>
<td>Contains a Boolean value for enable/disable debugging output.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">MODULES_DIR</span></code></td>
<td>Contains path where retrieve dbrm modules files. Normally is set in general configuration file under /etc/dbrm.conf</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">LOCAL_DIR</span></code></td>
<td>Contains directory path of the project to manage.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">LOCAL_CONFIG_FILE</span></code></td>
<td>Through this variable is possible override and customize dbrm properties set on generic configuration file.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">DRM_DB</span></code></td>
<td>Contains path of Sqlite internal database used by dbrm. Default path is <em>$HOME/.local/share/dbrm/dbrm.db</em></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">SQLCA</span></code></td>
<td>SQLCA (SQL Connector Adapter) contains list of database enabled adapters. Multiple adapters are seperated by pipe (<cite>|</cite>).
Example: <cite>oracle|mariadb</cite></td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">DRM_PROFILE</span></code></td>
<td>Enable (value 1) or Disable (value 0 or variable not set) DBM Profiles Feature. Normally used to manage different configuration files for
every environment (dev, test, production, etc.)</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">DRM_PROFILES_PATH</span></code></td>
<td>Define directory path used by <cite>dbrm</cite> as prefix path of profile files.
Default path is: <em>$HOME/.local/share/dbrm/profiles</em>.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">DBM_HISTORY</span></code></td>
<td>Contains history of all execute command by dbrm. (Under development: Not all modules store on history).</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">DBM_UNDO_SCRIPT</span></code></td>
<td>Contains path of the file where dbrm write undo command to revert changes done.
(Under development: not all modules write to <em>undo</em> files)</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
<div class="section" id="commands">
<span id="commands"></span><h2>Commands<a class="headerlink" href="#commands" title="Permalink to this headline">¶</a></h2>
<div class="section" id="dbm-version">
<span id="dbm-version"></span><h3>dbm version<a class="headerlink" href="#dbm-version" title="Permalink to this headline">¶</a></h3>
<p>Show version of dbm module.</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>  <span class="nv">$#</span> dbrm dbm version
  Version: 0.1.0
</pre></div>
</div>
</div>
<div class="section" id="dbm-info">
<span id="dbm-info"></span><h3>dbm info<a class="headerlink" href="#dbm-info" title="Permalink to this headline">¶</a></h3>
<p>Show active parameters of dbrm module.</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>  <span class="nv">$#</span> dbrm dbm info
  <span class="nv">LOCAL_DIR</span> <span class="o">=</span> /tmp/database-release-manager
  <span class="nv">LOCAL_CONFIG_FILE</span> <span class="o">=</span> /home/geaaru/.local/share/dbrm/dbrm.conf
  <span class="nv">MODULES_DIR</span> <span class="o">=</span> /usr/share/dbrm/modules
  <span class="nv">SQLCA</span> <span class="o">=</span> sqlite<span class="p">|</span>mariadb<span class="p">|</span>psql
  <span class="nv">DRM_DB</span> <span class="o">=</span> ./test.db
  <span class="nv">DBM_HISTORY</span> <span class="o">=</span> /tmp/database-release-manager/.dbm_history
  <span class="nv">DRM_PROFILE</span> <span class="o">=</span> 1
  <span class="nv">DRM_PROFILES_PATH</span> <span class="o">=</span> /home/geaaru/.local/share/dbrm/profiles
  <span class="nv">MARIADB_USER</span> <span class="o">=</span> root
  <span class="nv">MARIADB_PWD</span> <span class="o">=</span> <span class="nb">pwd</span>
  <span class="nv">MARIADB_DB</span> <span class="o">=</span> <span class="nb">test</span>
  <span class="nv">MARIADB_HOST</span> <span class="o">=</span>
  <span class="nv">MARIADB_DIR</span> <span class="o">=</span> .
  <span class="nv">MARIADB_TMZ</span> <span class="o">=</span> UTC
  <span class="nv">MARIADB_COMPILE_FILES_EXCLUDED</span> <span class="o">=</span>
  <span class="nv">MARIADB_EXTRA_OPTIONS</span> <span class="o">=</span>
  <span class="nv">MARIADB_ENABLE_COMMENTS</span> <span class="o">=</span>
  <span class="nv">SQLITEDB</span> <span class="o">=</span> ./test.db
</pre></div>
</div>
<p>TODO:</p>
<ul class="simple">
<li>Execute call of info modules to every connector adapter without statically manage it inside this function.</li>
</ul>
</div>
<div class="section" id="dbm-initenv">
<span id="dbm-initenv"></span><h3>dbm initenv<a class="headerlink" href="#dbm-initenv" title="Permalink to this headline">¶</a></h3>
<p>Create a new empty dbrm database and copy example file of dbrm.conf on new project directory.</p>
<div class="section" id="initenv-options">
<span id="initenv-options"></span><h4>initenv options:<a class="headerlink" href="#initenv-options" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">--to-current-dir</span></code>: Initialize dbrm stuff on current directory [.]. If this option is used is not possible use
&#8211;to-dir option.</li>
<li><code class="docutils literal"><span class="pre">--to-dir</span> <span class="pre">&lt;TARGET_DIR&gt;</span></code>: Initialize dbrm stuff on a target directory passed in input.</li>
<li><code class="docutils literal"><span class="pre">--enable-profiles</span></code>: Enable Profiles Features on new project.</li>
<li><code class="docutils literal"><span class="pre">--help|-h</span></code>: Show initenv command options.</li>
</ul>
<p><em>Exit Values</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">1</span></code>: On error or if a dbrm.conf file or dbrm.db file is already present.</li>
<li><code class="docutils literal"><span class="pre">0</span></code>: On success</li>
</ul>
<div class="highlight-shell"><div class="highlight"><pre><span></span>  <span class="nv">$#</span> dbrm dbm initenv --help
  <span class="o">[</span>--to-current-dir<span class="o">]</span>      Initialize current directory <span class="o">[</span>.<span class="o">]</span>.
  <span class="o">[</span>--to-dir target<span class="o">]</span>       Initialize target directory.
  <span class="o">[</span>--enable-profiles<span class="o">]</span>     Enable profiles mode and create related directories.
  <span class="o">[</span>--help<span class="p">|</span>-h<span class="o">]</span>             Show <span class="nb">help</span> message.

  <span class="nv">$#</span> dbrm dbm initenv --to-dir /tmp/dbrm --enable-profiles 
  Creating database /tmp/dbrm/dbrm.db...OK
  Created profile 1.
  Directory is now initialized.
  Modify dev.conf file under dbrm-profile directory <span class="k">for</span> <span class="nb">complete</span> configuration.
</pre></div>
</div>
<p>TODO:</p>
<ul class="simple">
<li>Add option to initialized initenv method of a list of connection adapters.</li>
</ul>
</div>
</div>
<div class="section" id="dbm-shell">
<span id="dbm-shell"></span><h3>dbm shell<a class="headerlink" href="#dbm-shell" title="Permalink to this headline">¶</a></h3>
<p>Enter on dbm sqlite database file.</p>
<p><em>Exit Values</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">1</span></code>: On error</li>
<li><code class="docutils literal"><span class="pre">0</span></code>: On success</li>
</ul>
<div class="highlight-shell"><div class="highlight"><pre><span></span><span class="nv">$#</span> dbrm dbm shell
SQLite version 3.13.0 2016-05-18 10:57:30
Enter <span class="s2">&quot;.help&quot;</span> <span class="k">for</span> usage hints.
sqlite&gt;
</pre></div>
</div>
</div>
<div class="section" id="dbm-show-profiles">
<span id="dbm-show-profiles"></span><h3>dbm show_profiles<a class="headerlink" href="#dbm-show-profiles" title="Permalink to this headline">¶</a></h3>
<p>Show list of configured profiles. This method is used only if Profiles Feature is enabled.</p>
<p><em>Exit Values</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">1</span></code>: On error</li>
<li><code class="docutils literal"><span class="pre">0</span></code>: On success</li>
</ul>
<div class="highlight-shell"><div class="highlight"><pre><span></span>  <span class="nv">$#</span> dbrm dbm <span class="nv">show_profiles</span>
  <span class="o">===============================================================================================================</span>
  ID      PROFILE_NAME           DEFAULT        CONFIG_FILE            CREATION_DATE          <span class="nv">UPDATE_DATE</span>
  <span class="o">===============================================================================================================</span>
  <span class="m">1</span>       test1                                test.conf              2015-01-18 15:17:43    2015-01-18 21:25:25
  <span class="m">2</span>       dev                   *              dev.conf               2015-01-18 16:59:17    2015-01-18 21:29:57
</pre></div>
</div>
<p>On example, files test.conf and dev.conf must be under directory defined by <em>DRM_PROFILES_PATH</em> variable.</p>
</div>
<div class="section" id="dbm-show-releases">
<span id="dbm-show-releases"></span><h3>dbm show_releases<a class="headerlink" href="#dbm-show-releases" title="Permalink to this headline">¶</a></h3>
<p>Show releases history.</p>
<div class="section" id="show-releases-options">
<span id="show-releases-options"></span><h4>show_releases options:<a class="headerlink" href="#show-releases-options" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">-b</span> <span class="pre">ID_BRANCH</span></code>: Filter list for a particular Branch Id.</li>
<li><code class="docutils literal"><span class="pre">-h</span></code>: Show show_releases command options.</li>
</ul>
<p><em>Exit Values</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">1</span></code>: On error</li>
<li><code class="docutils literal"><span class="pre">0</span></code>: On success</li>
</ul>
<div class="highlight-shell"><div class="highlight"><pre><span></span>  <span class="nv">$#</span> dbrm dbm <span class="nv">show_releases</span>
  <span class="o">===============================================================================================================</span>
  ID    RELEASE_DATE          VERSION  UPDATE_DATE          ADAPTER   ID_ORDER  BRANCH  DIRECTORY  <span class="nv">NAME</span>
  <span class="o">===============================================================================================================</span>
  <span class="m">1</span>     2013-05-05 20:41:29   0.1.0    2013-05-08 13:04:56  oracle    <span class="m">1</span>         <span class="m">1</span>       .          Test Platform
  <span class="m">4</span>     2013-05-06 14:50:29   0.1.1    2013-11-18 01:11:35  oracle    <span class="m">1</span>         <span class="m">2</span>       .          Test Platform
  <span class="m">9</span>     2013-11-18 01:09:14   0.2.0    2013-11-18 01:09:14  oracle    <span class="m">2</span>         <span class="m">1</span>       .          Test Platform
  <span class="m">5</span>     2013-11-18 00:33:10   0.1.2    2013-11-18 01:11:35  oracle    <span class="m">2</span>         <span class="m">2</span>       .          Test Platform
  <span class="m">12</span>    2013-11-18 00:00:01   0.3.0    2013-11-18 01:15:47  oracle    <span class="m">3</span>         <span class="m">1</span>       .          Test Platform
  <span class="m">13</span>    2013-11-18 00:00:01   0.4.0    2013-11-18 01:15:47  oracle    <span class="m">4</span>         <span class="m">1</span>       .          Test Platform
</pre></div>
</div>
<p>TODO:</p>
<ul class="simple">
<li>Manage help message like other modules with both -h and &#8211;help options.</li>
</ul>
</div>
</div>
<div class="section" id="dbm-show-scripts">
<span id="dbm-show-scripts"></span><h3>dbm show_scripts<a class="headerlink" href="#dbm-show-scripts" title="Permalink to this headline">¶</a></h3>
<p>Show list of scripts configured and assigned to a release.</p>
<p><em>Exit Values</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">1</span></code>: On error</li>
<li><code class="docutils literal"><span class="pre">0</span></code>: On success</li>
</ul>
<div class="highlight-shell"><div class="highlight"><pre><span></span>  <span class="nv">$#</span> dbrm dbm show_scripts -h
  <span class="o">===============================================================================================================</span>
  ID  TYPE           ACTIVE  DIRECTORY           ID_RELEASE  ID_ORDER  UPDATE_DATE             <span class="nv">FILENAME</span>
  <span class="o">===============================================================================================================</span>
  <span class="m">1</span>   update_script  <span class="m">1</span>       update_script/      <span class="m">1</span>           <span class="m">1</span>         2013-05-05 21:26:37     update__0.1.0.sql
  <span class="m">6</span>   update_script  <span class="m">1</span>       update_script/      <span class="m">4</span>           <span class="m">1</span>         2013-05-06 14:52:30     patch_0_1.1.sql
  <span class="m">4</span>   update_script  <span class="m">1</span>       update_script/      <span class="m">9</span>           <span class="m">1</span>         2014-02-03 16:25:45     update_0.2.0.sql
  <span class="m">5</span>   update_script  <span class="m">1</span>       update_script/      <span class="m">12</span>          <span class="m">1</span>         2014-02-03 16:25:21     update_0.3.0.sql
</pre></div>
</div>
<p>TODO:</p>
<ul class="simple">
<li>Manage help message like other modules with both -h and &#8211;help options.</li>
<li>Add filter options (for id release, filename, etc.)</li>
</ul>
</div>
<div class="section" id="dbm-show-script-types">
<span id="dbm-show-script-types"></span><h3>dbm show_script_types<a class="headerlink" href="#dbm-show-script-types" title="Permalink to this headline">¶</a></h3>
<p>Show list of script types.</p>
<p><em>Exit Values</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">1</span></code>: On error</li>
<li><code class="docutils literal"><span class="pre">0</span></code>: On success</li>
</ul>
<div class="highlight-shell"><div class="highlight"><pre><span></span>  <span class="nv">$#</span> dbrm dbm <span class="nv">show_script_types</span>
  <span class="o">===============================================================================================================</span>
  CODE                <span class="nv">DESCRIPTION</span>
  <span class="o">===============================================================================================================</span>
  foreign_key         Foreign Key Script
  <span class="k">function</span>            Function definition script
  initial_ddl         Initial DDL Script
  insert              Insert on table script
  package             Package definition script
  procedure           Procedure definition script
  sequence            Sequences Script
  trigger             Trigger Script
  <span class="nb">type</span>                Types Script <span class="o">(</span>For example <span class="k">for</span> a TYPE definition on Oracle<span class="o">)</span>
  update_script       Update Script
  view                View definition script
</pre></div>
</div>
</div>
<div class="section" id="dbm-show-rel-dep">
<span id="dbm-show-rel-dep"></span><h3>dbm show_rel_dep<a class="headerlink" href="#dbm-show-rel-dep" title="Permalink to this headline">¶</a></h3>
<p>Show list of releases dependencies with scripts.</p>
<p><em>Exit Values</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">1</span></code>: On error</li>
<li><code class="docutils literal"><span class="pre">0</span></code>: On success</li>
</ul>
<div class="highlight-shell"><div class="highlight"><pre><span></span>  <span class="nv">$#</span> dbrm dbm <span class="nv">show_rel_dep</span>
  <span class="o">===============================================================================================================</span>
  ID_RELEASE     DEPENDENCY     <span class="nv">CREATION_DATE</span>
  <span class="o">===============================================================================================================</span>
  <span class="m">2</span>              <span class="m">1</span>              2013-05-05 21:58:58
  <span class="m">3</span>              <span class="m">1</span>              2013-05-05 21:59:10
  <span class="m">3</span>              <span class="m">2</span>              2013-05-05 21:58:53
  <span class="m">3</span>              <span class="m">4</span>              2013-05-06 14:55:01
</pre></div>
</div>
</div>
<div class="section" id="dbm-show-inhibit-scripts">
<span id="dbm-show-inhibit-scripts"></span><h3>dbm show_inhibit_scripts<a class="headerlink" href="#dbm-show-inhibit-scripts" title="Permalink to this headline">¶</a></h3>
<p>Show list of inhibitions scripts between releases.</p>
<p><em>Exit Values</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">1</span></code>: On error</li>
<li><code class="docutils literal"><span class="pre">0</span></code>: On success</li>
</ul>
<div class="highlight-shell"><div class="highlight"><pre><span></span>  <span class="nv">$#</span> dbrm dbm <span class="nv">show_inhibit_scripts</span>
  <span class="o">===============================================================================================================</span>
  ID_SCRIPT       ID_RELEASE_FROM ID_RELEASE_TO   <span class="nv">CREATION_DATE</span>
  <span class="o">===============================================================================================================</span>
  <span class="m">6</span>               <span class="m">1</span>               <span class="m">2</span>               2013-05-05 23:33:12
</pre></div>
</div>
</div>
<div class="section" id="dbm-show-rel-ded-scripts">
<span id="dbm-show-rel-ded-scripts"></span><h3>dbm show_rel_ded_scripts<a class="headerlink" href="#dbm-show-rel-ded-scripts" title="Permalink to this headline">¶</a></h3>
<p>Show list of release dedicated scripts.</p>
<p><em>Exit Values</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">1</span></code>: On error</li>
<li><code class="docutils literal"><span class="pre">0</span></code>: On success</li>
</ul>
<div class="highlight-shell"><div class="highlight"><pre><span></span>  <span class="nv">$#</span> dbrm dbm show_rel_ded_scripts
  No scripts available.
</pre></div>
</div>
</div>
<div class="section" id="dbm-show-adapters">
<span id="dbm-show-adapters"></span><h3>dbm show_adapters<a class="headerlink" href="#dbm-show-adapters" title="Permalink to this headline">¶</a></h3>
<p>Show list of adapters availables.</p>
<p><em>Exit Values</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">1</span></code>: On error</li>
<li><code class="docutils literal"><span class="pre">0</span></code>: On success</li>
</ul>
<div class="highlight-shell"><div class="highlight"><pre><span></span>  $ dbrm dbm <span class="nv">show_adapters</span>
  <span class="o">===============================================================================================================</span>
  ADAPTER        <span class="nv">DESCRIPTION</span>
  <span class="o">===============================================================================================================</span>
  mariadb        MySQL/MariaDb Database Adapter
  oracle         Oracle Database Adapter
  sqlite         SQLite Database Adapter
</pre></div>
</div>
</div>
<div class="section" id="dbm-move-release">
<span id="dbm-move-release"></span><h3>dbm move_release<a class="headerlink" href="#dbm-move-release" title="Permalink to this headline">¶</a></h3>
<p>Move release position of the same Branch.</p>
<div class="section" id="move-release-options">
<span id="move-release-options"></span><h4>move_release options:<a class="headerlink" href="#move-release-options" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">-r</span> <span class="pre">VERSION</span></code>: Version of the release to move</li>
<li><code class="docutils literal"><span class="pre">-n</span> <span class="pre">NAME</span></code>: Name of the release to move</li>
<li><code class="docutils literal"><span class="pre">-a</span> <span class="pre">VERSION_TO</span></code>: Move selected release <em>after</em> VERSION_TO</li>
<li><code class="docutils literal"><span class="pre">-b</span> <span class="pre">VERSION_TO</span></code>: Move selected release <em>before</em> VERSION_TO</li>
<li><code class="docutils literal"><span class="pre">-h</span></code>: Show move_release command options.</li>
</ul>
<p><em>Exit Values</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">1</span></code>: On error.</li>
<li><code class="docutils literal"><span class="pre">0</span></code>: On success</li>
</ul>
<p>TODO:</p>
<ul class="simple">
<li>add long options arguments.</li>
</ul>
</div>
</div>
<div class="section" id="dbm-update-release">
<span id="dbm-update-release"></span><h3>dbm update_release<a class="headerlink" href="#dbm-update-release" title="Permalink to this headline">¶</a></h3>
<p>Update information about a particular release.</p>
<div class="section" id="update-release-options">
<span id="update-release-options"></span><h4>update_release options:<a class="headerlink" href="#update-release-options" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">-n</span> <span class="pre">NAME</span></code>: Name of the release to update.</li>
<li><code class="docutils literal"><span class="pre">-v</span> <span class="pre">VERSION</span></code>: Version of the release to update.</li>
<li><code class="docutils literal"><span class="pre">-d</span> <span class="pre">YYYY-MM-DD</span></code>: Date of the release to update.</li>
<li><code class="docutils literal"><span class="pre">-a</span> <span class="pre">ADAPTER</span></code>: Adapter value to update on release.</li>
<li><code class="docutils literal"><span class="pre">-b</span> <span class="pre">ID_BRANCH</span></code>: Branch Id value to update on release.</li>
<li><code class="docutils literal"><span class="pre">-i</span> <span class="pre">ID_RELEASE</span></code>: Id of the release to update</li>
<li><code class="docutils literal"><span class="pre">--dir</span> <span class="pre">DIR</span></code>: Directory of the release to update</li>
<li><code class="docutils literal"><span class="pre">-h</span></code>: Show update_release command options.</li>
</ul>
<p><em>Exit Values</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">1</span></code>: On error.</li>
<li><code class="docutils literal"><span class="pre">0</span></code>: On success</li>
</ul>
<div class="highlight-shell"><div class="highlight"><pre><span></span>  <span class="nv">$#</span> dbrm dbm update_release -i <span class="m">5</span> -a oracle -d ./0.1.2
  Release <span class="m">5</span> updated correctly.
</pre></div>
</div>
</div>
</div>
<div class="section" id="dbm-add-profile">
<span id="dbm-add-profile"></span><h3>dbm add_profile<a class="headerlink" href="#dbm-add-profile" title="Permalink to this headline">¶</a></h3>
<p>Insert a new configuration profile.</p>
<div class="section" id="app-profile-options">
<span id="app-profile-options"></span><h4>app_profile options:<a class="headerlink" href="#app-profile-options" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">--name</span> <span class="pre">NAME</span></code>: Name of the profile to insert.</li>
<li><code class="docutils literal"><span class="pre">--file</span> <span class="pre">FILE</span></code>: Configuration file to use on new profile. FILE contains only filename.</li>
<li><code class="docutils literal"><span class="pre">--default</span></code>: Enable new profile as default.</li>
<li><code class="docutils literal"><span class="pre">-h</span></code>: Show app_profile command options.</li>
</ul>
<p><em>Exit Values</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">1</span></code>: On error.</li>
<li><code class="docutils literal"><span class="pre">0</span></code>: On success</li>
</ul>
<div class="highlight-shell"><div class="highlight"><pre><span></span>  <span class="nv">$#</span> dbrm dbm add_profile --name test_profile --file profile1.conf
  Created profile 7.
</pre></div>
</div>
</div>
</div>
<div class="section" id="dbm-del-profile">
<span id="dbm-del-profile"></span><h3>dbm del_profile<a class="headerlink" href="#dbm-del-profile" title="Permalink to this headline">¶</a></h3>
<p>Delete a configured profile.</p>
<div class="section" id="del-profile-options">
<span id="del-profile-options"></span><h4>del_profile options:<a class="headerlink" href="#del-profile-options" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">--name</span> <span class="pre">NAME</span></code>: Name of the profile to delete.</li>
<li><code class="docutils literal"><span class="pre">--id</span> <span class="pre">ID_PROFILE</span></code>: Id of the profile to delete</li>
<li><code class="docutils literal"><span class="pre">-h</span></code>: Show del_profile command options.</li>
</ul>
<p><em>Exit Values</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">1</span></code>: On error.</li>
<li><code class="docutils literal"><span class="pre">0</span></code>: On success</li>
</ul>
<div class="highlight-shell"><div class="highlight"><pre><span></span>  <span class="nv">$#</span> dbrm dbm del_profile --id 7
  Profile <span class="m">7</span> is been deleted.
</pre></div>
</div>
</div>
</div>
<div class="section" id="dbm-set-profile">
<span id="dbm-set-profile"></span><h3>dbm set_profile<a class="headerlink" href="#dbm-set-profile" title="Permalink to this headline">¶</a></h3>
<p>Set default profile.</p>
<div class="section" id="set-profile-options">
<span id="set-profile-options"></span><h4>set_profile options:<a class="headerlink" href="#set-profile-options" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">--name</span> <span class="pre">PROFILE_NAME</span></code>: Name of the profile to set.</li>
<li><code class="docutils literal"><span class="pre">--id</span> <span class="pre">ID_PROFILE</span></code>: Id of the profile to set.</li>
<li><code class="docutils literal"><span class="pre">-h</span></code>: Show set_profile command options.</li>
</ul>
<p><em>Exit Values</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">1</span></code>: On error.</li>
<li><code class="docutils literal"><span class="pre">0</span></code>: On success</li>
</ul>
<div class="highlight-shell"><div class="highlight"><pre><span></span>  <span class="nv">$#</span> dbrm dbm set_profile --id 7
  Profile <span class="m">7</span> is now <span class="nb">set</span> as default.
</pre></div>
</div>
</div>
</div>
<div class="section" id="dbm-insert-release">
<span id="dbm-insert-release"></span><h3>dbm insert_release<a class="headerlink" href="#dbm-insert-release" title="Permalink to this headline">¶</a></h3>
<p>Insert a new release to project.</p>
<div class="section" id="insert-release-options">
<span id="insert-release-options"></span><h4>insert_release options:<a class="headerlink" href="#insert-release-options" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">-n</span> <span class="pre">RELEASE_NAME</span></code>: Name of the release to add.</li>
<li><code class="docutils literal"><span class="pre">-d</span> <span class="pre">YYYY-MM-DD</span></code>: Release date of the release to add.</li>
<li><code class="docutils literal"><span class="pre">-v</span> <span class="pre">VERSION</span></code>: Version of the release to add.</li>
<li><code class="docutils literal"><span class="pre">-a</span> <span class="pre">ADAPTER</span></code>: Adapter used by the release to add (default is oracle).</li>
<li><code class="docutils literal"><span class="pre">-o</span> <span class="pre">ID_ORDER</span></code>: Id order of the release to add.</li>
<li><code class="docutils literal"><span class="pre">-b</span> <span class="pre">BRANCH_ID</span></code>: Id of the branch connected to release to add.</li>
<li><code class="docutils literal"><span class="pre">-dir</span> <span class="pre">DIRECTORY</span></code>: Directory of the release to add.</li>
<li><code class="docutils literal"><span class="pre">-h</span></code>: Show insert_release command options.</li>
</ul>
<p><em>Exit Values</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">1</span></code>: On error.</li>
<li><code class="docutils literal"><span class="pre">0</span></code>: On success</li>
</ul>
<div class="highlight-shell"><div class="highlight"><pre><span></span>  <span class="nv">$#</span> dbrm dbm insert_release
  <span class="o">[</span>-n name<span class="o">]</span>               Release Name.
  <span class="o">[</span>-d YYYY-MM-DD<span class="o">]</span>         Release Date. <span class="o">(</span>Use now <span class="k">if</span> not available<span class="o">)</span>
  <span class="o">[</span>-v version<span class="o">]</span>            Release Version
  <span class="o">[</span>-a adapter<span class="o">]</span>            Release Adapter <span class="o">(</span>default is Oracle<span class="o">)</span>.
  <span class="o">[</span>-o id_order<span class="o">]</span>           Release Id Order <span class="o">(</span>optional<span class="o">)</span>.
  <span class="o">[</span>-b id_branch<span class="o">]</span>          Release Id Branch <span class="o">(</span>default master branch <span class="o">{</span>1<span class="o">})</span>.
  <span class="o">[</span>--dir directory<span class="o">]</span>        Release directory <span class="o">(</span>default is <span class="o">[</span>.<span class="o">])</span>.

  <span class="nv">$#</span> dbrm dbm insert_release -n <span class="s1">&#39;Project1&#39;</span> -d 2017-04-24 -v 1.2.3 -a mariadb --dir .
  Release Project1 v. 1.2.3 insert correctly.
</pre></div>
</div>
</div>
</div>
<div class="section" id="dbm-remove-release">
<span id="dbm-remove-release"></span><h3>dbm remove_release<a class="headerlink" href="#dbm-remove-release" title="Permalink to this headline">¶</a></h3>
<p>Remove a release from project.</p>
<div class="section" id="remove-release-options">
<span id="remove-release-options"></span><h4>remove_release options:<a class="headerlink" href="#remove-release-options" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">-r</span> <span class="pre">RELEASE_ID</span></code>: Id of the release to remove.</li>
<li><code class="docutils literal"><span class="pre">-f</span></code>: For remove of the selected release without confirmation question.</li>
<li><code class="docutils literal"><span class="pre">-h</span></code>: Show remove_release command options.</li>
</ul>
<p><em>Exit Values</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">1</span></code>: On error.</li>
<li><code class="docutils literal"><span class="pre">0</span></code>: On success</li>
</ul>
<div class="highlight-shell"><div class="highlight"><pre><span></span>  <span class="nv">$#</span> dbrm dbm remove_release
  <span class="o">[</span>-r id_release<span class="o">]</span>         Id Release of the script to remove.
  <span class="o">[</span>-f<span class="o">]</span>                    Force remove without confirmation question.

  <span class="nv">$#</span> dbrm dbm remove_release -r 15
  Are you sure to remove release with id 15? <span class="o">[</span>N/y<span class="o">]</span>y
  Release <span class="m">15</span> is been removed.
</pre></div>
</div>
<p>TODO:</p>
<ul class="simple">
<li>use also long options for command arguments.</li>
</ul>
</div>
</div>
<div class="section" id="dbm-remove-script">
<span id="dbm-remove-script"></span><h3>dbm remove_script<a class="headerlink" href="#dbm-remove-script" title="Permalink to this headline">¶</a></h3>
<p>Remove a script from project.</p>
<div class="section" id="remove-script-options">
<span id="remove-script-options"></span><h4>remove_script options:<a class="headerlink" href="#remove-script-options" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">-i</span> <span class="pre">SCRIPT_ID</span></code>: Id of the script to remove.</li>
<li><code class="docutils literal"><span class="pre">-h</span></code>: Show remove_script command options.</li>
</ul>
<p><em>Exit Values</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">1</span></code>: On error.</li>
<li><code class="docutils literal"><span class="pre">0</span></code>: On success</li>
</ul>
<div class="highlight-shell"><div class="highlight"><pre><span></span>  <span class="nv">$#</span> dbrm dbm remove_script
  <span class="o">[</span>-i id_script<span class="o">]</span>          Id Script of the script to remove.

  <span class="nv">$#</span> dbrm dbm remove_script -i 10
  Script <span class="m">10</span> removed correctly.
</pre></div>
</div>
<p>TODO:</p>
<ul class="simple">
<li>use also long options for command arguments.</li>
</ul>
</div>
</div>
<div class="section" id="dbm-update-script">
<span id="dbm-update-script"></span><h3>dbm update_script<a class="headerlink" href="#dbm-update-script" title="Permalink to this headline">¶</a></h3>
<p>Update information about a script.</p>
<div class="section" id="update-script-options">
<span id="update-script-options"></span><h4>update_script options:<a class="headerlink" href="#update-script-options" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">-i</span> <span class="pre">SCRIPT_ID</span></code>: Id of the script to update.</li>
<li><code class="docutils literal"><span class="pre">-f</span> <span class="pre">FILENAME</span></code>: Script filename to update.</li>
<li><code class="docutils literal"><span class="pre">-n</span> <span class="pre">NAME</span></code>: Name of the release of the script to update.</li>
<li><code class="docutils literal"><span class="pre">-v</span> <span class="pre">VERSION</span></code>: Version of the release of the script to update.</li>
<li><code class="docutils literal"><span class="pre">-t</span> <span class="pre">STYPE</span></code>: Type of the script to update</li>
<li><code class="docutils literal"><span class="pre">-a</span> <span class="pre">FLAG</span></code>: Set active (1) or disable (0) flag of the script.</li>
<li><code class="docutils literal"><span class="pre">-d</span> <span class="pre">DIRECTORY</span></code>: Directory of the script to update.</li>
<li><code class="docutils literal"><span class="pre">-o</span> <span class="pre">ID_ORDER</span></code>: Id order of the script to update (optional).</li>
<li><code class="docutils literal"><span class="pre">-r</span> <span class="pre">RELEASE_ID</span></code>: Id of the release of the script.
If this option is present are not needed release name and release version.</li>
<li><code class="docutils literal"><span class="pre">-h</span></code>: Show update_script command options.</li>
</ul>
<p><em>Exit Values</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">1</span></code>: On error.</li>
<li><code class="docutils literal"><span class="pre">0</span></code>: On success</li>
</ul>
<div class="highlight-shell"><div class="highlight"><pre><span></span>  <span class="nv">$#</span> dbrm dbm update_script -h
  <span class="o">[</span>-i id_script<span class="o">]</span>          Id Script.
  <span class="o">[</span>-f filename<span class="o">]</span>           Script filename.
  <span class="o">[</span>-n name<span class="o">]</span>               Release Name.
  <span class="o">[</span>-v version<span class="o">]</span>            Release Version
  <span class="o">[</span>-t script_type<span class="o">]</span>        Script Type.
  <span class="o">[</span>-a 0<span class="p">|</span>1<span class="o">]</span>                Set active flag.
  <span class="o">[</span>-d directory<span class="o">]</span>          Directory of the script.
  <span class="o">[</span>-o id_order<span class="o">]</span>           Script Id Order <span class="o">(</span>optional<span class="o">)</span>. Default is used MAX<span class="o">(</span>id<span class="o">)</span> of the same id_release.
  <span class="o">[</span>-r id_release<span class="o">]</span>         Id_release of the script. Use this instead of release name and version.

  <span class="nv">$#</span> dbrm dbm update_script -i <span class="m">10</span> -a 1
  Script <span class="m">10</span> updated correctly.
</pre></div>
</div>
<p>TODO:</p>
<ul class="simple">
<li>use also long options for command arguments.</li>
</ul>
</div>
</div>
<div class="section" id="dbm-insert-script">
<span id="dbm-insert-script"></span><h3>dbm insert_script<a class="headerlink" href="#dbm-insert-script" title="Permalink to this headline">¶</a></h3>
<p>Insert a new script to a release.</p>
<div class="section" id="insert-script-options">
<span id="insert-script-options"></span><h4>insert_script options:<a class="headerlink" href="#insert-script-options" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">-f</span> <span class="pre">FILENAME</span></code>: Script filename.</li>
<li><code class="docutils literal"><span class="pre">-n</span> <span class="pre">NAME</span></code>: Name of the release of the script to insert.</li>
<li><code class="docutils literal"><span class="pre">-v</span> <span class="pre">VERSION</span></code>: Version of the release of the script to insert.</li>
<li><code class="docutils literal"><span class="pre">-t</span> <span class="pre">STYPE</span></code>: Type of the script to insert.</li>
<li><code class="docutils literal"><span class="pre">-a</span> <span class="pre">FLAG</span></code>: Set active (1) or disable (0) flag of the script.</li>
<li><code class="docutils literal"><span class="pre">-d</span> <span class="pre">DIRECTORY</span></code>: Directory of the script to insert.</li>
<li><code class="docutils literal"><span class="pre">-o</span> <span class="pre">ID_ORDER</span></code>: Id order of the script to update (optional).
Default is used MAX(id) of the same id_release.</li>
<li><code class="docutils literal"><span class="pre">-r</span> <span class="pre">RELEASE_ID</span></code>: Id of the release of the script.
If this option is present are not needed release name and release version.</li>
<li><code class="docutils literal"><span class="pre">-h</span></code>: Show insert_script command options.</li>
</ul>
<p><em>Exit Values</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">1</span></code>: On error.</li>
<li><code class="docutils literal"><span class="pre">0</span></code>: On success</li>
</ul>
<div class="highlight-shell"><div class="highlight"><pre><span></span>  <span class="nv">$#</span> dbrm dbm insert_script
  <span class="o">[</span>-f filename<span class="o">]</span>           Script filename.
  <span class="o">[</span>-n name<span class="o">]</span>               Release Name.
  <span class="o">[</span>-v version<span class="o">]</span>            Release Version
  <span class="o">[</span>-t script_type<span class="o">]</span>        Script Type.
  <span class="o">[</span>-a 0<span class="p">|</span>1<span class="o">]</span>                Set active flag. Default is <span class="m">1</span> <span class="o">(</span>active<span class="o">)</span>
  <span class="o">[</span>-d directory<span class="o">]</span>          Directory of the script.
  <span class="o">[</span>-o id_order<span class="o">]</span>           Script Id Order <span class="o">(</span>optional<span class="o">)</span>. Default is used MAX<span class="o">(</span>id<span class="o">)</span> of the same id_release.
  <span class="o">[</span>-r id_release<span class="o">]</span>         Id_release of the script. Use this instead of release name and version.
  <span class="o">[</span>-h<span class="o">]</span>                    Show this message.

  <span class="nv">$#</span> dbrm dbm insert_script -f script1.sql -a <span class="m">1</span> -r <span class="m">10</span> -t update_script
  Script script1.sql insert correctly.
</pre></div>
</div>
<p>TODO:</p>
<ul class="simple">
<li>use also long options for command arguments.</li>
</ul>
</div>
</div>
<div class="section" id="dbm-insert-script-type">
<span id="dbm-insert-script-type"></span><h3>dbm insert_script_type<a class="headerlink" href="#dbm-insert-script-type" title="Permalink to this headline">¶</a></h3>
<p>Insert a script type.</p>
<div class="section" id="insert-script-type-options">
<span id="insert-script-type-options"></span><h4>insert_script_type options:<a class="headerlink" href="#insert-script-type-options" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">-c</span> <span class="pre">CODE</span></code>: String used as code of the script type.</li>
<li><code class="docutils literal"><span class="pre">-d</span> <span class="pre">DESCRIPTION</span></code>: Description of the script type.</li>
<li><code class="docutils literal"><span class="pre">-h</span></code>: Show insert_script_type command options.</li>
</ul>
<p><em>Exit Values</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">1</span></code>: On error.</li>
<li><code class="docutils literal"><span class="pre">0</span></code>: On success</li>
</ul>
<div class="highlight-shell"><div class="highlight"><pre><span></span>  <span class="nv">$#</span> dbrm dbm insert_script_type
  <span class="o">[</span>-c code<span class="o">]</span>               Script Type Code.
  <span class="o">[</span>-d description<span class="o">]</span>        Script Type Description

  <span class="nv">$#</span> dbrm dbm insert_script_type -c regression_test -d <span class="s1">&#39;Script used for check regression issue&#39;</span>
  Script Type regression_test insert correctly.
</pre></div>
</div>
<p>TODO:</p>
<ul class="simple">
<li>use also long options for command arguments.</li>
</ul>
</div>
</div>
<div class="section" id="dbm-insert-rel-dep">
<span id="dbm-insert-rel-dep"></span><h3>dbm insert_rel_dep<a class="headerlink" href="#dbm-insert-rel-dep" title="Permalink to this headline">¶</a></h3>
<p>Insert a release dependency.</p>
<div class="section" id="insert-rel-dep-options">
<span id="insert-rel-dep-options"></span><h4>insert_rel_dep options:<a class="headerlink" href="#insert-rel-dep-options" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">-n</span> <span class="pre">NAME</span></code>: Name of the release where add a new dependency.</li>
<li><code class="docutils literal"><span class="pre">-t</span> <span class="pre">VERSION_TO</span></code>: Version of the release that has a dependency.</li>
<li><code class="docutils literal"><span class="pre">-f</span> <span class="pre">VERSION_FROM</span></code>: Version of the release that is needed for VERSION_TO.</li>
<li><code class="docutils literal"><span class="pre">-h</span></code>: Show insert_rel_dep command options.</li>
</ul>
<p><em>Exit Values</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">1</span></code>: On error.</li>
<li><code class="docutils literal"><span class="pre">0</span></code>: On success</li>
</ul>
<div class="highlight-shell"><div class="highlight"><pre><span></span>  <span class="nv">$#</span> dbrm dbm insert_rel_dep -h
  <span class="o">[</span>-n name<span class="o">]</span>               Release Name.
  <span class="o">[</span>-t version_to<span class="o">]</span>         Release version that has a dependency.
  <span class="o">[</span>-f version_from<span class="o">]</span>       Release version needed.

  <span class="nv">$#</span> dbrm dbm insert_rel_dep -n <span class="s1">&#39;Project1&#39;</span> -t <span class="s1">&#39;0.1.1&#39;</span> -f <span class="s1">&#39;0.1.0&#39;</span>
  Insert release dependency to Project1 v.0.1.1 correctly.
</pre></div>
</div>
<p>TODO:</p>
<ul class="simple">
<li>use also long options for command arguments.</li>
</ul>
</div>
</div>
<div class="section" id="dbm-remove-rel-dep">
<span id="dbm-remove-rel-dep"></span><h3>dbm remove_rel_dep<a class="headerlink" href="#dbm-remove-rel-dep" title="Permalink to this headline">¶</a></h3>
<p>Remove a release dependency.</p>
<div class="section" id="remove-rel-dep-options">
<span id="remove-rel-dep-options"></span><h4>remove_rel_dep options:<a class="headerlink" href="#remove-rel-dep-options" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">-n</span> <span class="pre">NAME</span></code>: Name of the release where remove dependency.</li>
<li><code class="docutils literal"><span class="pre">-t</span> <span class="pre">VERSION_TO</span></code>: Version of the release that has a dependency.</li>
<li><code class="docutils literal"><span class="pre">-f</span> <span class="pre">VERSION_FROM</span></code>: Version of the release that is needed for VERSION_TO.</li>
<li><code class="docutils literal"><span class="pre">-h</span></code>: Show remove_rel_dep command options.</li>
</ul>
<p><em>Exit Values</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">1</span></code>: On error.</li>
<li><code class="docutils literal"><span class="pre">0</span></code>: On success</li>
</ul>
<div class="highlight-shell"><div class="highlight"><pre><span></span>  <span class="nv">$#</span> dbrm dbm remove_rel_dep -h
  <span class="o">[</span>-n name<span class="o">]</span>               Release Name.
  <span class="o">[</span>-t version_to<span class="o">]</span>         Release version that has a dependency.
  <span class="o">[</span>-f version_from<span class="o">]</span>       Release version needed.

  <span class="nv">$#</span> dbrm dbm remove_rel_dep -n <span class="s1">&#39;Project1&#39;</span> -t <span class="s1">&#39;0.1.1&#39;</span> -f <span class="s1">&#39;0.1.0&#39;</span>
  Remove release dependency to Project1 v.0.1.1 with 0.1.0 correctly.
</pre></div>
</div>
<p>TODO:</p>
<ul class="simple">
<li>use also long options for command arguments.</li>
</ul>
</div>
</div>
<div class="section" id="dbm-insert-inhibit-script">
<span id="dbm-insert-inhibit-script"></span><h3>dbm insert_inhibit_script<a class="headerlink" href="#dbm-insert-inhibit-script" title="Permalink to this headline">¶</a></h3>
<p>Insert a release inhibited script.</p>
<div class="section" id="insert-inhibit-script-options">
<span id="insert-inhibit-script-options"></span><h4>insert_inhibit_script options:<a class="headerlink" href="#insert-inhibit-script-options" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">-n</span> <span class="pre">NAME</span></code>: Name of the release where add an inhibited script between two version.</li>
<li><code class="docutils literal"><span class="pre">-i</span> <span class="pre">SCRIPT_ID</span></code>: Id of the script to inhibit.</li>
<li><code class="docutils literal"><span class="pre">-t</span> <span class="pre">VERSION_TO</span></code>: Version of the release target of the installation.</li>
<li><code class="docutils literal"><span class="pre">-f</span> <span class="pre">VERSION_FROM</span></code>: Version of the release source of the installation.</li>
<li><code class="docutils literal"><span class="pre">-h</span></code>: Show insert_inhibit_script command options.</li>
</ul>
<p><em>Exit Values</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">1</span></code>: On error.</li>
<li><code class="docutils literal"><span class="pre">0</span></code>: On success</li>
</ul>
<div class="highlight-shell"><div class="highlight"><pre><span></span>  <span class="nv">$#</span> dbrm dbm insert_inhibit_script -h
  <span class="o">[</span>-n name<span class="o">]</span>               Release Name.
  <span class="o">[</span>-i id_script<span class="o">]</span>          Script Id.
  <span class="o">[</span>-t version_to<span class="o">]</span>         Release version target of the installation.
  <span class="o">[</span>-f version_from<span class="o">]</span>       Release version <span class="nb">source</span> of the installation.

  <span class="nv">$#</span> dbrm dbm insert_inhibit_script -n <span class="s1">&#39;Project1&#39;</span> -t <span class="s1">&#39;0.2.0&#39;</span> -f <span class="s1">&#39;0.1.0&#39;</span> -i 10
  Record insert correctly.
</pre></div>
</div>
<p>TODO:</p>
<ul class="simple">
<li>use also long options for command arguments.</li>
</ul>
</div>
</div>
<div class="section" id="dbm-insert-ded-script">
<span id="dbm-insert-ded-script"></span><h3>dbm insert_ded_script<a class="headerlink" href="#dbm-insert-ded-script" title="Permalink to this headline">¶</a></h3>
<p>Insert a release dedicated script.</p>
<div class="section" id="insert-ded-script-options">
<span id="insert-ded-script-options"></span><h4>insert_ded_script options:<a class="headerlink" href="#insert-ded-script-options" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">-n</span> <span class="pre">NAME</span></code>: Name of the release where add an dedicated script between two version.</li>
<li><code class="docutils literal"><span class="pre">-i</span> <span class="pre">SCRIPT_ID</span></code>: Id of the script to insert.</li>
<li><code class="docutils literal"><span class="pre">-t</span> <span class="pre">VERSION_TO</span></code>: Version of the release target of the installation.</li>
<li><code class="docutils literal"><span class="pre">-f</span> <span class="pre">VERSION_FROM</span></code>: Version of the release source of the installation.</li>
<li><code class="docutils literal"><span class="pre">-h</span></code>: Show insert_ded_script command options.</li>
</ul>
<p><em>Exit Values</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">1</span></code>: On error.</li>
<li><code class="docutils literal"><span class="pre">0</span></code>: On success</li>
</ul>
<div class="highlight-shell"><div class="highlight"><pre><span></span>  <span class="nv">$#</span> dbrm dbm insert_ded_script -h
  <span class="o">[</span>-n name<span class="o">]</span>               Release Name.
  <span class="o">[</span>-i id_script<span class="o">]</span>          Script Id.
  <span class="o">[</span>-t version_to<span class="o">]</span>         Release version target of the installation.
  <span class="o">[</span>-f version_from<span class="o">]</span>       Release version <span class="nb">source</span> of the installation.

  <span class="nv">$#</span> dbrm dbm insert_ded_script -n <span class="s1">&#39;Project1&#39;</span> -t <span class="s1">&#39;0.2.0&#39;</span> -f <span class="s1">&#39;0.1.0&#39;</span> -i 10
  Record insert correctly.
</pre></div>
</div>
<p>TODO:</p>
<ul class="simple">
<li>use also long options for command arguments.</li>
</ul>
</div>
</div>
<div class="section" id="dbm-remove-inhibit-script">
<span id="dbm-remove-inhibit-script"></span><h3>dbm remove_inhibit_script<a class="headerlink" href="#dbm-remove-inhibit-script" title="Permalink to this headline">¶</a></h3>
<p>Remove a release inhibited script.</p>
<div class="section" id="remove-inhibit-script-options">
<span id="remove-inhibit-script-options"></span><h4>remove_inhibit_script options:<a class="headerlink" href="#remove-inhibit-script-options" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">-n</span> <span class="pre">NAME</span></code>: Name of the release where remove an inhibited script between two version.</li>
<li><code class="docutils literal"><span class="pre">-i</span> <span class="pre">SCRIPT_ID</span></code>: Id of the script to remove.</li>
<li><code class="docutils literal"><span class="pre">-t</span> <span class="pre">VERSION_TO</span></code>: Version of the release target of the installation.</li>
<li><code class="docutils literal"><span class="pre">-f</span> <span class="pre">VERSION_FROM</span></code>: Version of the release source of the installation.</li>
<li><code class="docutils literal"><span class="pre">-h</span></code>: Show remove_inhibit_script command options.</li>
</ul>
<p><em>Exit Values</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">1</span></code>: On error.</li>
<li><code class="docutils literal"><span class="pre">0</span></code>: On success</li>
</ul>
<div class="highlight-shell"><div class="highlight"><pre><span></span>  <span class="nv">$#</span> dbrm dbm remove_inhibit_script -h
  <span class="o">[</span>-n name<span class="o">]</span>               Release Name.
  <span class="o">[</span>-i id_script<span class="o">]</span>          Script Id.
  <span class="o">[</span>-t version_to<span class="o">]</span>         Release version target of the installation.
  <span class="o">[</span>-f version_from<span class="o">]</span>       Release version <span class="nb">source</span> of the installation.

  <span class="nv">$#</span> dbrm dbm remove_ded_script -n <span class="s1">&#39;Project1&#39;</span> -t <span class="s1">&#39;0.2.0&#39;</span> -f <span class="s1">&#39;0.1.0&#39;</span> -i 10
  Record removed correctly.
</pre></div>
</div>
<p>TODO:</p>
<ul class="simple">
<li>use also long options for command arguments.</li>
</ul>
</div>
</div>
<div class="section" id="dbm-remove-ded-script">
<span id="dbm-remove-ded-script"></span><h3>dbm remove_ded_script<a class="headerlink" href="#dbm-remove-ded-script" title="Permalink to this headline">¶</a></h3>
<p>Remove a release inhibited script.</p>
<div class="section" id="remove-ded-script-options">
<span id="remove-ded-script-options"></span><h4>remove_ded_script options:<a class="headerlink" href="#remove-ded-script-options" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">-n</span> <span class="pre">NAME</span></code>: Name of the release where remove a dedicated script between two version.</li>
<li><code class="docutils literal"><span class="pre">-i</span> <span class="pre">SCRIPT_ID</span></code>: Id of the script to remove.</li>
<li><code class="docutils literal"><span class="pre">-t</span> <span class="pre">VERSION_TO</span></code>: Version of the release target of the installation.</li>
<li><code class="docutils literal"><span class="pre">-f</span> <span class="pre">VERSION_FROM</span></code>: Version of the release source of the installation.</li>
<li><code class="docutils literal"><span class="pre">-h</span></code>: Show remove_ded_script command options.</li>
</ul>
<p><em>Exit Values</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">1</span></code>: On error.</li>
<li><code class="docutils literal"><span class="pre">0</span></code>: On success</li>
</ul>
<div class="highlight-shell"><div class="highlight"><pre><span></span>  <span class="nv">$#</span> dbrm dbm remove_ded_script -h
  <span class="o">[</span>-n name<span class="o">]</span>               Release Name.
  <span class="o">[</span>-i id_script<span class="o">]</span>          Script Id.
  <span class="o">[</span>-t version_to<span class="o">]</span>         Release version target of the installation.
  <span class="o">[</span>-f version_from<span class="o">]</span>       Release version <span class="nb">source</span> of the installation.

  <span class="nv">$#</span> dbrm dbm remove_dev_script -n <span class="s1">&#39;Project1&#39;</span> -t <span class="s1">&#39;0.2.0&#39;</span> -f <span class="s1">&#39;0.1.0&#39;</span> -i 10
  Record removed correctly.
</pre></div>
</div>
<p>TODO:</p>
<ul class="simple">
<li>use also long options for command arguments.</li>
</ul>
</div>
</div>
<div class="section" id="dbm-show-branches">
<span id="dbm-show-branches"></span><h3>dbm show_branches<a class="headerlink" href="#dbm-show-branches" title="Permalink to this headline">¶</a></h3>
<p>Show list of branches.</p>
<p><em>Exit Values</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">1</span></code>: On error.</li>
<li><code class="docutils literal"><span class="pre">0</span></code>: On success</li>
</ul>
<div class="highlight-shell"><div class="highlight"><pre><span></span>  <span class="nv">$#</span> dbrm dbm <span class="nv">show_branches</span>
  <span class="o">===============================================================================================================</span>
  ID        CREATION_DATE           UPDATE_DATE             <span class="nv">NAME</span>
  <span class="o">===============================================================================================================</span>
  <span class="m">1</span>         2013-05-21 08:41:52     2013-05-21 08:41:52     master
  <span class="m">2</span>         2013-11-18 00:27:57     2013-11-18 00:27:57     0.1.x
</pre></div>
</div>
</div>
<div class="section" id="dbm-insert-branch">
<span id="dbm-insert-branch"></span><h3>dbm insert_branch<a class="headerlink" href="#dbm-insert-branch" title="Permalink to this headline">¶</a></h3>
<p>Insert a new branch.</p>
<div class="section" id="insert-branch-options">
<span id="insert-branch-options"></span><h4>insert_branch options:<a class="headerlink" href="#insert-branch-options" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">-n</span> <span class="pre">NAME</span></code>: Name of the branch to insert.</li>
<li><code class="docutils literal"><span class="pre">-d</span> <span class="pre">YYYY-MM-DD</span></code>: Date of the branch (optional). Default valeu is now.</li>
<li><code class="docutils literal"><span class="pre">-h</span></code>: Show insert_branch command options.</li>
</ul>
<p><em>Exit Values</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">1</span></code>: On error.</li>
<li><code class="docutils literal"><span class="pre">0</span></code>: On success</li>
</ul>
<div class="highlight-shell"><div class="highlight"><pre><span></span>  <span class="nv">$#</span> dbrm dbm insert_branch
  <span class="o">[</span>-n name<span class="o">]</span>               Branch Name.
  <span class="o">[</span>-d YYYY-MM-DD<span class="o">]</span>         Branch Date. <span class="o">(</span>Use now <span class="k">if</span> not available<span class="o">)</span>

  <span class="nv">$#</span> dbrm dbm insert_branch -n <span class="s1">&#39;master&#39;</span>
  Branches master insert correctly.
</pre></div>
</div>
<p>TODO:</p>
<ul class="simple">
<li>use also long options for command arguments.</li>
</ul>
</div>
</div>
<div class="section" id="dbm-move-script">
<span id="dbm-move-script"></span><h3>dbm move_script<a class="headerlink" href="#dbm-move-script" title="Permalink to this headline">¶</a></h3>
<p>Move a release script.</p>
<div class="section" id="move-script-options">
<span id="move-script-options"></span><h4>move_script options:<a class="headerlink" href="#move-script-options" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">-i</span> <span class="pre">SCRIPT_ID</span></code>: Id of the script to move.</li>
<li><code class="docutils literal"><span class="pre">-a</span> <span class="pre">SCRIPT_ID_X</span></code>: Move script <em>after</em> script with id SCRIPT_ID_X.</li>
<li><code class="docutils literal"><span class="pre">-b</span> <span class="pre">SCRIPT_ID_X</span></code>: Move script <em>before</em> script with id SCRIPT_ID_X.</li>
<li><code class="docutils literal"><span class="pre">-r</span> <span class="pre">ID_RELEASE</span></code>: Release id of the script to move.</li>
<li><code class="docutils literal"><span class="pre">-h</span></code>: Show move_script command options.</li>
</ul>
<p><em>Exit Values</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">1</span></code>: On error.</li>
<li><code class="docutils literal"><span class="pre">0</span></code>: On success</li>
</ul>
<div class="highlight-shell"><div class="highlight"><pre><span></span>  <span class="nv">$#</span> dbrm dbm move_script -h
  <span class="o">[</span>-i id_script<span class="o">]</span>          Id script of the script to move.
  <span class="o">[</span>-a x<span class="o">]</span>                  After script with id x.
  <span class="o">[</span>-b x<span class="o">]</span>                  Before script with id x.
  <span class="o">[</span>-r id_release<span class="o">]</span>         Id Release of the script to move.

  <span class="nv">$#</span> dbrm dbm move_script -i <span class="m">10</span> -a <span class="m">11</span> -r 1
  Moved correctly script <span class="m">10</span> of the release <span class="m">1</span> after script 11.
</pre></div>
</div>
<p>TODO:</p>
<ul class="simple">
<li>use also long options for command arguments.</li>
</ul>
</div>
</div>
<div class="section" id="dbm-upgrade">
<span id="dbm-upgrade"></span><h3>dbm upgrade<a class="headerlink" href="#dbm-upgrade" title="Permalink to this headline">¶</a></h3>
<p>Upgrade DBRM database with last revision.</p>
<p><em>Exit Values</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">1</span></code>: On error.</li>
<li><code class="docutils literal"><span class="pre">0</span></code>: On success</li>
</ul>
</div>
</div>
<div class="section" id="api">
<span id="api"></span><h2>API<a class="headerlink" href="#api" title="Permalink to this headline">¶</a></h2>
<div class="section" id="dbm-init">
<span id="dbm-init"></span><h3>_dbm_init<a class="headerlink" href="#dbm-init" title="Permalink to this headline">¶</a></h3>
<p>Method called when module dbm is initialized.
Load all *.inc files of dbm module that contains help messages and command line parser of the dbm module commands.</p>
<p><em>Returns</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">0</span></code>: always</li>
</ul>
<script type="text/javascript">
    function showhide(element){
        if (!document.getElementById)
            return
        if (element.style.display == "block")
            element.style.display = "none"
        else
            element.style.display = "block"
    };
</script>
<a href="javascript:showhide(document.getElementById('hiddencodeblock112'))">(Show/Hide)</a><br /><div id="hiddencodeblock112" style="display: none"><div class="highlight-bash"><div class="highlight"><pre><span></span>_dbm_init<span class="o">()</span> <span class="o">{</span>

  <span class="c1"># Load dbm module files</span>
  <span class="k">for</span> i in <span class="nv">$DBRM_CORE_FILES_DIR</span>/dbm/*.inc <span class="p">;</span> <span class="k">do</span>
    . <span class="nv">$i</span>
  <span class="k">done</span>

  <span class="k">return</span> 0
<span class="o">}</span>
</pre></div>
</div>
</div></div>
<div class="section" id="dbm-post-init">
<span id="dbm-post-init"></span><h3>_dbm_post_init<a class="headerlink" href="#dbm-post-init" title="Permalink to this headline">¶</a></h3>
<p>Internal function called after initialization of dbm module.
On this function is:</p>
<ul class="simple">
<li>check if exists internal sqlite database (DRM_DB variable) otherwise is created.</li>
<li>check if it is defined DBM_UNDO_SCRIPT variable relative to undo commands.
If is not defined then $LOCAL_DIR/dbm_undo.sh script file is used.</li>
<li>check if it is defined DBM_HISTORY variable relative to command history log.
If is not defined then $LOCAL_DIR/.dbm_history file is used.</li>
</ul>
<script type="text/javascript">
    function showhide(element){
        if (!document.getElementById)
            return
        if (element.style.display == "block")
            element.style.display = "none"
        else
            element.style.display = "block"
    };
</script>
<a href="javascript:showhide(document.getElementById('hiddencodeblock113'))">(Show/Hide)</a><br /><div id="hiddencodeblock113" style="display: none"><div class="highlight-bash"><div class="highlight"><pre><span></span>_dbm_post_init <span class="o">()</span> <span class="o">{</span>

  <span class="c1"># Check if exists DRM_DB</span>
  <span class="o">[[</span> <span class="nv">$DEBUG</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">&quot;(dbm_post_init: Check if is present sqlite internal db file: </span><span class="nv">$DRM_DB</span><span class="s2">)&quot;</span>
  <span class="k">if</span> <span class="o">[[</span> ! -e <span class="nv">$DRM_DB</span> <span class="o">]]</span> <span class="p">;</span> <span class="k">then</span>

    <span class="k">if</span> <span class="o">[[</span> -z <span class="s2">&quot;</span><span class="nv">$DRM_PROFILE</span><span class="s2">&quot;</span> <span class="o">||</span> <span class="nv">$DRM_PROFILE</span> -eq <span class="m">0</span> <span class="o">]]</span> <span class="p">;</span> <span class="k">then</span>
      <span class="o">[[</span> <span class="nv">$DEBUG</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">&quot;(dbm_post_init: Create sqlite internal db file: </span><span class="nv">$DRM_DB</span><span class="s2">)&quot;</span>
      _sqlite_create -c <span class="s2">&quot;</span><span class="nv">$DRM_DB</span><span class="s2">&quot;</span> -s <span class="s2">&quot;</span><span class="nv">$dbm_schema</span><span class="s2">&quot;</span> <span class="o">||</span> error_handled <span class="s2">&quot;Error on create </span><span class="nv">$DRM_DB</span><span class="s2"> file.&quot;</span>

      _dbm_exts_check_extensions <span class="s2">&quot;0&quot;</span> <span class="o">||</span> error_handled <span class="s2">&quot;Error on initialize extensions.&quot;</span>

    <span class="k">fi</span>

  <span class="k">else</span>

    <span class="k">if</span> <span class="o">[[</span> x<span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span> !<span class="o">=</span> x<span class="s2">&quot;upgrade&quot;</span> <span class="o">&amp;&amp;</span> x<span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span> !<span class="o">=</span> x<span class="s2">&quot;shell&quot;</span> <span class="o">&amp;&amp;</span> x<span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span> !<span class="o">=</span> x<span class="s2">&quot;info&quot;</span> <span class="o">]]</span> <span class="p">;</span> <span class="k">then</span>
      <span class="c1"># Check if it is needed an upgrade</span>
      _dbm_exts_check_dbm <span class="o">||</span> error_handled <span class="se">\</span>
        <span class="s2">&quot;Execute &#39;dbrm dbm upgrade&#39; to upgrade internal database.&quot;</span>
    <span class="k">fi</span>

  <span class="k">fi</span>

  <span class="c1"># Check if is defined undo script path</span>
  <span class="k">if</span> <span class="o">[[</span> -z <span class="s2">&quot;</span><span class="nv">$DBM_UNDO_SCRIPT</span><span class="s2">&quot;</span> <span class="o">]]</span> <span class="p">;</span> <span class="k">then</span>
      <span class="c1"># Use default path</span>
      <span class="nv">DBM_UNDO_SCRIPT</span><span class="o">=</span><span class="nv">$LOCAL_DIR</span>/dbm_undo.sh
  <span class="k">else</span>
    <span class="k">if</span> <span class="o">[[</span> ! -e <span class="nv">$DBM_UNDO_SCRIPT</span> <span class="o">]]</span> <span class="p">;</span> <span class="k">then</span>
      error_generate <span class="s2">&quot;Invalid DBM Undo script path defined.&quot;</span>
    <span class="k">fi</span>
  <span class="k">fi</span>

  <span class="c1"># Check if is defined history script path</span>
  <span class="k">if</span> <span class="o">[[</span> -z <span class="s2">&quot;</span><span class="nv">$DBM_HISTORY</span><span class="s2">&quot;</span> <span class="o">]]</span> <span class="p">;</span> <span class="k">then</span>
      <span class="c1"># Use default path</span>
      <span class="nv">DBM_HISTORY</span><span class="o">=</span><span class="nv">$LOCAL_DIR</span>/.dbm_history
  <span class="k">else</span>
    <span class="k">if</span> <span class="o">[[</span> ! -e <span class="nv">$DBM_HISTORY</span> <span class="o">]]</span> <span class="p">;</span> <span class="k">then</span>
      error_generate <span class="s2">&quot;Invalid DBM history file path defined.&quot;</span>
    <span class="k">fi</span>
  <span class="k">fi</span>

  <span class="o">[[</span> <span class="nv">$DEBUG</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">&quot;(dbm_post_init: Use undo script: </span><span class="nv">$DBM_UNDO_SCRIPT</span><span class="s2">.)&quot;</span>

  <span class="nb">export</span> DBM_UNDO_SCRIPT DBM_HISTORY
<span class="o">}</span>
</pre></div>
</div>
</div></div>
<div class="section" id="dbm-upgrade">
<span id="id1"></span><h3>_dbm_upgrade<a class="headerlink" href="#dbm-upgrade" title="Permalink to this headline">¶</a></h3>
<p>Internal function called by upgrade command that upgrade and/or verify
DBRM database file.</p>
<script type="text/javascript">
    function showhide(element){
        if (!document.getElementById)
            return
        if (element.style.display == "block")
            element.style.display = "none"
        else
            element.style.display = "block"
    };
</script>
<a href="javascript:showhide(document.getElementById('hiddencodeblock114'))">(Show/Hide)</a><br /><div id="hiddencodeblock114" style="display: none"><div class="highlight-bash"><div class="highlight"><pre><span></span>_dbm_upgrade <span class="o">()</span> <span class="o">{</span>

  <span class="nb">local</span> <span class="nv">i</span><span class="o">=</span>0
  <span class="nb">local</span> <span class="nv">tschema</span><span class="o">=</span><span class="s2">&quot;&quot;</span>

  <span class="c1"># Check if all tables are present</span>
  <span class="k">for</span> i in <span class="nv">$dbm_tables</span> <span class="p">;</span> <span class="k">do</span>

    <span class="k">if</span> _sqlite_exists_table -c <span class="s2">&quot;</span><span class="nv">$DRM_DB</span><span class="s2">&quot;</span> -t <span class="s2">&quot;</span><span class="nv">$i</span><span class="s2">&quot;</span> <span class="p">;</span> <span class="k">then</span>

      _sqlite_get_tschema_from_file <span class="s2">&quot;</span><span class="nv">$dbm_schema</span><span class="s2">&quot;</span> <span class="s2">&quot;</span><span class="nv">$i</span><span class="s2">&quot;</span> <span class="o">||</span> <span class="se">\</span>
        error_generate <span class="s2">&quot;Error on retrieve schema of the table </span><span class="nv">$i</span><span class="s2">.&quot;</span>

      <span class="nv">query</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$_sqlite_ans</span><span class="s2">&quot;</span>

      _sqlite_query -c <span class="s2">&quot;</span><span class="nv">$DRM_DB</span><span class="s2">&quot;</span> -q <span class="s2">&quot;</span><span class="nv">$query</span><span class="s2">&quot;</span> <span class="o">||</span> <span class="se">\</span>
        error_handled <span class="s2">&quot;Error on create table </span><span class="nv">$i</span><span class="s2">.&quot;</span>

      out_handler_print <span class="s2">&quot;Created table </span><span class="nv">$i</span><span class="s2"> correctly.&quot;</span>

    <span class="k">fi</span>

  <span class="k">done</span>

  <span class="c1"># Check if all modules are present on Extensions table.</span>
  _dbm_exts_check_extensions <span class="o">||</span> error_generate <span class="s2">&quot;Error on verify extentensions.&quot;</span>

  <span class="c1"># Check if it is needed execute upgrade scripts for dbm module.</span>

  <span class="k">return</span> 0

<span class="o">}</span>
</pre></div>
</div>
</div></div>
<div class="section" id="dbm-how-many-profiles">
<span id="dbm-how-many-profiles"></span><h3>_dbm_how_many_profiles<a class="headerlink" href="#dbm-how-many-profiles" title="Permalink to this headline">¶</a></h3>
<p>Internal function that count number of configured profiles.</p>
<p><em>Return</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">0</span></code>: on success. Store number profiles on _sqlite_ans variable.</li>
<li><code class="docutils literal"><span class="pre">1</span></code>: on error</li>
</ul>
<script type="text/javascript">
    function showhide(element){
        if (!document.getElementById)
            return
        if (element.style.display == "block")
            element.style.display = "none"
        else
            element.style.display = "block"
    };
</script>
<a href="javascript:showhide(document.getElementById('hiddencodeblock115'))">(Show/Hide)</a><br /><div id="hiddencodeblock115" style="display: none"><div class="highlight-bash"><div class="highlight"><pre><span></span>_dbm_how_many_profiles <span class="o">()</span> <span class="o">{</span>

  <span class="nb">local</span> <span class="nv">query</span><span class="o">=</span><span class="s2">&quot;&quot;</span>

  _sqlite_query -c <span class="s2">&quot;</span><span class="nv">$DRM_DB</span><span class="s2">&quot;</span> -q <span class="s2">&quot;SELECT COUNT(1) AS P FROM Profiles&quot;</span> <span class="o">||</span> <span class="k">return</span> 1

  <span class="k">return</span> 0
<span class="o">}</span>
</pre></div>
</div>
</div></div>
<div class="section" id="dbm-get-profile-by-name">
<span id="dbm-get-profile-by-name"></span><h3>_dbm_get_profile_by_name<a class="headerlink" href="#dbm-get-profile-by-name" title="Permalink to this headline">¶</a></h3>
<p>Store on <code class="docutils literal"><span class="pre">DRM_PROFILE_FILE</span></code> variable complete path of the configuration file of the
profile with name passed in input.
Check also if file exists.</p>
<p><em>Parameters</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">$1</span></code>:  name of the profile</li>
</ul>
<p><em>Return</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">0</span></code>: on success. Set DRM_PROFILE_FILE variable.</li>
<li><code class="docutils literal"><span class="pre">1</span></code>: on error</li>
</ul>
<script type="text/javascript">
    function showhide(element){
        if (!document.getElementById)
            return
        if (element.style.display == "block")
            element.style.display = "none"
        else
            element.style.display = "block"
    };
</script>
<a href="javascript:showhide(document.getElementById('hiddencodeblock116'))">(Show/Hide)</a><br /><div id="hiddencodeblock116" style="display: none"><div class="highlight-bash"><div class="highlight"><pre><span></span>_dbm_get_profile_by_name <span class="o">()</span> <span class="o">{</span>

  <span class="nb">local</span> <span class="nv">query</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
  <span class="nb">local</span> <span class="nv">name</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>

  check_var <span class="s2">&quot;DRM_PROFILES_PATH&quot;</span> <span class="o">||</span> <span class="se">\</span>
    error_handled <span class="se">\</span>
    <span class="s2">&quot;You must define DRM_PROFILES_PATH variable on configuration file&quot;</span>

  <span class="nv">query</span><span class="o">=</span><span class="s2">&quot;</span>
<span class="s2">    SELECT conf_file</span>
<span class="s2">    FROM Profiles</span>
<span class="s2">    WHERE profile_name = &#39;</span><span class="nv">$profile_name</span><span class="s2">&#39;&quot;</span>

  _sqlite_query -c <span class="s2">&quot;</span><span class="nv">$DRM_DB</span><span class="s2">&quot;</span> -q <span class="s2">&quot;</span><span class="nv">$query</span><span class="s2">&quot;</span> <span class="o">||</span> <span class="k">return</span> 1
  <span class="k">if</span> <span class="o">[</span> x<span class="s2">&quot;</span><span class="nv">$_sqlite_ans</span><span class="s2">&quot;</span> <span class="o">==</span> x<span class="s2">&quot;&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="nv">DRM_PROFILE_FILE</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$DRM_PROFILES_PATH</span><span class="s2">/</span><span class="nv">$_sqlite_ans</span><span class="s2">&quot;</span>

  <span class="k">if</span> <span class="o">[</span> ! -f <span class="nv">$DRM_PROFILE_FILE</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    error_generate <span class="s2">&quot;Profile file </span><span class="nv">$DRM_PROFILE_FILE</span><span class="s2"> not found.&quot;</span>
  <span class="k">fi</span>

  <span class="nb">export</span> DRM_PROFILE_FILE

  <span class="k">return</span> 0

<span class="o">}</span>
</pre></div>
</div>
</div></div>
<div class="section" id="dbm-get-default-profile-filepath">
<span id="dbm-get-default-profile-filepath"></span><h3>_dbm_get_default_profile_filepath<a class="headerlink" href="#dbm-get-default-profile-filepath" title="Permalink to this headline">¶</a></h3>
<p>Store on <code class="docutils literal"><span class="pre">DRM_PROFILE_FILE</span></code> variable complete path of the configuration
file of the active profile.
Check also if file exists.</p>
<p><em>Return</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">0</span></code>: on success. Set DRM_PROFILE_FILE variable.</li>
<li><code class="docutils literal"><span class="pre">1</span></code>: on error</li>
</ul>
<script type="text/javascript">
    function showhide(element){
        if (!document.getElementById)
            return
        if (element.style.display == "block")
            element.style.display = "none"
        else
            element.style.display = "block"
    };
</script>
<a href="javascript:showhide(document.getElementById('hiddencodeblock117'))">(Show/Hide)</a><br /><div id="hiddencodeblock117" style="display: none"><div class="highlight-bash"><div class="highlight"><pre><span></span>_dbm_get_default_profile_filepath <span class="o">()</span> <span class="o">{</span>

  <span class="nb">local</span> <span class="nv">query</span><span class="o">=</span><span class="s2">&quot;&quot;</span>

  check_var <span class="s2">&quot;DRM_PROFILES_PATH&quot;</span> <span class="o">||</span> error_handled <span class="s2">&quot;You must define DRM_PROFILES_PATH variable on configuration file&quot;</span>

  <span class="nv">query</span><span class="o">=</span><span class="s2">&quot;</span>
<span class="s2">    SELECT conf_file</span>
<span class="s2">    FROM Profiles</span>
<span class="s2">    WHERE default_profile = 1</span>
<span class="s2">    LIMIT 1&quot;</span>

  _sqlite_query -c <span class="s2">&quot;</span><span class="nv">$DRM_DB</span><span class="s2">&quot;</span> -q <span class="s2">&quot;</span><span class="nv">$query</span><span class="s2">&quot;</span> <span class="o">||</span> <span class="k">return</span> 1
  <span class="k">if</span> <span class="o">[</span> x<span class="s2">&quot;</span><span class="nv">$_sqlite_ans</span><span class="s2">&quot;</span> <span class="o">==</span> x<span class="s2">&quot;&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="nv">DRM_PROFILE_FILE</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$DRM_PROFILES_PATH</span><span class="s2">/</span><span class="nv">$_sqlite_ans</span><span class="s2">&quot;</span>

  <span class="k">if</span> <span class="o">[</span> ! -f <span class="nv">$DRM_PROFILE_FILE</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    error_generate <span class="s2">&quot;Profile file </span><span class="nv">$DRM_PROFILE_FILE</span><span class="s2"> not found.&quot;</span>
  <span class="k">fi</span>

  <span class="nb">export</span> DRM_PROFILE_FILE

  <span class="k">return</span> 0
<span class="o">}</span>
</pre></div>
</div>
</div></div>
<div class="section" id="dbm-check-if-exist-prof-byid">
<span id="dbm-check-if-exist-prof-byid"></span><h3>_dbm_check_if_exist_prof_byid<a class="headerlink" href="#dbm-check-if-exist-prof-byid" title="Permalink to this headline">¶</a></h3>
<p>Check if exists a profile by Id.</p>
<p><em>Parameters</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">$1</span></code>:  id of the profile to check.</li>
</ul>
<p><em>Return</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">0</span></code>: profile exists.</li>
<li><code class="docutils literal"><span class="pre">1</span></code>: profile not exists.</li>
</ul>
<script type="text/javascript">
    function showhide(element){
        if (!document.getElementById)
            return
        if (element.style.display == "block")
            element.style.display = "none"
        else
            element.style.display = "block"
    };
</script>
<a href="javascript:showhide(document.getElementById('hiddencodeblock118'))">(Show/Hide)</a><br /><div id="hiddencodeblock118" style="display: none"><div class="highlight-bash"><div class="highlight"><pre><span></span>_dbm_check_if_exist_prof_byid <span class="o">()</span> <span class="o">{</span>

  <span class="nb">local</span> <span class="nv">id_profile</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>

  <span class="nb">local</span> <span class="nv">query</span><span class="o">=</span><span class="s2">&quot;</span>
<span class="s2">    SELECT COUNT(1)</span>
<span class="s2">    FROM Profiles</span>
<span class="s2">    WHERE id_profile = </span><span class="nv">$id_profile</span><span class="s2">&quot;</span>

  _sqlite_query -c <span class="s2">&quot;</span><span class="nv">$DRM_DB</span><span class="s2">&quot;</span> -q <span class="s2">&quot;</span><span class="nv">$query</span><span class="s2">&quot;</span> <span class="o">||</span> error_handled <span class="s2">&quot;Unexpected error!&quot;</span>

  <span class="k">if</span> <span class="o">[</span> x<span class="s2">&quot;</span><span class="nv">$_sqlite_ans</span><span class="s2">&quot;</span> !<span class="o">=</span> x<span class="s2">&quot;1&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    error_generate <span class="s2">&quot;Invalid id_profile </span><span class="nv">$id_profile</span><span class="s2">.&quot;</span>
  <span class="k">fi</span>

  <span class="k">return</span> 0
<span class="o">}</span>
</pre></div>
</div>
</div></div>
<div class="section" id="dbm-check-if-exist-prof-byname">
<span id="dbm-check-if-exist-prof-byname"></span><h3>_dbm_check_if_exist_prof_byname<a class="headerlink" href="#dbm-check-if-exist-prof-byname" title="Permalink to this headline">¶</a></h3>
<p>Check if exists a profile by name.</p>
<p><em>Parameters</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">$1</span></code>:  Name of the profile to check.</li>
</ul>
<p><em>Return</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">0</span></code>: profile exists.</li>
<li><code class="docutils literal"><span class="pre">1</span></code>: profile not exists.</li>
</ul>
<script type="text/javascript">
    function showhide(element){
        if (!document.getElementById)
            return
        if (element.style.display == "block")
            element.style.display = "none"
        else
            element.style.display = "block"
    };
</script>
<a href="javascript:showhide(document.getElementById('hiddencodeblock119'))">(Show/Hide)</a><br /><div id="hiddencodeblock119" style="display: none"><div class="highlight-bash"><div class="highlight"><pre><span></span>_dbm_check_if_exist_prof_byname <span class="o">()</span> <span class="o">{</span>

  <span class="nb">local</span> <span class="nv">profile_name</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>

  <span class="nb">local</span> <span class="nv">query</span><span class="o">=</span><span class="s2">&quot;</span>
<span class="s2">    SELECT COUNT(1)</span>
<span class="s2">    FROM Profiles</span>
<span class="s2">    WHERE profile_name = &#39;</span><span class="nv">$profile_name</span><span class="s2">&#39;&quot;</span>

  _sqlite_query -c <span class="s2">&quot;</span><span class="nv">$DRM_DB</span><span class="s2">&quot;</span> -q <span class="s2">&quot;</span><span class="nv">$query</span><span class="s2">&quot;</span> <span class="o">||</span> error_handled <span class="s2">&quot;Unexpected error!&quot;</span>

  <span class="k">if</span> <span class="o">[</span> x<span class="s2">&quot;</span><span class="nv">$_sqlite_ans</span><span class="s2">&quot;</span> !<span class="o">=</span> x<span class="s2">&quot;1&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    error_generate <span class="s2">&quot;Invalid profile_name </span><span class="nv">$profile_name</span><span class="s2">.&quot;</span>
  <span class="k">fi</span>

  <span class="k">return</span> 0
<span class="o">}</span>
</pre></div>
</div>
</div></div>
<div class="section" id="dbm-check-if-exist-rel">
<span id="dbm-check-if-exist-rel"></span><h3>_dbm_check_if_exist_rel<a class="headerlink" href="#dbm-check-if-exist-rel" title="Permalink to this headline">¶</a></h3>
<p>Check if exists release by name and version.</p>
<p><em>Parameters</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">$1</span></code>: Name of the release to check.</li>
<li><code class="docutils literal"><span class="pre">$2</span></code>: Version of the release to check</li>
</ul>
<p><em>Return</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">0</span></code>: release is present.</li>
<li><code class="docutils literal"><span class="pre">1</span></code>: release is not present.</li>
</ul>
<script type="text/javascript">
    function showhide(element){
        if (!document.getElementById)
            return
        if (element.style.display == "block")
            element.style.display = "none"
        else
            element.style.display = "block"
    };
</script>
<a href="javascript:showhide(document.getElementById('hiddencodeblock120'))">(Show/Hide)</a><br /><div id="hiddencodeblock120" style="display: none"><div class="highlight-bash"><div class="highlight"><pre><span></span>_dbm_check_if_exist_rel <span class="o">()</span> <span class="o">{</span>

  <span class="nb">local</span> <span class="nv">rel_name</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
  <span class="nb">local</span> <span class="nv">rel_version</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span>

  <span class="nb">local</span> <span class="nv">query</span><span class="o">=</span><span class="s2">&quot;SELECT COUNT(1) AS res FROM Releases WHERE name = &#39;</span><span class="nv">$rel_name</span><span class="s2">&#39; AND version = &#39;</span><span class="nv">$rel_version</span><span class="s2">&#39;&quot;</span>

  _sqlite_query -c <span class="s2">&quot;</span><span class="nv">$DRM_DB</span><span class="s2">&quot;</span> -q <span class="s2">&quot;</span><span class="nv">$query</span><span class="s2">&quot;</span> <span class="o">||</span> error_handled <span class="s2">&quot;Unexpected error!&quot;</span>

  <span class="k">if</span> <span class="o">[</span> x<span class="s2">&quot;</span><span class="nv">$_sqlite_ans</span><span class="s2">&quot;</span> !<span class="o">=</span> x<span class="s2">&quot;1&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    error_generate <span class="s2">&quot;Invalid version </span><span class="nv">$rel_version</span><span class="s2">.&quot;</span>
  <span class="k">fi</span>

  <span class="k">return</span> 0
<span class="o">}</span>
</pre></div>
</div>
</div></div>
<div class="section" id="dbm-retrieve-script-data">
<span id="dbm-retrieve-script-data"></span><h3>_dbm_retrieve_script_data<a class="headerlink" href="#dbm-retrieve-script-data" title="Permalink to this headline">¶</a></h3>
<p>Retrieve script data.
If second parameter is valorized then are set these variables:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">DBM_SCRIPT_ID</span></code>: Script Id</li>
<li><code class="docutils literal"><span class="pre">DBM_SCRIPT_FILENAME</span></code>: Script filename</li>
<li><code class="docutils literal"><span class="pre">DBM_SCRIPT_TYPE</span></code>: Script type string.</li>
<li><code class="docutils literal"><span class="pre">DBM_SCRIPT_ACTIVE</span></code>: Active flag</li>
<li><code class="docutils literal"><span class="pre">DBM_SCRIPT_DIR</span></code>: Directory of the script.</li>
<li><code class="docutils literal"><span class="pre">DBM_SCRIPT_ID_RELEASE</span></code>: Id of the release connected to script.</li>
<li><code class="docutils literal"><span class="pre">DBM_SCRIPT_ID_ORDER</span></code>: Id Order of the script.</li>
<li><code class="docutils literal"><span class="pre">DBM_SCRIPT_REL_NAME</span></code>: Release name connected to script.</li>
<li><code class="docutils literal"><span class="pre">DBM_SCRIPT_REL_VERSION</span></code>: Release version connected to script.</li>
<li><code class="docutils literal"><span class="pre">DBM_SCRIPT_ADAPTER</span></code>: adapter of the script.</li>
</ul>
<p><em>Parameters</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">$1</span></code>: Script Id</li>
<li><code class="docutils literal"><span class="pre">$2</span></code>: Set 1 or to a string with a len grether then 0 to set described variables.</li>
</ul>
<p><em>Return</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">0</span></code>: on sucess</li>
<li><code class="docutils literal"><span class="pre">1</span></code>: on error</li>
</ul>
<script type="text/javascript">
    function showhide(element){
        if (!document.getElementById)
            return
        if (element.style.display == "block")
            element.style.display = "none"
        else
            element.style.display = "block"
    };
</script>
<a href="javascript:showhide(document.getElementById('hiddencodeblock121'))">(Show/Hide)</a><br /><div id="hiddencodeblock121" style="display: none"><div class="highlight-bash"><div class="highlight"><pre><span></span>_dbm_retrieve_script_data <span class="o">()</span> <span class="o">{</span>

  <span class="nb">local</span> <span class="nv">id_script</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
  <span class="nb">local</span> <span class="nv">set_variables</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span>

  <span class="nb">local</span> <span class="nv">query</span><span class="o">=</span><span class="s2">&quot;</span>
<span class="s2">    SELECT s.id_script,s.filename,s.type,</span>
<span class="s2">           s.active,s.directory,s.id_release,</span>
<span class="s2">           s.id_order,</span>
<span class="s2">           r.name,</span>
<span class="s2">           r.version,</span>
<span class="s2">           r.db_adapter,</span>
<span class="s2">           s.creation_date,s.update_date</span>
<span class="s2">    FROM Scripts s, Releases r</span>
<span class="s2">    WHERE id_script = </span><span class="nv">$id_script</span><span class="s2"></span>
<span class="s2">    AND s.id_release = r.id_release&quot;</span>

  _sqlite_query -c <span class="s2">&quot;</span><span class="nv">$DRM_DB</span><span class="s2">&quot;</span> -q <span class="s2">&quot;</span><span class="nv">$query</span><span class="s2">&quot;</span> <span class="o">||</span> error_generate <span class="s2">&quot;Unexpected error on retrieve data of the script </span><span class="nv">$id_script</span><span class="s2">&quot;</span>

  <span class="k">if</span> <span class="o">[</span> x<span class="s2">&quot;</span><span class="nv">$_sqlite_ans</span><span class="s2">&quot;</span> !<span class="o">=</span> x<span class="s2">&quot;1&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    error_generate <span class="s2">&quot;Error on retrive data of the script </span><span class="nv">$id_script</span><span class="s2">.&quot;</span>
  <span class="k">fi</span>

  <span class="k">if</span> <span class="o">[</span> ! -z <span class="s2">&quot;</span><span class="nv">$set_variables</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>

    <span class="nv">DBM_SCRIPT_ID</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$_sqlite_ans</span> <span class="p">|</span> awk <span class="s1">&#39;{split($0,a,&quot;|&quot;); print a[1]}&#39;</span><span class="sb">`</span>
    <span class="nv">DBM_SCRIPT_FILENAME</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$_sqlite_ans</span> <span class="p">|</span> awk <span class="s1">&#39;{split($0,a,&quot;|&quot;); print a[2]}&#39;</span><span class="sb">`</span>
    <span class="nv">DBM_SCRIPT_TYPE</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$_sqlite_ans</span> <span class="p">|</span> awk <span class="s1">&#39;{split($0,a,&quot;|&quot;); print a[3]}&#39;</span><span class="sb">`</span>
    <span class="nv">DBM_SCRIPT_ACTIVE</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$_sqlite_ans</span> <span class="p">|</span> awk <span class="s1">&#39;{split($0,a,&quot;|&quot;); print a[4]}&#39;</span><span class="sb">`</span>
    <span class="nv">DBM_SCRIPT_DIR</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$_sqlite_ans</span> <span class="p">|</span> awk <span class="s1">&#39;{split($0,a,&quot;|&quot;); print a[5]}&#39;</span><span class="sb">`</span>
    <span class="nv">DBM_SCRIPT_ID_RELEASE</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$_sqlite_ans</span> <span class="p">|</span> awk <span class="s1">&#39;{split($0,a,&quot;|&quot;); print a[6]}&#39;</span><span class="sb">`</span>
    <span class="nv">DBM_SCRIPT_ID_ORDER</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$_sqlite_ans</span> <span class="p">|</span> awk <span class="s1">&#39;{split($0,a,&quot;|&quot;); print a[7]}&#39;</span><span class="sb">`</span>
    <span class="nv">DBM_SCRIPT_REL_NAME</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$_sqlite_ans</span> <span class="p">|</span> awk <span class="s1">&#39;{split($0,a,&quot;|&quot;); print a[8]}&#39;</span><span class="sb">`</span>
    <span class="nv">DBM_SCRIPT_REL_VERSION</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$_sqlite_ans</span> <span class="p">|</span> awk <span class="s1">&#39;{split($0,a,&quot;|&quot;); print a[9]}&#39;</span><span class="sb">`</span>
    <span class="nv">DBM_SCRIPT_ADAPTER</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$_sqlite_ans</span> <span class="p">|</span> awk <span class="s1">&#39;{split($0,a,&quot;|&quot;); print a[10]}&#39;</span><span class="sb">`</span>

  <span class="k">fi</span>

  <span class="k">return</span> 0
<span class="o">}</span>
</pre></div>
</div>
</div></div>
<div class="section" id="dbm-retrieve-first-release">
<span id="dbm-retrieve-first-release"></span><h3>_dbm_retrieve_first_release<a class="headerlink" href="#dbm-retrieve-first-release" title="Permalink to this headline">¶</a></h3>
<p>Retrieve first release data by release/project name.
If release is present then are valorized these variables:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">DBM_REL_ID_RELEASE</span></code>: Id of the release.</li>
<li><code class="docutils literal"><span class="pre">DBM_REL_VERSION</span></code>: Version of the release.</li>
</ul>
<p><em>Parameters</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">$1</span></code>: Name of the release/project.</li>
</ul>
<p><em>Return</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">0</span></code>: on sucess</li>
<li><code class="docutils literal"><span class="pre">1</span></code>: on error</li>
</ul>
<script type="text/javascript">
    function showhide(element){
        if (!document.getElementById)
            return
        if (element.style.display == "block")
            element.style.display = "none"
        else
            element.style.display = "block"
    };
</script>
<a href="javascript:showhide(document.getElementById('hiddencodeblock122'))">(Show/Hide)</a><br /><div id="hiddencodeblock122" style="display: none"><div class="highlight-bash"><div class="highlight"><pre><span></span>_dbm_retrieve_first_release <span class="o">()</span> <span class="o">{</span>

  <span class="nb">local</span> <span class="nv">name</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>

  <span class="nb">local</span> <span class="nv">query</span><span class="o">=</span><span class="s2">&quot;</span>
<span class="s2">    SELECT r.id_release,</span>
<span class="s2">           r.version</span>
<span class="s2">    FROM Releases r</span>
<span class="s2">    WHERE r.name = &#39;</span><span class="nv">$name</span><span class="s2">&#39;</span>
<span class="s2">    ORDER BY r.id_order</span>
<span class="s2">    LIMIT 1</span>
<span class="s2">  &quot;</span>

  _sqlite_query -c <span class="s2">&quot;</span><span class="nv">$DRM_DB</span><span class="s2">&quot;</span> -q <span class="s2">&quot;</span><span class="nv">$query</span><span class="s2">&quot;</span> <span class="o">||</span> <span class="se">\</span>
    error_generate <span class="s2">&quot;Unexpected error on retrieve first release for project </span><span class="nv">$name</span><span class="s2">&quot;</span>

  <span class="k">if</span> <span class="o">[</span> -z <span class="s2">&quot;</span><span class="nv">$_sqlite_ans</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    error_generate <span class="s2">&quot;No release found for project </span><span class="nv">$name</span><span class="s2">&quot;</span>
  <span class="k">fi</span>

  <span class="nv">DBM_REL_ID_RELEASE</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$_sqlite_ans</span> <span class="p">|</span> awk <span class="s1">&#39;{split($0,a,&quot;|&quot;); print a[1]}&#39;</span><span class="sb">`</span>
  <span class="nv">DBM_REL_VERSION</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$_sqlite_ans</span> <span class="p">|</span> awk <span class="s1">&#39;{split($0,a,&quot;|&quot;); print a[2]}&#39;</span><span class="sb">`</span>

  <span class="k">return</span> 0
<span class="o">}</span>
</pre></div>
</div>
</div></div>
<div class="section" id="dbm-check-if-exist-id-script">
<span id="dbm-check-if-exist-id-script"></span><h3>_dbm_check_if_exist_id_script<a class="headerlink" href="#dbm-check-if-exist-id-script" title="Permalink to this headline">¶</a></h3>
<p>Check if exists a script by Id.</p>
<p><em>Parameters</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">$1</span></code>: Id of the script</li>
<li><code class="docutils literal"><span class="pre">$2</span></code>: Id of the release (optional).</li>
</ul>
<p><em>Return</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">0</span></code>: script is present.</li>
<li><code class="docutils literal"><span class="pre">1</span></code>: script isn&#8217;t present. (An exit 1 command is call if not present)</li>
</ul>
<script type="text/javascript">
    function showhide(element){
        if (!document.getElementById)
            return
        if (element.style.display == "block")
            element.style.display = "none"
        else
            element.style.display = "block"
    };
</script>
<a href="javascript:showhide(document.getElementById('hiddencodeblock123'))">(Show/Hide)</a><br /><div id="hiddencodeblock123" style="display: none"><div class="highlight-bash"><div class="highlight"><pre><span></span>_dbm_check_if_exist_id_script <span class="o">()</span> <span class="o">{</span>

  <span class="nb">local</span> <span class="nv">id_script</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
  <span class="nb">local</span> <span class="nv">id_release</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span>
  <span class="nb">local</span> <span class="nv">query</span><span class="o">=</span><span class="s2">&quot;SELECT COUNT(1) AS res FROM Scripts WHERE id_script = </span><span class="nv">$id_script</span><span class="s2">&quot;</span>

  <span class="k">if</span> <span class="o">[</span> -n <span class="s2">&quot;</span><span class="nv">$id_release</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>

    <span class="nv">query</span><span class="o">=</span><span class="nv">$query</span><span class="s2">&quot; AND id_release = </span><span class="nv">$id_release</span><span class="s2">&quot;</span>
  <span class="k">fi</span>

  _sqlite_query -c <span class="s2">&quot;</span><span class="nv">$DRM_DB</span><span class="s2">&quot;</span> -q <span class="s2">&quot;</span><span class="nv">$query</span><span class="s2">&quot;</span> <span class="o">||</span> error_handled <span class="s2">&quot;Unexpected error!&quot;</span>

  <span class="k">if</span> <span class="o">[</span> x<span class="s2">&quot;</span><span class="nv">$_sqlite_ans</span><span class="s2">&quot;</span> !<span class="o">=</span> x<span class="s2">&quot;1&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    error_generate <span class="s2">&quot;Invalid id_script </span><span class="nv">$id_script</span><span class="s2">.&quot;</span>
  <span class="k">fi</span>

  <span class="k">return</span> 0
<span class="o">}</span>
</pre></div>
</div>
</div></div>
<div class="section" id="dbm-check-if-exist-id-branch">
<span id="dbm-check-if-exist-id-branch"></span><h3>_dbm_check_if_exist_id_branch<a class="headerlink" href="#dbm-check-if-exist-id-branch" title="Permalink to this headline">¶</a></h3>
<p>Check if exists a branch with input id.</p>
<p><em>Parameters</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">$1</span></code>: Id of the branch</li>
</ul>
<p><em>Return</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">0</span></code>: branch is present</li>
<li><code class="docutils literal"><span class="pre">1</span></code>: branch isn&#8217;t present. (An exit 1 command is call if not present)</li>
</ul>
<script type="text/javascript">
    function showhide(element){
        if (!document.getElementById)
            return
        if (element.style.display == "block")
            element.style.display = "none"
        else
            element.style.display = "block"
    };
</script>
<a href="javascript:showhide(document.getElementById('hiddencodeblock124'))">(Show/Hide)</a><br /><div id="hiddencodeblock124" style="display: none"><div class="highlight-bash"><div class="highlight"><pre><span></span>_dbm_check_if_exist_id_branch <span class="o">()</span> <span class="o">{</span>

  <span class="nb">local</span> <span class="nv">id_branch</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
  <span class="nb">local</span> <span class="nv">query</span><span class="o">=</span><span class="s2">&quot;SELECT COUNT(1) AS res FROM Branches WHERE id_branch = </span><span class="nv">$id_branch</span><span class="s2">&quot;</span>

  _sqlite_query -c <span class="s2">&quot;</span><span class="nv">$DRM_DB</span><span class="s2">&quot;</span> -q <span class="s2">&quot;</span><span class="nv">$query</span><span class="s2">&quot;</span> <span class="o">||</span> error_handled <span class="s2">&quot;Unexpected error!&quot;</span>

  <span class="k">if</span> <span class="o">[</span> x<span class="s2">&quot;</span><span class="nv">$_sqlite_ans</span><span class="s2">&quot;</span> !<span class="o">=</span> x<span class="s2">&quot;1&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    error_generate <span class="s2">&quot;Invalid id_branch </span><span class="nv">$id_branch</span><span class="s2">.&quot;</span>
  <span class="k">fi</span>

  <span class="k">return</span> 0
<span class="o">}</span>
</pre></div>
</div>
</div></div>
<div class="section" id="dbm-check-if-exist-id-rel">
<span id="dbm-check-if-exist-id-rel"></span><h3>_dbm_check_if_exist_id_rel<a class="headerlink" href="#dbm-check-if-exist-id-rel" title="Permalink to this headline">¶</a></h3>
<p>Check if exists a release with input id.</p>
<p><em>Parameters</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">$1</span></code>: Id of the release</li>
</ul>
<p><em>Return</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">0</span></code>: release is present</li>
<li><code class="docutils literal"><span class="pre">1</span></code>: release isn&#8217;t present. (An exit 1 command is call if not present)</li>
</ul>
<script type="text/javascript">
    function showhide(element){
        if (!document.getElementById)
            return
        if (element.style.display == "block")
            element.style.display = "none"
        else
            element.style.display = "block"
    };
</script>
<a href="javascript:showhide(document.getElementById('hiddencodeblock125'))">(Show/Hide)</a><br /><div id="hiddencodeblock125" style="display: none"><div class="highlight-bash"><div class="highlight"><pre><span></span>_dbm_check_if_exist_id_rel <span class="o">()</span> <span class="o">{</span>

  <span class="nb">local</span> <span class="nv">id_release</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
  <span class="nb">local</span> <span class="nv">query</span><span class="o">=</span><span class="s2">&quot;SELECT COUNT(1) AS res FROM Releases WHERE id_release = </span><span class="nv">$id_release</span><span class="s2">&quot;</span>

  _sqlite_query -c <span class="s2">&quot;</span><span class="nv">$DRM_DB</span><span class="s2">&quot;</span> -q <span class="s2">&quot;</span><span class="nv">$query</span><span class="s2">&quot;</span> <span class="o">||</span> error_handled <span class="s2">&quot;Unexpected error!&quot;</span>

  <span class="k">if</span> <span class="o">[</span> x<span class="s2">&quot;</span><span class="nv">$_sqlite_ans</span><span class="s2">&quot;</span> !<span class="o">=</span> x<span class="s2">&quot;1&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    error_generate <span class="s2">&quot;Invalid id_release </span><span class="nv">$id_release</span><span class="s2">.&quot;</span>
  <span class="k">fi</span>

  <span class="k">return</span> 0
<span class="o">}</span>
</pre></div>
</div>
</div></div>
<div class="section" id="dbm-retrieve-field-rel">
<span id="dbm-retrieve-field-rel"></span><h3>_dbm_retrieve_field_rel<a class="headerlink" href="#dbm-retrieve-field-rel" title="Permalink to this headline">¶</a></h3>
<p>Retrieve a list of fields related with a release (by name and version).
On success, data are available through <code class="docutils literal"><span class="pre">_sqlite_ans</span></code> variable</p>
<p><em>Parameters</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">$1</span></code>: a list of fields separeted by , to retrieve</li>
<li><code class="docutils literal"><span class="pre">$2</span></code>: name of the release</li>
<li><code class="docutils literal"><span class="pre">$3</span></code>: version of the release.</li>
</ul>
<p><em>Return</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">0</span></code>: on success</li>
<li><code class="docutils literal"><span class="pre">1</span></code>: on error. (An exit 1 command is call if no data are found)</li>
</ul>
<script type="text/javascript">
    function showhide(element){
        if (!document.getElementById)
            return
        if (element.style.display == "block")
            element.style.display = "none"
        else
            element.style.display = "block"
    };
</script>
<a href="javascript:showhide(document.getElementById('hiddencodeblock126'))">(Show/Hide)</a><br /><div id="hiddencodeblock126" style="display: none"><div class="highlight-bash"><div class="highlight"><pre><span></span>_dbm_retrieve_field_rel <span class="o">()</span> <span class="o">{</span>

  <span class="nb">local</span> <span class="nv">field</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
  <span class="nb">local</span> <span class="nv">rel_name</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span>
  <span class="nb">local</span> <span class="nv">rel_version</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$3</span><span class="s2">&quot;</span>

  <span class="nb">local</span> <span class="nv">query</span><span class="o">=</span><span class="s2">&quot;SELECT </span><span class="nv">$field</span><span class="s2"> FROM Releases WHERE name = &#39;</span><span class="nv">$rel_name</span><span class="s2">&#39; AND version = &#39;</span><span class="nv">$rel_version</span><span class="s2">&#39;&quot;</span>

  _sqlite_query -c <span class="s2">&quot;</span><span class="nv">$DRM_DB</span><span class="s2">&quot;</span> -q <span class="s2">&quot;</span><span class="nv">$query</span><span class="s2">&quot;</span> <span class="o">||</span> error_handled <span class="s2">&quot;Unexpected error!&quot;</span>

  <span class="k">if</span> <span class="o">[</span> x<span class="s2">&quot;</span><span class="nv">$_sqlite_ans</span><span class="s2">&quot;</span> <span class="o">==</span> x<span class="s2">&quot;&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="o">[[</span> <span class="nv">$DEBUG</span> <span class="o">&amp;&amp;</span> <span class="nv">$DEBUG</span> <span class="o">==</span> <span class="nb">true</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="se">\</span>
      <span class="nb">echo</span> -en <span class="s2">&quot;Error on retrieve field </span><span class="nv">$field</span><span class="s2"> for release </span><span class="nv">$rel_name</span><span class="s2"> and version </span><span class="nv">$rel_version</span><span class="s2">\n&quot;</span>
    error_generate <span class="s2">&quot;Invalid version </span><span class="nv">$rel_version</span><span class="s2">.&quot;</span>
  <span class="k">fi</span>

  <span class="k">return</span> 0
<span class="o">}</span>
</pre></div>
</div>
</div></div>
<div class="section" id="dbm-retrieve-field-rel-byid">
<span id="dbm-retrieve-field-rel-byid"></span><h3>_dbm_retrieve_field_rel_byid<a class="headerlink" href="#dbm-retrieve-field-rel-byid" title="Permalink to this headline">¶</a></h3>
<p>Retrieve a list of fields related with a release (by id)
On success, data are available through <code class="docutils literal"><span class="pre">_sqlite_ans</span></code> variable</p>
<p><em>Parameters</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">$1</span></code>: a list of fields separeted by , to retrieve</li>
<li><code class="docutils literal"><span class="pre">$2</span></code>: id of the release</li>
</ul>
<p><em>Return</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">0</span></code>: on success</li>
<li><code class="docutils literal"><span class="pre">1</span></code>: on error. (An exit 1 command is call if no data are found)</li>
</ul>
<script type="text/javascript">
    function showhide(element){
        if (!document.getElementById)
            return
        if (element.style.display == "block")
            element.style.display = "none"
        else
            element.style.display = "block"
    };
</script>
<a href="javascript:showhide(document.getElementById('hiddencodeblock127'))">(Show/Hide)</a><br /><div id="hiddencodeblock127" style="display: none"><div class="highlight-bash"><div class="highlight"><pre><span></span>_dbm_retrieve_field_rel_byid <span class="o">()</span> <span class="o">{</span>

  <span class="nb">local</span> <span class="nv">field</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
  <span class="nb">local</span> <span class="nv">id_release</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span>

  <span class="nb">local</span> <span class="nv">query</span><span class="o">=</span><span class="s2">&quot;SELECT </span><span class="nv">$field</span><span class="s2"> FROM Releases WHERE id_release = </span><span class="nv">$id_release</span><span class="s2"> &quot;</span>

  _sqlite_query -c <span class="s2">&quot;</span><span class="nv">$DRM_DB</span><span class="s2">&quot;</span> -q <span class="s2">&quot;</span><span class="nv">$query</span><span class="s2">&quot;</span> <span class="o">||</span> error_handled <span class="s2">&quot;Unexpected error!&quot;</span>

  <span class="k">if</span> <span class="o">[</span> x<span class="s2">&quot;</span><span class="nv">$_sqlite_ans</span><span class="s2">&quot;</span> <span class="o">==</span> x<span class="s2">&quot;&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="o">[[</span> <span class="nv">$DEBUG</span> <span class="o">&amp;&amp;</span> <span class="nv">$DEBUG</span> <span class="o">==</span> <span class="nb">true</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="se">\</span>
      <span class="nb">echo</span> -en <span class="s2">&quot;Error on retrieve field </span><span class="nv">$field</span><span class="s2"> for release id </span><span class="nv">$id_release</span><span class="s2">.\n&quot;</span>
    error_generate <span class="s2">&quot;Invalid version </span><span class="nv">$id_release</span><span class="s2">.&quot;</span>
  <span class="k">fi</span>

  <span class="k">return</span> 0
<span class="o">}</span>
</pre></div>
</div>
</div></div>
<div class="section" id="dbm-retrieve-field-script">
<span id="dbm-retrieve-field-script"></span><h3>_dbm_retrieve_field_script<a class="headerlink" href="#dbm-retrieve-field-script" title="Permalink to this headline">¶</a></h3>
<p>Retrieve a list of fields related with a script (by id).
On success, data are available through <code class="docutils literal"><span class="pre">_sqlite_ans</span></code> variable</p>
<p><em>Parameters</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">$1</span></code>: a list of fields separeted by , to retrieve</li>
<li><code class="docutils literal"><span class="pre">$2</span></code>: id of the script</li>
</ul>
<p><em>Return</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">0</span></code>: on success</li>
<li><code class="docutils literal"><span class="pre">1</span></code>: on error. (An exit 1 command is call if no data are found)</li>
</ul>
<script type="text/javascript">
    function showhide(element){
        if (!document.getElementById)
            return
        if (element.style.display == "block")
            element.style.display = "none"
        else
            element.style.display = "block"
    };
</script>
<a href="javascript:showhide(document.getElementById('hiddencodeblock128'))">(Show/Hide)</a><br /><div id="hiddencodeblock128" style="display: none"><div class="highlight-bash"><div class="highlight"><pre><span></span>_dbm_retrieve_field_script <span class="o">()</span> <span class="o">{</span>

  <span class="nb">local</span> <span class="nv">field</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
  <span class="nb">local</span> <span class="nv">id_script</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span>

  <span class="nb">local</span> <span class="nv">query</span><span class="o">=</span><span class="s2">&quot;SELECT </span><span class="nv">$field</span><span class="s2"> FROM Scripts WHERE id_script = </span><span class="nv">$id_script</span><span class="s2">&quot;</span>

  _sqlite_query -c <span class="s2">&quot;</span><span class="nv">$DRM_DB</span><span class="s2">&quot;</span> -q <span class="s2">&quot;</span><span class="nv">$query</span><span class="s2">&quot;</span> <span class="o">||</span> error_handled <span class="s2">&quot;Unexpected error!&quot;</span>

  <span class="k">if</span> <span class="o">[</span> x<span class="s2">&quot;</span><span class="nv">$_sqlite_ans</span><span class="s2">&quot;</span> <span class="o">==</span> x<span class="s2">&quot;&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="o">[[</span> <span class="nv">$DEBUG</span> <span class="o">&amp;&amp;</span> <span class="nv">$DEBUG</span> <span class="o">==</span> <span class="nb">true</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="se">\</span>
      <span class="nb">echo</span> -en <span class="s2">&quot;Error on retrieve field </span><span class="nv">$field</span><span class="s2"> for script with id </span><span class="nv">$id_script</span><span class="s2">\n&quot;</span>
    error_generate <span class="s2">&quot;Invalid id_script </span><span class="nv">$id_script</span><span class="s2">&quot;</span>
  <span class="k">fi</span>

  <span class="k">return</span> 0
<span class="o">}</span>
</pre></div>
</div>
</div></div>
<div class="section" id="dbm-get-table-schema">
<span id="dbm-get-table-schema"></span><h3>_dbm_get_table_schema<a class="headerlink" href="#dbm-get-table-schema" title="Permalink to this headline">¶</a></h3>
<p>Retrieve database schema of the input table of DBRM module.</p>
<p><em>Parameters</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">$1</span></code>: table name</li>
</ul>
<p><em>Return</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">0</span></code>: on success</li>
<li><code class="docutils literal"><span class="pre">1</span></code>: on error. (An exit 1 command is call on error).</li>
</ul>
<script type="text/javascript">
    function showhide(element){
        if (!document.getElementById)
            return
        if (element.style.display == "block")
            element.style.display = "none"
        else
            element.style.display = "block"
    };
</script>
<a href="javascript:showhide(document.getElementById('hiddencodeblock129'))">(Show/Hide)</a><br /><div id="hiddencodeblock129" style="display: none"><div class="highlight-bash"><div class="highlight"><pre><span></span>_dbm_get_table_schema <span class="o">()</span> <span class="o">{</span>

  <span class="nb">local</span> <span class="nv">table</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>

  <span class="nb">local</span> <span class="nv">query</span><span class="o">=</span><span class="s2">&quot;.schema </span><span class="nv">$table</span><span class="s2">&quot;</span>

  _sqlite_query -c <span class="s2">&quot;</span><span class="nv">$DRM_DB</span><span class="s2">&quot;</span> -t <span class="s2">&quot;</span><span class="nv">$table</span><span class="s2">&quot;</span> <span class="o">||</span> error_handled <span class="s2">&quot;&quot;</span>

  <span class="k">return</span> 0
<span class="o">}</span>
</pre></div>
</div>
</div></div>
<div class="section" id="dbm-remove-all-scripts-rel-inhib">
<span id="dbm-remove-all-scripts-rel-inhib"></span><h3>_dbm_remove_all_scripts_rel_inhib<a class="headerlink" href="#dbm-remove-all-scripts-rel-inhib" title="Permalink to this headline">¶</a></h3>
<p>Remove all inhibited scripts from a release.</p>
<p><em>Parameters</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">$1</span></code>: id of the release</li>
</ul>
<p><em>Return</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">0</span></code>: on success</li>
<li><code class="docutils literal"><span class="pre">1</span></code>: on error. (An exit 1 command is call on error).</li>
</ul>
<script type="text/javascript">
    function showhide(element){
        if (!document.getElementById)
            return
        if (element.style.display == "block")
            element.style.display = "none"
        else
            element.style.display = "block"
    };
</script>
<a href="javascript:showhide(document.getElementById('hiddencodeblock130'))">(Show/Hide)</a><br /><div id="hiddencodeblock130" style="display: none"><div class="highlight-bash"><div class="highlight"><pre><span></span>_dbm_remove_all_scripts_rel_inhib <span class="o">()</span> <span class="o">{</span>

  <span class="nb">local</span> <span class="nv">id_release</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>

  <span class="nb">local</span> <span class="nv">query</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
  <span class="nb">local</span> <span class="nv">id_script</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
  <span class="nb">local</span> <span class="nv">release_from</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
  <span class="nb">local</span> <span class="nv">release_to</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
  <span class="nb">local</span> <span class="nv">creation_date</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
  <span class="nb">local</span> <span class="nv">name</span><span class="o">=</span><span class="s2">&quot;&quot;</span>

  <span class="c1"># Check if there are record</span>
  <span class="nv">query</span><span class="o">=</span><span class="s2">&quot;</span>
<span class="s2">    SELECT COUNT(1) AS CNT</span>
<span class="s2">    FROM ScriptRelInhibitions</span>
<span class="s2">    WHERE id_release_from = </span><span class="nv">$id_release</span><span class="s2"></span>
<span class="s2">    OR    id_release_to = </span><span class="nv">$id_release</span><span class="s2">&quot;</span>

  _sqlite_query -c <span class="s2">&quot;</span><span class="nv">$DRM_DB</span><span class="s2">&quot;</span> -q <span class="s2">&quot;</span><span class="nv">$query</span><span class="s2">&quot;</span> <span class="o">||</span> error_handled <span class="s2">&quot;Unexpected error!&quot;</span>

  <span class="k">if</span> <span class="o">[</span> <span class="nv">$_sqlite_ans</span> -ne <span class="m">0</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="nv">query</span><span class="o">=</span><span class="s2">&quot;</span>
<span class="s2">      SELECT R.name,</span>
<span class="s2">             SRI.id_script,</span>
<span class="s2">             R.version AS rel_from,</span>
<span class="s2">             R2.version AS rel_to</span>
<span class="s2">      FROM ScriptRelInhibitions SRI,</span>
<span class="s2">           Releases R,</span>
<span class="s2">           Releases R2</span>
<span class="s2">      WHERE R.id_release = SRI.id_release_from</span>
<span class="s2">      AND R2.id_release = SRI.id_release_to</span>
<span class="s2">      AND (</span>
<span class="s2">          SRI.id_release_from = </span><span class="nv">$id_release</span><span class="s2"></span>
<span class="s2">          OR SRI.id_release_to = </span><span class="nv">$id_release</span><span class="s2"></span>
<span class="s2">      )&quot;</span>

    <span class="c1"># TODO permit to set creation_date on insert script_inhibition_rel record.</span>
    <span class="c1">#      SRI.creation_date</span>

    _sqlite_query -c <span class="s2">&quot;</span><span class="nv">$DRM_DB</span><span class="s2">&quot;</span> -q <span class="s2">&quot;</span><span class="nv">$query</span><span class="s2">&quot;</span> <span class="o">||</span> error_handled <span class="s2">&quot;Unexpected error!&quot;</span>


    <span class="nv">IFS</span><span class="o">=</span><span class="s1">$&#39;\n&#39;</span>
    <span class="k">for</span> row in <span class="nv">$_sqlite_ans</span> <span class="p">;</span> <span class="k">do</span>

      <span class="c1">#[[ $DEBUG ]] &amp;&amp; echo &quot;ROW = ${row}&quot;</span>

      <span class="nv">name</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$row</span> <span class="p">|</span> awk <span class="s1">&#39;{split($0,a,&quot;|&quot;); print a[1]}&#39;</span><span class="sb">`</span>
      <span class="nv">id_script</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$row</span> <span class="p">|</span> awk <span class="s1">&#39;{split($0,a,&quot;|&quot;); print a[2]}&#39;</span><span class="sb">`</span>
      <span class="nv">release_from</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$row</span> <span class="p">|</span> awk <span class="s1">&#39;{split($0,a,&quot;|&quot;); print a[3]}&#39;</span><span class="sb">`</span>
      <span class="nv">release_to</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$row</span> <span class="p">|</span> awk <span class="s1">&#39;{split($0,a,&quot;|&quot;); print a[4]}&#39;</span><span class="sb">`</span>

      _dbm_save2undo <span class="s2">&quot;dbrm dbm insert_inhibit_script -n \&quot;</span><span class="nv">$name</span><span class="s2">\&quot; -i </span><span class="nv">$id_script</span><span class="s2"> -t </span><span class="nv">$release_to</span><span class="s2"> -f </span><span class="nv">$release_from</span><span class="s2"> &quot;</span>

    <span class="k">done</span>
    <span class="nb">unset</span> IFS

    <span class="c1"># Create undo script for every record</span>
    <span class="nv">query</span><span class="o">=</span><span class="s2">&quot;</span>
<span class="s2">      DELETE FROM ScriptRelInhibitions</span>
<span class="s2">      WHERE id_release_from = </span><span class="nv">$id_release</span><span class="s2"></span>
<span class="s2">      OR    id_release_to = </span><span class="nv">$id_release</span><span class="s2">&quot;</span>

      _sqlite_query -c <span class="s2">&quot;</span><span class="nv">$DRM_DB</span><span class="s2">&quot;</span> -q <span class="s2">&quot;</span><span class="nv">$query</span><span class="s2">&quot;</span> <span class="o">||</span> error_handled <span class="s2">&quot;Unexpected error!&quot;</span>

      <span class="k">if</span> <span class="o">[</span> x<span class="s2">&quot;</span><span class="nv">$_sqlite_ans</span><span class="s2">&quot;</span> <span class="o">==</span> x<span class="s2">&quot;&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
        <span class="o">[[</span> <span class="nv">$DEBUG</span> <span class="o">&amp;&amp;</span> <span class="nv">$DEBUG</span> <span class="o">==</span> <span class="nb">true</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="se">\</span>
          <span class="nb">echo</span> -en <span class="s2">&quot;Error on field </span><span class="nv">$field</span><span class="s2"> for release id </span><span class="nv">$id_release</span><span class="s2">.\n&quot;</span>
        error_generate <span class="s2">&quot;Invalid version </span><span class="nv">$id_release</span><span class="s2">.&quot;</span>
      <span class="k">fi</span>

  <span class="k">fi</span>

  <span class="k">return</span> 0
<span class="o">}</span>
</pre></div>
</div>
</div></div>
<div class="section" id="dbm-remove-release">
<span id="id2"></span><h3>_dbm_remove_release<a class="headerlink" href="#dbm-remove-release" title="Permalink to this headline">¶</a></h3>
<p>Remove a release</p>
<p><em>Parameters</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">$1</span></code>: id of the release to remove</li>
</ul>
<p><em>Return</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">0</span></code>: on success</li>
<li><code class="docutils literal"><span class="pre">1</span></code>: on error. (An exit 1 command is call on error).</li>
</ul>
<script type="text/javascript">
    function showhide(element){
        if (!document.getElementById)
            return
        if (element.style.display == "block")
            element.style.display = "none"
        else
            element.style.display = "block"
    };
</script>
<a href="javascript:showhide(document.getElementById('hiddencodeblock131'))">(Show/Hide)</a><br /><div id="hiddencodeblock131" style="display: none"><div class="highlight-bash"><div class="highlight"><pre><span></span>_dbm_remove_release <span class="o">()</span> <span class="o">{</span>

  <span class="nb">local</span> <span class="nv">id_release</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>

  <span class="nb">local</span> <span class="nv">query</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
  <span class="nb">local</span> <span class="nv">name</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
  <span class="nb">local</span> <span class="nv">version</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
  <span class="nb">local</span> <span class="nv">release_date</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
  <span class="nb">local</span> <span class="nv">id_order</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
  <span class="nb">local</span> <span class="nv">db_adapter</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
  <span class="nb">local</span> <span class="nv">id_branch</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
  <span class="nb">local</span> <span class="nv">directory</span><span class="o">=</span><span class="s2">&quot;&quot;</span>

  <span class="c1"># Retrieve release data</span>
  <span class="nv">query</span><span class="o">=</span><span class="s2">&quot;</span>
<span class="s2">    SELECT name, version, release_date, id_order, db_adapter,</span>
<span class="s2">           id_branch, directory</span>
<span class="s2">    FROM Releases</span>
<span class="s2">    WHERE id_release = </span><span class="nv">$id_release</span><span class="s2">&quot;</span>

  _sqlite_query -c <span class="s2">&quot;</span><span class="nv">$DRM_DB</span><span class="s2">&quot;</span> -q <span class="s2">&quot;</span><span class="nv">$query</span><span class="s2">&quot;</span> <span class="o">||</span> error_handled <span class="s2">&quot;Unexpected error!&quot;</span>

  <span class="nv">IFS</span><span class="o">=</span><span class="s1">$&#39;\n&#39;</span>
  <span class="k">for</span> row in <span class="nv">$_sqlite_ans</span> <span class="p">;</span> <span class="k">do</span>

    <span class="c1">#[[ $DEBUG ]] &amp;&amp; echo &quot;ROW = ${row}&quot;</span>

    <span class="nv">name</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$row</span> <span class="p">|</span> awk <span class="s1">&#39;{split($0,a,&quot;|&quot;); print a[1]}&#39;</span><span class="sb">`</span>
    <span class="nv">version</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$row</span> <span class="p">|</span> awk <span class="s1">&#39;{split($0,a,&quot;|&quot;); print a[2]}&#39;</span><span class="sb">`</span>
    <span class="nv">release_date</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$row</span> <span class="p">|</span> awk <span class="s1">&#39;{split($0,a,&quot;|&quot;); print a[3]}&#39;</span> <span class="p">|</span> awk <span class="s1">&#39;{split($0,a,&quot; &quot;); print a[1]}&#39;</span><span class="sb">`</span>
    <span class="nv">id_order</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$row</span> <span class="p">|</span> awk <span class="s1">&#39;{split($0,a,&quot;|&quot;); print a[4]}&#39;</span><span class="sb">`</span>
    <span class="nv">db_adapter</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$row</span> <span class="p">|</span> awk <span class="s1">&#39;{split($0,a,&quot;|&quot;); print a[5]}&#39;</span><span class="sb">`</span>
    <span class="nv">id_branch</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$row</span> <span class="p">|</span> awk <span class="s1">&#39;{split($0,a,&quot;|&quot;); print a[6]}&#39;</span><span class="sb">`</span>
    <span class="nv">directory</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$row</span> <span class="p">|</span> awk <span class="s1">&#39;{split($0,a,&quot;|&quot;); print a[7]}&#39;</span><span class="sb">`</span>

    _dbm_save2undo <span class="s2">&quot;dbrm dbm insert_release -n \&quot;</span><span class="nv">$name</span><span class="s2">\&quot; -d \&quot;</span><span class="nv">$release_date</span><span class="s2">\&quot; -v \&quot;</span><span class="nv">$version</span><span class="s2">\&quot; -a </span><span class="nv">$db_adapter</span><span class="s2"> -b </span><span class="nv">$id_branch</span><span class="s2"> --dir \&quot;</span><span class="nv">$directory</span><span class="s2">\&quot; &quot;</span>

  <span class="k">done</span>
  <span class="nb">unset</span> IFS

  <span class="nv">query</span><span class="o">=</span><span class="s2">&quot;DELETE FROM Releases WHERE id_release = </span><span class="nv">$id_release</span><span class="s2">&quot;</span>

  _sqlite_query -c <span class="s2">&quot;</span><span class="nv">$DRM_DB</span><span class="s2">&quot;</span> -q <span class="s2">&quot;</span><span class="nv">$query</span><span class="s2">&quot;</span> <span class="o">||</span> error_handled <span class="s2">&quot;Unexpected error on remove release </span><span class="nv">$id_release</span><span class="s2">!&quot;</span>

  <span class="k">return</span> 0
<span class="o">}</span>
</pre></div>
</div>
</div></div>
<div class="section" id="dbm-update-idorder">
<span id="dbm-update-idorder"></span><h3>_dbm_update_idorder<a class="headerlink" href="#dbm-update-idorder" title="Permalink to this headline">¶</a></h3>
<p>Update id order of a list of release of the same branch.</p>
<p><em>Parameters</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">$1</span></code>: id of the branch</li>
</ul>
<p><em>Return</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">0</span></code>: on success</li>
<li><code class="docutils literal"><span class="pre">1</span></code>: on error. (An exit 1 command is call on error).</li>
</ul>
<script type="text/javascript">
    function showhide(element){
        if (!document.getElementById)
            return
        if (element.style.display == "block")
            element.style.display = "none"
        else
            element.style.display = "block"
    };
</script>
<a href="javascript:showhide(document.getElementById('hiddencodeblock132'))">(Show/Hide)</a><br /><div id="hiddencodeblock132" style="display: none"><div class="highlight-bash"><div class="highlight"><pre><span></span>_dbm_update_idorder <span class="o">()</span> <span class="o">{</span>

  <span class="nb">local</span> <span class="nv">id_branch</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
  <span class="nb">local</span> <span class="nv">idx</span><span class="o">=</span>0
  <span class="nb">local</span> <span class="nv">id_release</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
  <span class="nb">local</span> <span class="nv">query</span><span class="o">=</span><span class="s2">&quot;</span>
<span class="s2">    SELECT id_release</span>
<span class="s2">    FROM Releases</span>
<span class="s2">    WHERE id_branch = </span><span class="nv">$id_branch</span><span class="s2"></span>
<span class="s2">    ORDER BY id_order</span>
<span class="s2">  &quot;</span>

  _sqlite_query -c <span class="s2">&quot;</span><span class="nv">$DRM_DB</span><span class="s2">&quot;</span> -q <span class="s2">&quot;</span><span class="nv">$query</span><span class="s2">&quot;</span> <span class="o">||</span> error_handled <span class="s2">&quot;Unexpected error on retrieve list of id_release!&quot;</span>

  <span class="nb">declare</span> -a list_id_rels

  <span class="nv">IFS</span><span class="o">=</span><span class="s1">$&#39;\n&#39;</span>
  <span class="k">for</span> row in <span class="nv">$_sqlite_ans</span> <span class="p">;</span> <span class="k">do</span>
    <span class="nv">id_release</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$row</span> <span class="p">|</span> awk <span class="s1">&#39;{split($0,a,&quot;|&quot;); print a[1]}&#39;</span><span class="sb">`</span>
    list_id_rels<span class="o">[</span><span class="nv">$idx</span><span class="o">]=</span><span class="nv">$id_release</span>
    <span class="nb">let</span> idx++
  <span class="k">done</span>
  <span class="nb">unset</span> IFS

  <span class="c1"># Update list of id</span>
  <span class="nv">id_order</span><span class="o">=</span>1
  <span class="nv">idx</span><span class="o">=</span>0

  <span class="k">for</span> e in <span class="si">${</span><span class="p">!list_id_rels[@]</span><span class="si">}</span>
  <span class="k">do</span>

    <span class="nv">id_release</span><span class="o">=</span><span class="si">${</span><span class="nv">list_id_rels</span><span class="p">[</span><span class="nv">$e</span><span class="p">]</span><span class="si">}</span>

    <span class="nv">query</span><span class="o">=</span><span class="s2">&quot;</span>
<span class="s2">      UPDATE Releases</span>
<span class="s2">      SET id_order = </span><span class="nv">$id_order</span><span class="s2"></span>
<span class="s2">      WHERE id_release = </span><span class="nv">$id_release</span><span class="s2"></span>
<span class="s2">    &quot;</span>

    _sqlite_query -c <span class="s2">&quot;</span><span class="nv">$DRM_DB</span><span class="s2">&quot;</span> -q <span class="s2">&quot;</span><span class="nv">$query</span><span class="s2">&quot;</span> <span class="o">||</span> error_handled <span class="s2">&quot;Unexpected error on update id_release </span><span class="nv">$id_release</span><span class="s2">&quot;</span>

    <span class="nb">let</span> id_order++

  <span class="k">done</span>

  <span class="nb">unset</span> list_id_rels

  <span class="k">return</span> 0
<span class="o">}</span>
</pre></div>
</div>
</div></div>
<div class="section" id="dbm-remove-all-scripts-rel-ded">
<span id="dbm-remove-all-scripts-rel-ded"></span><h3>_dbm_remove_all_scripts_rel_ded<a class="headerlink" href="#dbm-remove-all-scripts-rel-ded" title="Permalink to this headline">¶</a></h3>
<p>Remove all dedicated scripts from a release.</p>
<p><em>Parameters</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">$1</span></code>: id of the release</li>
</ul>
<p><em>Return</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">0</span></code>: on success</li>
<li><code class="docutils literal"><span class="pre">1</span></code>: on error. (An exit 1 command is call on error).</li>
</ul>
<script type="text/javascript">
    function showhide(element){
        if (!document.getElementById)
            return
        if (element.style.display == "block")
            element.style.display = "none"
        else
            element.style.display = "block"
    };
</script>
<a href="javascript:showhide(document.getElementById('hiddencodeblock133'))">(Show/Hide)</a><br /><div id="hiddencodeblock133" style="display: none"><div class="highlight-bash"><div class="highlight"><pre><span></span>_dbm_remove_all_scripts_rel_ded <span class="o">()</span> <span class="o">{</span>

  <span class="nb">local</span> <span class="nv">id_release</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>

  <span class="nb">local</span> <span class="nv">query</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
  <span class="nb">local</span> <span class="nv">id_script</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
  <span class="nb">local</span> <span class="nv">release_from</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
  <span class="nb">local</span> <span class="nv">release_to</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
  <span class="nb">local</span> <span class="nv">creation_date</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
  <span class="nb">local</span> <span class="nv">name</span><span class="o">=</span><span class="s2">&quot;&quot;</span>

  <span class="c1"># Check if there are record</span>
  <span class="nv">query</span><span class="o">=</span><span class="s2">&quot;</span>
<span class="s2">    SELECT COUNT(1) AS CNT</span>
<span class="s2">    FROM ScriptRelDedicated</span>
<span class="s2">    WHERE id_release_from = </span><span class="nv">$id_release</span><span class="s2"></span>
<span class="s2">    OR    id_release_to = </span><span class="nv">$id_release</span><span class="s2">&quot;</span>

  _sqlite_query -c <span class="s2">&quot;</span><span class="nv">$DRM_DB</span><span class="s2">&quot;</span> -q <span class="s2">&quot;</span><span class="nv">$query</span><span class="s2">&quot;</span> <span class="o">||</span> error_handled <span class="s2">&quot;Unexpected error!&quot;</span>

  <span class="k">if</span> <span class="o">[</span> <span class="nv">$_sqlite_ans</span> -ne <span class="m">0</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="nv">query</span><span class="o">=</span><span class="s2">&quot;</span>
<span class="s2">      SELECT R.name,</span>
<span class="s2">             SRD.id_script,</span>
<span class="s2">             R.version AS rel_from,</span>
<span class="s2">             R2.version AS rel_to</span>
<span class="s2">      FROM ScriptRelDedicated SRD,</span>
<span class="s2">           Releases R,</span>
<span class="s2">           Releases R2</span>
<span class="s2">      WHERE R.id_release = SRD.id_release_from</span>
<span class="s2">      AND R2.id_release = SRD.id_release_to</span>
<span class="s2">      AND (</span>
<span class="s2">          SRD.id_release_from = </span><span class="nv">$id_release</span><span class="s2"></span>
<span class="s2">          OR SRD.id_release_to = </span><span class="nv">$id_release</span><span class="s2"></span>
<span class="s2">      )&quot;</span>

    <span class="c1"># TODO permit to set creation_date on insert script_dedicated_rel record.</span>
    <span class="c1">#      SRI.creation_date</span>

    _sqlite_query -c <span class="s2">&quot;</span><span class="nv">$DRM_DB</span><span class="s2">&quot;</span> -q <span class="s2">&quot;</span><span class="nv">$query</span><span class="s2">&quot;</span> <span class="o">||</span> error_handled <span class="s2">&quot;Unexpected error!&quot;</span>


    <span class="nv">IFS</span><span class="o">=</span><span class="s1">$&#39;\n&#39;</span>
    <span class="k">for</span> row in <span class="nv">$_sqlite_ans</span> <span class="p">;</span> <span class="k">do</span>

      <span class="c1">#[[ $DEBUG ]] &amp;&amp; echo &quot;ROW = ${row}&quot;</span>

      <span class="nv">name</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$row</span> <span class="p">|</span> awk <span class="s1">&#39;{split($0,a,&quot;|&quot;); print a[1]}&#39;</span><span class="sb">`</span>
      <span class="nv">id_script</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$row</span> <span class="p">|</span> awk <span class="s1">&#39;{split($0,a,&quot;|&quot;); print a[2]}&#39;</span><span class="sb">`</span>
      <span class="nv">release_from</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$row</span> <span class="p">|</span> awk <span class="s1">&#39;{split($0,a,&quot;|&quot;); print a[3]}&#39;</span><span class="sb">`</span>
      <span class="nv">release_to</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$row</span> <span class="p">|</span> awk <span class="s1">&#39;{split($0,a,&quot;|&quot;); print a[4]}&#39;</span><span class="sb">`</span>

      _dbm_save2undo <span class="s2">&quot;dbrm dbm insert_ded_script -n \&quot;</span><span class="nv">$name</span><span class="s2">\&quot; -i </span><span class="nv">$id_script</span><span class="s2"> -t </span><span class="nv">$release_to</span><span class="s2"> -f </span><span class="nv">$release_from</span><span class="s2"> &quot;</span>

    <span class="k">done</span>
    <span class="nb">unset</span> IFS

    <span class="c1"># Create undo script for every record</span>
    <span class="nv">query</span><span class="o">=</span><span class="s2">&quot;</span>
<span class="s2">      DELETE FROM ScriptRelDedicated</span>
<span class="s2">      WHERE id_release_from = </span><span class="nv">$id_release</span><span class="s2"></span>
<span class="s2">      OR    id_release_to = </span><span class="nv">$id_release</span><span class="s2">&quot;</span>

      _sqlite_query -c <span class="s2">&quot;</span><span class="nv">$DRM_DB</span><span class="s2">&quot;</span> -q <span class="s2">&quot;</span><span class="nv">$query</span><span class="s2">&quot;</span> <span class="o">||</span> error_handled <span class="s2">&quot;Unexpected error!&quot;</span>

      <span class="k">if</span> <span class="o">[</span> x<span class="s2">&quot;</span><span class="nv">$_sqlite_ans</span><span class="s2">&quot;</span> <span class="o">==</span> x<span class="s2">&quot;&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
        <span class="o">[[</span> <span class="nv">$DEBUG</span> <span class="o">&amp;&amp;</span> <span class="nv">$DEBUG</span> <span class="o">==</span> <span class="nb">true</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="se">\</span>
          <span class="nb">echo</span> -en <span class="s2">&quot;Error on field </span><span class="nv">$field</span><span class="s2"> for release id </span><span class="nv">$id_release</span><span class="s2">.\n&quot;</span>
        error_generate <span class="s2">&quot;Invalid version </span><span class="nv">$id_release</span><span class="s2">.&quot;</span>
      <span class="k">fi</span>

  <span class="k">fi</span>

  <span class="k">return</span> 0
<span class="o">}</span>
</pre></div>
</div>
</div></div>
<div class="section" id="dbm-save2undo">
<span id="dbm-save2undo"></span><h3>_dbm_save2undo<a class="headerlink" href="#dbm-save2undo" title="Permalink to this headline">¶</a></h3>
<p>Save input command to undo file.</p>
<p><em>Parameters</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">$1</span></code>: message to write.</li>
</ul>
<p><em>Return</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">0</span></code>: on success</li>
<li><code class="docutils literal"><span class="pre">1</span></code>: on error.</li>
</ul>
<script type="text/javascript">
    function showhide(element){
        if (!document.getElementById)
            return
        if (element.style.display == "block")
            element.style.display = "none"
        else
            element.style.display = "block"
    };
</script>
<a href="javascript:showhide(document.getElementById('hiddencodeblock134'))">(Show/Hide)</a><br /><div id="hiddencodeblock134" style="display: none"><div class="highlight-bash"><div class="highlight"><pre><span></span>_dbm_save2undo <span class="o">()</span> <span class="o">{</span>
    <span class="nb">local</span> <span class="nv">msg</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>

    <span class="nb">echo</span> <span class="s2">&quot;</span><span class="nv">$msg</span><span class="s2">&quot;</span> &gt;&gt; <span class="nv">$DBM_UNDO_SCRIPT</span>

    <span class="k">return</span> <span class="nv">$?</span>
<span class="o">}</span>
</pre></div>
</div>
</div></div>
<div class="section" id="dbm-save2history">
<span id="dbm-save2history"></span><h3>_dbm_save2history<a class="headerlink" href="#dbm-save2history" title="Permalink to this headline">¶</a></h3>
<p>Save input command to history file.</p>
<p><em>Parameters</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">$1</span></code>: message to write.</li>
</ul>
<p><em>Return</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">0</span></code>: on success</li>
<li><code class="docutils literal"><span class="pre">1</span></code>: on error.</li>
</ul>
<script type="text/javascript">
    function showhide(element){
        if (!document.getElementById)
            return
        if (element.style.display == "block")
            element.style.display = "none"
        else
            element.style.display = "block"
    };
</script>
<a href="javascript:showhide(document.getElementById('hiddencodeblock135'))">(Show/Hide)</a><br /><div id="hiddencodeblock135" style="display: none"><div class="highlight-bash"><div class="highlight"><pre><span></span>_dbm_save2history <span class="o">()</span> <span class="o">{</span>
    <span class="nb">local</span> <span class="nv">msg</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>

    <span class="nb">echo</span> <span class="s2">&quot;</span><span class="nv">$msg</span><span class="s2">&quot;</span> &gt;&gt; <span class="nv">$DBM_HISTORY</span>

    <span class="k">return</span> <span class="nv">$?</span>
<span class="o">}</span>
</pre></div>
</div>
</div></div>
<div class="section" id="dbm-exts-check-extensions">
<span id="dbm-exts-check-extensions"></span><h3>_dbm_exts_check_extensions<a class="headerlink" href="#dbm-exts-check-extensions" title="Permalink to this headline">¶</a></h3>
<p>Check if all extensions/modules are present on table
Extensions. If not insert row with version.
If there a new version of a module call module upgrade function if is present.</p>
<p><em>Parameters</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">$1</span></code>: string for enable quiet mode (optional).</li>
</ul>
<p><em>Return</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">0</span></code>: on success</li>
<li><code class="docutils literal"><span class="pre">1</span></code>: on error.</li>
</ul>
<script type="text/javascript">
    function showhide(element){
        if (!document.getElementById)
            return
        if (element.style.display == "block")
            element.style.display = "none"
        else
            element.style.display = "block"
    };
</script>
<a href="javascript:showhide(document.getElementById('hiddencodeblock136'))">(Show/Hide)</a><br /><div id="hiddencodeblock136" style="display: none"><div class="highlight-bash"><div class="highlight"><pre><span></span>_dbm_exts_check_extensions <span class="o">()</span> <span class="o">{</span>

  <span class="nb">local</span> <span class="nv">ans</span><span class="o">=</span>0
  <span class="nb">local</span> <span class="nv">v</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
  <span class="nb">local</span> <span class="nv">i</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
  <span class="nb">local</span> <span class="nv">quiet</span><span class="o">=</span><span class="si">${</span><span class="nv">1</span><span class="k">:-</span><span class="nv">0</span><span class="si">}</span>

  <span class="k">for</span> i in <span class="nv">$modules</span> <span class="p">;</span> <span class="k">do</span>

    <span class="nb">eval</span> <span class="nv">v</span><span class="o">=</span><span class="se">\$</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span>_version

    <span class="o">[[</span> x<span class="s2">&quot;</span><span class="si">${</span><span class="nv">quiet</span><span class="si">}</span><span class="s2">&quot;</span> !<span class="o">=</span> x<span class="s2">&quot;0&quot;</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="se">\</span>
      out_handler_print <span class="s2">&quot;Check if extension </span><span class="nv">$i</span><span class="s2"> is present...&quot;</span>

    _dbm_exts_is_present <span class="s2">&quot;</span><span class="nv">$i</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="o">[</span> <span class="nv">$?</span> -eq <span class="m">0</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>

      <span class="o">[[</span> x<span class="s2">&quot;</span><span class="si">${</span><span class="nv">quiet</span><span class="si">}</span><span class="s2">&quot;</span> !<span class="o">=</span> x<span class="s2">&quot;0&quot;</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="se">\</span>
        out_handler_print <span class="s2">&quot;Extension </span><span class="nv">$i</span><span class="s2"> is already present.&quot;</span>

      <span class="c1"># Check if version is equal to current extensions.</span>
      <span class="k">if</span> <span class="o">[</span> <span class="s2">&quot;</span><span class="nv">$v</span><span class="s2">&quot;</span> !<span class="o">=</span> <span class="s2">&quot;</span><span class="si">${</span><span class="nv">_ext_version</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
        <span class="o">[[</span> x<span class="s2">&quot;</span><span class="si">${</span><span class="nv">quiet</span><span class="si">}</span><span class="s2">&quot;</span> !<span class="o">=</span> x<span class="s2">&quot;0&quot;</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="se">\</span>
          out_handler_print <span class="s2">&quot;New version of </span><span class="nv">$i</span><span class="s2"> module. I check for upgrade function.&quot;</span>

        <span class="k">if</span> <span class="o">[</span> <span class="s2">&quot;</span><span class="nv">$i</span><span class="s2">&quot;</span> !<span class="o">=</span> <span class="s2">&quot;dbm&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
          <span class="k">if</span> <span class="nb">type</span> -t <span class="si">${</span><span class="nv">i</span><span class="si">}</span>_upgrade &gt; /dev/null <span class="p">;</span> <span class="k">then</span>
            <span class="si">${</span><span class="nv">i</span><span class="si">}</span>_upgrade <span class="s2">&quot;</span><span class="nv">$v</span><span class="s2">&quot;</span> <span class="o">||</span> error_handled <span class="se">\</span>
              <span class="s2">&quot;(_dbm_exts_check_extensions): Error on upgrade extension </span><span class="nv">$i</span><span class="s2">.&quot;</span>
          <span class="k">fi</span>
        <span class="k">fi</span>

        _dbm_exts_update_extension <span class="s2">&quot;</span><span class="nv">$i</span><span class="s2">&quot;</span> <span class="s2">&quot;</span><span class="nv">$v</span><span class="s2">&quot;</span> <span class="o">||</span> error_handled <span class="s2">&quot;&quot;</span>
      <span class="k">fi</span>
      <span class="nv">ans</span><span class="o">=</span>0

    <span class="k">else</span>

      <span class="c1"># Install extension row.</span>
      <span class="o">[[</span> x<span class="s2">&quot;</span><span class="si">${</span><span class="nv">quiet</span><span class="si">}</span><span class="s2">&quot;</span> !<span class="o">=</span> x<span class="s2">&quot;0&quot;</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="se">\</span>
        out_handler_print <span class="s2">&quot;Extension </span><span class="nv">$i</span><span class="s2"> is not present. I add it.&quot;</span>
      _dbm_exts_inst_extension <span class="s2">&quot;</span><span class="nv">$i</span><span class="s2">&quot;</span> <span class="s2">&quot;</span><span class="nv">$v</span><span class="s2">&quot;</span> <span class="o">||</span> error_handled <span class="s2">&quot;&quot;</span>

    <span class="k">fi</span>

  <span class="k">done</span>

  <span class="k">return</span> <span class="nv">$ans</span>
<span class="o">}</span>
</pre></div>
</div>
</div></div>
<div class="section" id="dbm-exts-is-present">
<span id="dbm-exts-is-present"></span><h3>_dbm_exts_is_present<a class="headerlink" href="#dbm-exts-is-present" title="Permalink to this headline">¶</a></h3>
<p>Check if an extension is present on Extensions table.
Save extension version to <code class="docutils literal"><span class="pre">_ext_version</span></code> variable.</p>
<p><em>Parameters</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">$1</span></code>: Name of the extension.</li>
</ul>
<p><em>Return</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">0</span></code>: extension is present</li>
<li><code class="docutils literal"><span class="pre">1</span></code>: on error or if extension is not present.</li>
</ul>
<script type="text/javascript">
    function showhide(element){
        if (!document.getElementById)
            return
        if (element.style.display == "block")
            element.style.display = "none"
        else
            element.style.display = "block"
    };
</script>
<a href="javascript:showhide(document.getElementById('hiddencodeblock137'))">(Show/Hide)</a><br /><div id="hiddencodeblock137" style="display: none"><div class="highlight-bash"><div class="highlight"><pre><span></span>_dbm_exts_is_present <span class="o">()</span> <span class="o">{</span>

  <span class="nb">local</span> <span class="nv">ext</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>

  <span class="nv">query</span><span class="o">=</span><span class="s2">&quot;</span>
<span class="s2">    SELECT version</span>
<span class="s2">    FROM Extensions</span>
<span class="s2">    WHERE ext_name = &#39;</span><span class="nv">$ext</span><span class="s2">&#39;</span>
<span class="s2">  &quot;</span>

  _sqlite_query -c <span class="s2">&quot;</span><span class="nv">$DRM_DB</span><span class="s2">&quot;</span> -q <span class="s2">&quot;</span><span class="nv">$query</span><span class="s2">&quot;</span> <span class="o">||</span> <span class="k">return</span> 1

  <span class="k">if</span> <span class="o">[[</span> x<span class="s2">&quot;</span><span class="nv">$_sqlite_ans</span><span class="s2">&quot;</span> <span class="o">==</span> x<span class="s2">&quot;\ &quot;</span> <span class="o">||</span> x<span class="s2">&quot;</span><span class="nv">$_sqlite_ans</span><span class="s2">&quot;</span> <span class="o">==</span> x<span class="s2">&quot;&quot;</span> <span class="o">]]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="c1"># Extension is not present.</span>
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="nv">_ext_version</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$_sqlite_ans</span><span class="s2">&quot;</span>

  <span class="k">return</span> 0
<span class="o">}</span>
</pre></div>
</div>
</div></div>
<div class="section" id="dbm-exts-inst-extension">
<span id="dbm-exts-inst-extension"></span><h3>_dbm_exts_inst_extension<a class="headerlink" href="#dbm-exts-inst-extension" title="Permalink to this headline">¶</a></h3>
<p>Install a new extension in Extensions table.</p>
<p><em>Parameters</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">$1</span></code>: Name of the extension.</li>
<li><code class="docutils literal"><span class="pre">$2</span></code>: Version of the extension.</li>
</ul>
<p><em>Return</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">0</span></code>: on success.</li>
<li><code class="docutils literal"><span class="pre">1</span></code>: on error.</li>
</ul>
<script type="text/javascript">
    function showhide(element){
        if (!document.getElementById)
            return
        if (element.style.display == "block")
            element.style.display = "none"
        else
            element.style.display = "block"
    };
</script>
<a href="javascript:showhide(document.getElementById('hiddencodeblock138'))">(Show/Hide)</a><br /><div id="hiddencodeblock138" style="display: none"><div class="highlight-bash"><div class="highlight"><pre><span></span>_dbm_exts_inst_extension <span class="o">()</span> <span class="o">{</span>

  <span class="nb">local</span> <span class="nv">ename</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
  <span class="nb">local</span> <span class="nv">eversion</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span>

  <span class="k">if</span> <span class="o">[[</span> -z <span class="s2">&quot;</span><span class="nv">$ename</span><span class="s2">&quot;</span> <span class="o">||</span> -z <span class="s2">&quot;</span><span class="nv">$eversion</span><span class="s2">&quot;</span> <span class="o">]]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="nb">local</span> <span class="nv">query</span><span class="o">=</span><span class="s2">&quot;</span>
<span class="s2">    INSERT INTO Extensions</span>
<span class="s2">    (ext_name,</span>
<span class="s2">     version,</span>
<span class="s2">     creation_date,</span>
<span class="s2">     update_date)</span>
<span class="s2">    VALUES (</span>
<span class="s2">      &#39;</span><span class="nv">$ename</span><span class="s2">&#39;,</span>
<span class="s2">      &#39;</span><span class="nv">$eversion</span><span class="s2">&#39;,</span>
<span class="s2">      DATETIME(&#39;now&#39;),</span>
<span class="s2">      DATETIME(&#39;now&#39;)</span>
<span class="s2">    );</span>
<span class="s2">  &quot;</span>

  _sqlite_query -c <span class="s2">&quot;</span><span class="nv">$DRM_DB</span><span class="s2">&quot;</span> -q <span class="s2">&quot;</span><span class="nv">$query</span><span class="s2">&quot;</span> <span class="o">||</span> error_handled <span class="se">\</span>
    <span class="s2">&quot;(_dbm_exts_inst_extension): Error on insert extension </span><span class="nv">$ename</span><span class="s2"> (version </span><span class="nv">$eversion</span><span class="s2">).&quot;</span>

  <span class="k">return</span> 0
<span class="o">}</span>
</pre></div>
</div>
</div></div>
<div class="section" id="dbm-exts-update-extension">
<span id="dbm-exts-update-extension"></span><h3>_dbm_exts_update_extension<a class="headerlink" href="#dbm-exts-update-extension" title="Permalink to this headline">¶</a></h3>
<p>Update extension row in Extensions table.</p>
<p><em>Parameters</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">$1</span></code>: Name of the extension.</li>
<li><code class="docutils literal"><span class="pre">$2</span></code>: Version of the extension.</li>
</ul>
<p><em>Return</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">0</span></code>: on success.</li>
<li><code class="docutils literal"><span class="pre">1</span></code>: on error.</li>
</ul>
<script type="text/javascript">
    function showhide(element){
        if (!document.getElementById)
            return
        if (element.style.display == "block")
            element.style.display = "none"
        else
            element.style.display = "block"
    };
</script>
<a href="javascript:showhide(document.getElementById('hiddencodeblock139'))">(Show/Hide)</a><br /><div id="hiddencodeblock139" style="display: none"><div class="highlight-bash"><div class="highlight"><pre><span></span>_dbm_exts_update_extension <span class="o">()</span> <span class="o">{</span>

  <span class="nb">local</span> <span class="nv">ename</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
  <span class="nb">local</span> <span class="nv">eversion</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span>

  <span class="k">if</span> <span class="o">[[</span> -z <span class="s2">&quot;</span><span class="nv">$ename</span><span class="s2">&quot;</span> <span class="o">||</span> -z <span class="s2">&quot;</span><span class="nv">$eversion</span><span class="s2">&quot;</span> <span class="o">]]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="nb">local</span> <span class="nv">query</span><span class="o">=</span><span class="s2">&quot;</span>
<span class="s2">    UPDATE Extensions</span>
<span class="s2">    SET version = &#39;</span><span class="si">${</span><span class="nv">eversion</span><span class="si">}</span><span class="s2">&#39;,</span>
<span class="s2">        update_date = DATETIME(&#39;now&#39;)</span>
<span class="s2">    WHERE ext_name = &#39;</span><span class="si">${</span><span class="nv">ename</span><span class="si">}</span><span class="s2">&#39;</span>
<span class="s2">  &quot;</span>

  _sqlite_query -c <span class="s2">&quot;</span><span class="nv">$DRM_DB</span><span class="s2">&quot;</span> -q <span class="s2">&quot;</span><span class="nv">$query</span><span class="s2">&quot;</span> <span class="o">||</span> error_handled <span class="se">\</span>
    <span class="s2">&quot;(_dbm_exts_inst_extension): Error on update extension </span><span class="nv">$ename</span><span class="s2"> (version </span><span class="nv">$eversion</span><span class="s2">).&quot;</span>

  <span class="k">return</span> 0
<span class="o">}</span>
</pre></div>
</div>
</div></div>
<div class="section" id="dbm-exts-update-extension">
<span id="id3"></span><h3>_dbm_exts_update_extension<a class="headerlink" href="#dbm-exts-update-extension" title="Permalink to this headline">¶</a></h3>
<p>Update extension row in Extensions table.</p>
<p><em>Parameters</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">$1</span></code>: Name of the extension.</li>
<li><code class="docutils literal"><span class="pre">$2</span></code>: Version of the extension.</li>
</ul>
<p><em>Return</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">0</span></code>: on success.</li>
<li><code class="docutils literal"><span class="pre">1</span></code>: on error.</li>
</ul>
<script type="text/javascript">
    function showhide(element){
        if (!document.getElementById)
            return
        if (element.style.display == "block")
            element.style.display = "none"
        else
            element.style.display = "block"
    };
</script>
<a href="javascript:showhide(document.getElementById('hiddencodeblock140'))">(Show/Hide)</a><br /><div id="hiddencodeblock140" style="display: none"><div class="highlight-bash"><div class="highlight"><pre><span></span>_dbm_exts_update_extension <span class="o">()</span> <span class="o">{</span>

  <span class="nb">local</span> <span class="nv">ename</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
  <span class="nb">local</span> <span class="nv">eversion</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span>

  <span class="k">if</span> <span class="o">[[</span> -z <span class="s2">&quot;</span><span class="nv">$ename</span><span class="s2">&quot;</span> <span class="o">||</span> -z <span class="s2">&quot;</span><span class="nv">$eversion</span><span class="s2">&quot;</span> <span class="o">]]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="nb">local</span> <span class="nv">query</span><span class="o">=</span><span class="s2">&quot;</span>
<span class="s2">    UPDATE Extensions</span>
<span class="s2">    SET version = &#39;</span><span class="si">${</span><span class="nv">eversion</span><span class="si">}</span><span class="s2">&#39;,</span>
<span class="s2">        update_date = DATETIME(&#39;now&#39;)</span>
<span class="s2">    WHERE ext_name = &#39;</span><span class="si">${</span><span class="nv">ename</span><span class="si">}</span><span class="s2">&#39;</span>
<span class="s2">  &quot;</span>

  _sqlite_query -c <span class="s2">&quot;</span><span class="nv">$DRM_DB</span><span class="s2">&quot;</span> -q <span class="s2">&quot;</span><span class="nv">$query</span><span class="s2">&quot;</span> <span class="o">||</span> error_handled <span class="se">\</span>
    <span class="s2">&quot;(_dbm_exts_inst_extension): Error on update extension </span><span class="nv">$ename</span><span class="s2"> (version </span><span class="nv">$eversion</span><span class="s2">).&quot;</span>

  <span class="k">return</span> 0
<span class="o">}</span>
</pre></div>
</div>
</div></div>
<div class="section" id="dbm-exts-check-dbm">
<span id="dbm-exts-check-dbm"></span><h3>_dbm_exts_check_dbm<a class="headerlink" href="#dbm-exts-check-dbm" title="Permalink to this headline">¶</a></h3>
<p>Check if dbm module is upgraded.</p>
<p><em>Return</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">0</span></code>: if dbm is updated.</li>
<li><code class="docutils literal"><span class="pre">1</span></code>: on error or an a <em>dbrm dbm upgrade</em> is needed</li>
</ul>
<script type="text/javascript">
    function showhide(element){
        if (!document.getElementById)
            return
        if (element.style.display == "block")
            element.style.display = "none"
        else
            element.style.display = "block"
    };
</script>
<a href="javascript:showhide(document.getElementById('hiddencodeblock141'))">(Show/Hide)</a><br /><div id="hiddencodeblock141" style="display: none"><div class="highlight-bash"><div class="highlight"><pre><span></span>_dbm_exts_check_dbm <span class="o">()</span> <span class="o">{</span>

  <span class="k">if</span> _sqlite_exists_table -c <span class="s2">&quot;</span><span class="nv">$DRM_DB</span><span class="s2">&quot;</span> -t <span class="s2">&quot;Extensions&quot;</span> <span class="p">;</span> <span class="k">then</span>
    <span class="k">return</span> 1
  <span class="k">fi</span>

  _dbm_exts_is_present <span class="s2">&quot;dbm&quot;</span> <span class="o">||</span> <span class="k">return</span> 1

  <span class="k">if</span> <span class="o">[</span> <span class="s2">&quot;</span><span class="si">${</span><span class="nv">dbm_version</span><span class="si">}</span><span class="s2">&quot;</span> !<span class="o">=</span> <span class="s2">&quot;</span><span class="si">${</span><span class="nv">_ext_version</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="k">return</span> 0
<span class="o">}</span>
</pre></div>
</div>
</div></div>
<div class="section" id="dbm-initenv-help">
<span id="dbm-initenv-help"></span><h3>_dbm_initenv_help<a class="headerlink" href="#dbm-initenv-help" title="Permalink to this headline">¶</a></h3>
<p>Print on stdout help message of command <code class="docutils literal"><span class="pre">initenv</span></code></p>
<p><em>Return</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">0</span></code>: always</li>
</ul>
<script type="text/javascript">
    function showhide(element){
        if (!document.getElementById)
            return
        if (element.style.display == "block")
            element.style.display = "none"
        else
            element.style.display = "block"
    };
</script>
<a href="javascript:showhide(document.getElementById('hiddencodeblock142'))">(Show/Hide)</a><br /><div id="hiddencodeblock142" style="display: none"><div class="highlight-bash"><div class="highlight"><pre><span></span>_dbm_initenv_help <span class="o">()</span> <span class="o">{</span>

  <span class="nb">echo</span> -en <span class="s2">&quot;[--to-current-dir]      Initialize current directory [.].\n&quot;</span>
  <span class="nb">echo</span> -en <span class="s2">&quot;[--to-dir target]       Initialize target directory.\n&quot;</span>
  <span class="nb">echo</span> -en <span class="s2">&quot;[--enable-profiles]     Enable profiles mode and create related directories.\n&quot;</span>
  <span class="nb">echo</span> -en <span class="s2">&quot;[--help|-h]             Show help message.\n&quot;</span>
  <span class="nb">echo</span> -en <span class="s2">&quot;\n&quot;</span>

  <span class="k">return</span> 0
<span class="o">}</span>
<span class="c1"># dbm_dbm_initenv_help_end</span>

<span class="c1"># dbm__dbm_check_initenv_args</span>
_dbm_check_initenv_args <span class="o">()</span> <span class="o">{</span>

  <span class="o">[[</span> <span class="nv">$DEBUG</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> -en <span class="s2">&quot;(_dbm_check_initenv_args: </span><span class="nv">$@</span><span class="s2">)\n&quot;</span>

  <span class="nb">local</span> <span class="nv">short_options</span><span class="o">=</span><span class="s2">&quot;h&quot;</span>
  <span class="nb">local</span> <span class="nv">long_options</span><span class="o">=</span><span class="s2">&quot;to-dir: help to-current-dir enable-profiles&quot;</span>

  <span class="k">$(</span><span class="nb">set</span> -- <span class="k">$(</span>getopt -u -q -a -o <span class="s2">&quot;</span><span class="nv">$short_options</span><span class="s2">&quot;</span> -l <span class="s2">&quot;</span><span class="nv">$long_options</span><span class="s2">&quot;</span> -- <span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span><span class="k">))</span> <span class="o">||</span> <span class="se">\</span>
    error_handled <span class="s2">&quot;Invalid parameters&quot;</span>

  <span class="o">[[</span> <span class="nv">$DEBUG</span> <span class="o">&amp;&amp;</span> <span class="nv">$DEBUG</span> <span class="o">==</span> <span class="nb">true</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> -en <span class="s2">&quot;(_dbm_check_initenv_args: Found </span><span class="nv">$#</span><span class="s2"> params)\n&quot;</span>

  <span class="k">if</span> <span class="o">[</span> <span class="nv">$#</span> -lt <span class="m">0</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    _dbm_initenv_help
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="nv">DBM_INIT_CURRDIR</span><span class="o">=</span>0
  <span class="nv">DBM_INIT_DIR</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
  <span class="nv">DBM_INIT_TARGETDIR</span><span class="o">=</span>0
  <span class="nv">DBM_INIT_PROFILES</span><span class="o">=</span>0

  <span class="k">while</span> <span class="o">[</span> <span class="nv">$#</span> -gt <span class="m">0</span> <span class="o">]</span> <span class="p">;</span> <span class="k">do</span>
    <span class="k">case</span> <span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span> in

      --to-current-dir<span class="o">)</span>
        <span class="nv">DBM_INIT_CURRDIR</span><span class="o">=</span>1
        <span class="p">;;</span>
      --to-dir<span class="o">)</span>
        <span class="nv">DBM_INIT_TARGETDIR</span><span class="o">=</span>1
        <span class="nv">DBM_INIT_DIR</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span>
        <span class="nb">shift</span>
        <span class="p">;;</span>
      --enable-profiles<span class="o">)</span>
        <span class="nv">DBM_INIT_PROFILES</span><span class="o">=</span>1
        <span class="p">;;</span>
      -h<span class="p">|</span>--help<span class="o">)</span>
        _dbm_initenv_help
        <span class="k">return</span> 1
        <span class="p">;;</span>
      *<span class="o">)</span>
        error_generate <span class="s2">&quot;Invalid parameter </span><span class="nv">$1</span><span class="s2">.&quot;</span>
        <span class="p">;;</span>
    <span class="k">esac</span>
    <span class="nb">shift</span>

  <span class="k">done</span>

  <span class="k">if</span> <span class="o">[[</span> <span class="nv">$DBM_INIT_CURRDIR</span> -eq <span class="m">1</span> <span class="o">&amp;&amp;</span> <span class="nv">$DBM_INIT_TARGETDIR</span> -eq <span class="m">1</span> <span class="o">]]</span> <span class="p">;</span> <span class="k">then</span>
    out_handler_print <span class="s2">&quot;Use only --to-dir or --to-current-dir option.&quot;</span>
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="k">if</span> <span class="o">[[</span> <span class="nv">$DBM_INIT_TARGETDIR</span> -eq <span class="m">1</span> <span class="o">]]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="k">if</span> <span class="o">[</span> ! -d <span class="nv">$DBM_INIT_DIR</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
      out_handler_print <span class="s2">&quot;Invalid directory </span><span class="nv">$DBM_INIT_DIR</span><span class="s2">.&quot;</span>
      <span class="k">return</span> 1
    <span class="k">fi</span>
  <span class="k">else</span>

    <span class="c1"># Set DBM_INIT_DIR to .</span>
    <span class="nv">DBM_INIT_DIR</span><span class="o">=</span>.
  <span class="k">fi</span>

  <span class="k">return</span> 0
<span class="o">}</span>
<span class="c1">#***</span>

_dbm_ins_rel_help <span class="o">()</span> <span class="o">{</span>

  <span class="nb">echo</span> -en <span class="s2">&quot;[-n name]               Release Name.\n&quot;</span>
  <span class="nb">echo</span> -en <span class="s2">&quot;[-d YYYY-MM-DD]         Release Date. (Use now if not available)\n&quot;</span>
  <span class="nb">echo</span> -en <span class="s2">&quot;[-v version]            Release Version\n&quot;</span>
  <span class="nb">echo</span> -en <span class="s2">&quot;[-a adapter]            Release Adapter (default is Oracle).\n&quot;</span>
  <span class="nb">echo</span> -en <span class="s2">&quot;[-o id_order]           Release Id Order (optional).\n&quot;</span>
  <span class="nb">echo</span> -en <span class="s2">&quot;[-b id_branch]          Release Id Branch (default master branch {1}).\n&quot;</span>
  <span class="nb">echo</span> -en <span class="s2">&quot;[-dir directory]        Release directory (default is [.]).\n&quot;</span>
  <span class="nb">echo</span> -en <span class="s2">&quot;\n&quot;</span>

  <span class="k">return</span> 0
<span class="o">}</span>

_dbm_check_ins_rel_args <span class="o">()</span> <span class="o">{</span>

  <span class="o">[[</span> <span class="nv">$DEBUG</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> -en <span class="s2">&quot;(_dbm_check_ins_rel_args args: </span><span class="nv">$@</span><span class="s2">)\n&quot;</span>

  <span class="nb">local</span> <span class="nv">short_options</span><span class="o">=</span><span class="s2">&quot;n:d:v:o:a:b:h&quot;</span>
  <span class="nb">local</span> <span class="nv">long_options</span><span class="o">=</span><span class="s2">&quot;dir:&quot;</span>

  <span class="k">$(</span><span class="nb">set</span> -- <span class="k">$(</span>getopt -u -q -a -o <span class="s2">&quot;</span><span class="nv">$short_options</span><span class="s2">&quot;</span> -l <span class="s2">&quot;</span><span class="nv">$long_options</span><span class="s2">&quot;</span> -- <span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span><span class="k">))</span> <span class="o">||</span> error_handled <span class="s2">&quot;Invalid parameters&quot;</span>

  <span class="k">if</span> <span class="o">[</span> <span class="nv">$#</span> -lt <span class="m">2</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    _dbm_ins_rel_help
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="o">[[</span> <span class="nv">$DEBUG</span> <span class="o">&amp;&amp;</span> <span class="nv">$DEBUG</span> <span class="o">==</span> <span class="nb">true</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> -en <span class="s2">&quot;(_dbm_check_ins_rel_args: Found </span><span class="nv">$#</span><span class="s2"> params)\n&quot;</span>

  <span class="k">while</span> <span class="o">[</span> <span class="nv">$#</span> -gt <span class="m">0</span> <span class="o">]</span> <span class="p">;</span> <span class="k">do</span>
    <span class="k">case</span> <span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span> in

      -n<span class="o">)</span> <span class="nv">DBM_REL_NAME</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span>    <span class="p">;</span>shift<span class="p">;;</span>
      -d<span class="o">)</span> <span class="nv">DBM_REL_DATE</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span>    <span class="p">;</span>shift<span class="p">;;</span>
      -v<span class="o">)</span> <span class="nv">DBM_REL_VERSION</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span> <span class="p">;</span>shift<span class="p">;;</span>
      -o<span class="o">)</span> <span class="nv">DBM_REL_ORDER</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span>   <span class="p">;</span>shift<span class="p">;;</span>
      -a<span class="o">)</span> <span class="nv">DBM_REL_ADAPTER</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span> <span class="p">;</span>shift<span class="p">;;</span>
      -b<span class="o">)</span> <span class="nv">DBM_REL_BRANCH</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span>  <span class="p">;</span>shift<span class="p">;;</span>
      --dir<span class="o">)</span>
        <span class="nv">DBM_REL_DIR</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span>
        <span class="nb">shift</span>
        <span class="p">;;</span>
      -h<span class="o">)</span>
        _dbm_ins_rel_help
        <span class="k">return</span> 1
        <span class="p">;;</span>
      --<span class="o">)</span> <span class="p">;;</span>
      *<span class="o">)</span>
        error_generate <span class="s2">&quot;Invalid parameter </span><span class="nv">$1</span><span class="s2">.&quot;</span>
        <span class="p">;;</span>
    <span class="k">esac</span>
    <span class="nb">shift</span>

  <span class="k">done</span>

  <span class="k">if</span> <span class="o">[</span> -z <span class="s2">&quot;</span><span class="nv">$DBM_REL_NAME</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;Missing Release Name&quot;</span>
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="k">if</span> <span class="o">[</span> -z <span class="s2">&quot;</span><span class="nv">$DBM_REL_DATE</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="nv">DBM_REL_DATE</span><span class="o">=</span><span class="s2">&quot;DATETIME(&#39;now&#39;)&quot;</span>
  <span class="k">else</span>
    <span class="nv">DBM_REL_DATE</span><span class="o">=</span><span class="s2">&quot;&#39;</span><span class="nv">$DBM_REL_DATE</span><span class="s2">&#39;&quot;</span>
  <span class="k">fi</span>

  <span class="k">if</span> <span class="o">[</span> -z <span class="s2">&quot;</span><span class="nv">$DBM_REL_ADAPTER</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="nv">DBM_REL_ADAPTER</span><span class="o">=</span><span class="s2">&quot;oracle&quot;</span><span class="p">;</span>
  <span class="k">fi</span>

  <span class="k">if</span> <span class="o">[</span> -z <span class="s2">&quot;</span><span class="nv">$DBM_REL_DIR</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="nv">DBM_REL_DIR</span><span class="o">=</span><span class="s2">&quot;.&quot;</span>
  <span class="k">fi</span>

  <span class="k">if</span> <span class="o">[</span> -z <span class="s2">&quot;</span><span class="nv">$DBM_REL_VERSION</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;Missing Release Verion&quot;</span>
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="k">return</span> 0
<span class="o">}</span>

<span class="c1">#****f* dbm/_dbm_add_prof_help</span>
<span class="c1"># FUNCTION</span>
<span class="c1">#   Print help message of add_profile command.</span>
<span class="c1"># SOURCE</span>
_dbm_add_prof_help <span class="o">()</span> <span class="o">{</span>

  <span class="nb">echo</span> -en <span class="s2">&quot;[--name name]          Profile name to insert.\n&quot;</span>
  <span class="nb">echo</span> -en <span class="s2">&quot;[--file file]          Filename of the profile. Example: prof1.conf.\n&quot;</span>
  <span class="nb">echo</span> -en <span class="s2">&quot;[--default]            Set new profile as default.\n&quot;</span>
  <span class="nb">echo</span> -en <span class="s2">&quot;[-h]                   Show this help message.\n&quot;</span>

  <span class="k">return</span> 0
<span class="o">}</span>
<span class="c1">#***</span>

<span class="c1">#****f* dbm/_dbm_prof_help</span>
<span class="c1"># FUNCTION</span>
<span class="c1">#   Print help message of del_profile/set_profile command.</span>
<span class="c1"># SOURCE</span>
_dbm_prof_help <span class="o">()</span> <span class="o">{</span>

  <span class="nb">echo</span> -en <span class="s2">&quot;[--name profile_name]  Name of the profile.\n&quot;</span>
  <span class="nb">echo</span> -en <span class="s2">&quot;[--id id_profile]      Id of the profile.\n&quot;</span>
  <span class="nb">echo</span> -en <span class="s2">&quot;[-h]                   Show this help message.\n&quot;</span>

  <span class="k">return</span> 0
<span class="o">}</span>
<span class="c1">#***</span>


<span class="c1">#****f* dbm/_dbm_check_prof_args</span>
<span class="c1"># FUNCTION</span>
<span class="c1">#   Internal function for parse command line arguments related to</span>
<span class="c1">#   del_profile/set_profile command.</span>
<span class="c1"># DESCRIPTION</span>
<span class="c1">#   * --name profile_name  Name of the profile.</span>
<span class="c1">#   * --id id_profile      Id of the profile.</span>
<span class="c1">#   * -h                   Show help message.</span>
<span class="c1"># SOURCE</span>
_dbm_check_prof_args <span class="o">()</span> <span class="o">{</span>

  <span class="o">[[</span> <span class="nv">$DEBUG</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> -en <span class="s2">&quot;(_dbm_check_del_prof_args args: </span><span class="nv">$@</span><span class="s2">)\n&quot;</span>

  <span class="nb">local</span> <span class="nv">short_options</span><span class="o">=</span><span class="s2">&quot;h&quot;</span>
  <span class="nb">local</span> <span class="nv">long_options</span><span class="o">=</span><span class="s2">&quot;id: name:&quot;</span>

  <span class="k">$(</span><span class="nb">set</span> -- <span class="k">$(</span>getopt -u -q -a -o <span class="s2">&quot;</span><span class="nv">$short_options</span><span class="s2">&quot;</span> -l <span class="s2">&quot;</span><span class="nv">$long_options</span><span class="s2">&quot;</span> -- <span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span><span class="k">))</span> <span class="o">||</span> error_handled <span class="s2">&quot;Invalid parameters&quot;</span>

  <span class="k">if</span> <span class="o">[</span> <span class="nv">$#</span> -lt <span class="m">2</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    _dbm_prof_help
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="o">[[</span> <span class="nv">$DEBUG</span> <span class="o">&amp;&amp;</span> <span class="nv">$DEBUG</span> <span class="o">==</span> <span class="nb">true</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> -en <span class="s2">&quot;(_dbm_check_del_prof_args: Found </span><span class="nv">$#</span><span class="s2"> params)\n&quot;</span>

  <span class="nv">DBM_PROFILE_BYNAME</span><span class="o">=</span>0
  <span class="nv">DBM_PROFILE_BYID</span><span class="o">=</span>0

  <span class="k">while</span> <span class="o">[</span> <span class="nv">$#</span> -gt <span class="m">0</span> <span class="o">]</span> <span class="p">;</span> <span class="k">do</span>
    <span class="k">case</span> <span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span> in

      --name<span class="o">)</span>
        <span class="nv">DBM_PROFILE_NAME</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span>
        <span class="nv">DBM_PROFILE_BYNAME</span><span class="o">=</span>1
        <span class="nb">shift</span>
        <span class="p">;;</span>
      --id<span class="o">)</span>
        <span class="nv">DBM_PROFILE_ID</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span>
        <span class="nv">DBM_PROFILE_BYID</span><span class="o">=</span>1
        <span class="nb">shift</span>
        <span class="p">;;</span>
      -h<span class="o">)</span>
        _dbm_prof_help
        <span class="k">return</span> 1
        <span class="p">;;</span>
      --<span class="o">)</span> <span class="p">;;</span>
      *<span class="o">)</span>
        error_generate <span class="s2">&quot;Invalid parameter </span><span class="nv">$1</span><span class="s2">.&quot;</span>
        <span class="p">;;</span>
    <span class="k">esac</span>
    <span class="nb">shift</span>

  <span class="k">done</span>

  <span class="k">if</span> <span class="o">[[</span> <span class="nv">$DBM_PROFILE_BYID</span> -eq <span class="m">0</span> <span class="o">&amp;&amp;</span> <span class="nv">$DBM_PROFILE_BYNAME</span> -eq <span class="m">0</span> <span class="o">]]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;A profile name or profile id is needed.&quot;</span>
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="k">if</span> <span class="o">[[</span> <span class="nv">$DBM_PROFILE_BYID</span> -eq <span class="m">1</span> <span class="o">&amp;&amp;</span> <span class="nv">$DBM_PROFILE_BYNAME</span> -eq <span class="m">1</span> <span class="o">]]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;Set only profile id or only profile name.&quot;</span>
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="k">return</span> 0
<span class="o">}</span>
<span class="c1">#***</span>

<span class="c1">#****f* dbm/_dbm_check_add_prof_args</span>
<span class="c1"># FUNCTION</span>
<span class="c1">#   Internal function for parse command line arguments related to add_profile command.</span>
<span class="c1"># DESCRIPTION</span>
<span class="c1">#   * --default            Set profile as default.</span>
<span class="c1">#   * --name               Set profile name.</span>
<span class="c1">#   * --file               Set profile filename.</span>
<span class="c1">#   * -h                   Show help message.</span>
<span class="c1"># SOURCE</span>
_dbm_check_add_prof_args <span class="o">()</span> <span class="o">{</span>

  <span class="o">[[</span> <span class="nv">$DEBUG</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> -en <span class="s2">&quot;(_dbm_check_add_prof_args args: </span><span class="nv">$@</span><span class="s2">)\n&quot;</span>

  <span class="nb">local</span> <span class="nv">short_options</span><span class="o">=</span><span class="s2">&quot;h&quot;</span>
  <span class="nb">local</span> <span class="nv">long_options</span><span class="o">=</span><span class="s2">&quot;default name: file:&quot;</span>

  <span class="k">$(</span><span class="nb">set</span> -- <span class="k">$(</span>getopt -u -q -a -o <span class="s2">&quot;</span><span class="nv">$short_options</span><span class="s2">&quot;</span> -l <span class="s2">&quot;</span><span class="nv">$long_options</span><span class="s2">&quot;</span> -- <span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span><span class="k">))</span> <span class="o">||</span> error_handled <span class="s2">&quot;Invalid parameters&quot;</span>

  <span class="k">if</span> <span class="o">[</span> <span class="nv">$#</span> -lt <span class="m">2</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    _dbm_add_prof_help
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="o">[[</span> <span class="nv">$DEBUG</span> <span class="o">&amp;&amp;</span> <span class="nv">$DEBUG</span> <span class="o">==</span> <span class="nb">true</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> -en <span class="s2">&quot;(_dbm_check_add_prof_args: Found </span><span class="nv">$#</span><span class="s2"> params)\n&quot;</span>

  <span class="nv">DBM_PROFILE_DEFAULT</span><span class="o">=</span>0

  <span class="k">while</span> <span class="o">[</span> <span class="nv">$#</span> -gt <span class="m">0</span> <span class="o">]</span> <span class="p">;</span> <span class="k">do</span>
    <span class="k">case</span> <span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span> in

      --name<span class="o">)</span> <span class="nv">DBM_PROFILE_NAME</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span>
        <span class="nb">shift</span>
        <span class="p">;;</span>
      --file<span class="o">)</span>
        <span class="nv">DBM_PROFILE_FILENAME</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span>
        <span class="nb">shift</span>
        <span class="p">;;</span>
      --default<span class="o">)</span>
        <span class="nv">DBM_PROFILE_DEFAULT</span><span class="o">=</span>1
        <span class="p">;;</span>
      -h<span class="o">)</span>
        _dbm_add_prof_help
        <span class="k">return</span> 1
        <span class="p">;;</span>
      --<span class="o">)</span> <span class="p">;;</span>
      *<span class="o">)</span>
        error_generate <span class="s2">&quot;Invalid parameter </span><span class="nv">$1</span><span class="s2">.&quot;</span>
        <span class="p">;;</span>
    <span class="k">esac</span>
    <span class="nb">shift</span>

  <span class="k">done</span>

  <span class="k">if</span> <span class="o">[</span> -z <span class="s2">&quot;</span><span class="nv">$DBM_PROFILE_NAME</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;Missing Profile Name&quot;</span>
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="k">if</span> <span class="o">[</span> -z <span class="s2">&quot;</span><span class="nv">$DBM_PROFILE_FILENAME</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;Missing Profile filename.&quot;</span>
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="k">return</span> 0
<span class="o">}</span>
<span class="c1">#***</span>


<span class="c1"># Args for insert branch command</span>
_dbm_check_ins_bra_args <span class="o">()</span> <span class="o">{</span>

  <span class="o">[[</span> <span class="nv">$DEBUG</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> -en <span class="s2">&quot;(_dbm_check_ins_bra_args args: </span><span class="nv">$@</span><span class="s2">)\n&quot;</span>

  <span class="c1"># Reinitialize opt index position</span>
  <span class="nv">OPTIND</span><span class="o">=</span>1
  <span class="k">while</span> <span class="nb">getopts</span> <span class="s2">&quot;n:d:v:o:a:b:h&quot;</span> opts <span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span> <span class="p">;</span> <span class="k">do</span>
    <span class="k">case</span> <span class="nv">$opts</span> in

      n<span class="o">)</span> <span class="nv">DBM_BRA_NAME</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$OPTARG</span><span class="s2">&quot;</span><span class="p">;;</span>
      d<span class="o">)</span> <span class="nv">DBM_BRA_DATE</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$OPTARG</span><span class="s2">&quot;</span><span class="p">;;</span>
      h<span class="o">)</span>
        <span class="nb">echo</span> -en <span class="s2">&quot;[-n name]               Branch Name.\n&quot;</span>
        <span class="nb">echo</span> -en <span class="s2">&quot;[-d YYYY-MM-DD]         Branch Date. (Use now if not available)\n&quot;</span>
        <span class="k">return</span> 1
        <span class="p">;;</span>

    <span class="k">esac</span>
  <span class="k">done</span>

  <span class="k">if</span> <span class="o">[</span> -z <span class="s2">&quot;</span><span class="nv">$DBM_BRA_NAME</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> -en <span class="s2">&quot;[-n name]               Branch Name.\n&quot;</span>
    <span class="nb">echo</span> -en <span class="s2">&quot;[-d YYYY-MM-DD]         Branch Date. (Use now if not available)\n&quot;</span>
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="k">if</span> <span class="o">[</span> -z <span class="s2">&quot;</span><span class="nv">$DBM_BRA_DATE</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="nv">DBM_BRA_DATE</span><span class="o">=</span><span class="s2">&quot;DATETIME(&#39;now&#39;)&quot;</span>
  <span class="k">else</span>
    <span class="nv">DBM_BRA_DATE</span><span class="o">=</span><span class="s2">&quot;&#39;</span><span class="nv">$DBM_REL_DATE</span><span class="s2">&#39;&quot;</span>
  <span class="k">fi</span>

  <span class="k">return</span> 0
<span class="o">}</span>

_dbm_ins_script_type_help <span class="o">()</span> <span class="o">{</span>

  <span class="nb">echo</span> -en <span class="s2">&quot;[-c code]               Script Type Code.\n&quot;</span>
  <span class="nb">echo</span> -en <span class="s2">&quot;[-d description]        Script Type Description\n&quot;</span>

  <span class="k">return</span> 0
<span class="o">}</span>

_dbm_check_ins_script_type_args <span class="o">()</span> <span class="o">{</span>

  <span class="o">[[</span> <span class="nv">$DEBUG</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> -en <span class="s2">&quot;(_dbm_check_ins_script_type_args args: </span><span class="nv">$@</span><span class="s2">)\n&quot;</span>

  <span class="c1"># Reinitialize opt index position</span>
  <span class="nv">OPTIND</span><span class="o">=</span>1
  <span class="k">while</span> <span class="nb">getopts</span> <span class="s2">&quot;c:d:h&quot;</span> opts <span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span> <span class="p">;</span> <span class="k">do</span>
    <span class="k">case</span> <span class="nv">$opts</span> in

      c<span class="o">)</span> <span class="nv">DBM_SCRIPT_TYPE_CODE</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$OPTARG</span><span class="s2">&quot;</span><span class="p">;;</span>
      d<span class="o">)</span> <span class="nv">DBM_SCRIPT_TYPE_DESCR</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$OPTARG</span><span class="s2">&quot;</span><span class="p">;;</span>
      h<span class="o">)</span>
        _dbm_ins_script_type_help
        <span class="k">return</span> 1
        <span class="p">;;</span>

    <span class="k">esac</span>
  <span class="k">done</span>

  <span class="k">if</span> <span class="o">[[</span> -z <span class="s2">&quot;</span><span class="nv">$DBM_SCRIPT_TYPE_CODE</span><span class="s2">&quot;</span> <span class="o">&amp;&amp;</span> -z <span class="s2">&quot;</span><span class="nv">$DBM_SCRIPT_TYPE_DESCR</span><span class="s2">&quot;</span> <span class="o">]]</span> <span class="p">;</span> <span class="k">then</span>
    _dbm_ins_script_type_help
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="k">if</span> <span class="o">[</span> -z <span class="s2">&quot;</span><span class="nv">$DBM_SCRIPT_TYPE_CODE</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;Missing Script Type Code.&quot;</span>
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="k">if</span> <span class="o">[</span> -z <span class="s2">&quot;</span><span class="nv">$DBM_SCRIPT_TYPE_DESCR</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;Missing Script Type Descr&quot;</span>
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="k">return</span> 0
<span class="o">}</span>

_dbm_ins_script_help <span class="o">()</span> <span class="o">{</span>

  <span class="nb">echo</span> -en <span class="s2">&quot;[-f filename]           Script filename.\n&quot;</span>
  <span class="nb">echo</span> -en <span class="s2">&quot;[-n name]               Release Name.\n&quot;</span>
  <span class="nb">echo</span> -en <span class="s2">&quot;[-v version]            Release Version\n&quot;</span>
  <span class="nb">echo</span> -en <span class="s2">&quot;[-t script_type]        Script Type.\n&quot;</span>
  <span class="nb">echo</span> -en <span class="s2">&quot;[-a 0|1]                Set active flag. Default is 1 (active)\n&quot;</span>
  <span class="nb">echo</span> -en <span class="s2">&quot;[-d directory]          Directory of the script.\n&quot;</span>
  <span class="nb">echo</span> -en <span class="s2">&quot;[-o id_order]           Script Id Order (optional). Default is used MAX(id) of the same id_release.\n&quot;</span>
  <span class="nb">echo</span> -en <span class="s2">&quot;[-r id_release]         Id_release of the script. Use this instead of release name and version.\n&quot;</span>
  <span class="nb">echo</span> -en <span class="s2">&quot;[-h]                    Show this message.\n&quot;</span>

  <span class="k">return</span> 0
<span class="o">}</span>

_dbm_check_ins_script_args <span class="o">()</span> <span class="o">{</span>

  <span class="o">[[</span> <span class="nv">$DEBUG</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> -en <span class="s2">&quot;(_dbm_check_ins_script_args args: </span><span class="nv">$@</span><span class="s2">)\n&quot;</span>

  <span class="nb">local</span> <span class="nv">short_options</span><span class="o">=</span><span class="s2">&quot;f:t:a:d:hr:n:v:o:&quot;</span>

  <span class="k">$(</span><span class="nb">set</span> -- <span class="k">$(</span>getopt -u -q -a -o <span class="s2">&quot;</span><span class="nv">$short_options</span><span class="s2">&quot;</span> -- <span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span><span class="k">))</span> <span class="o">||</span> error_handled <span class="s2">&quot;Invalid parameters&quot;</span>

  <span class="k">if</span> <span class="o">[</span> <span class="nv">$#</span> -lt <span class="m">2</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    _dbm_ins_script_help
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="o">[[</span> <span class="nv">$DEBUG</span> <span class="o">&amp;&amp;</span> <span class="nv">$DEBUG</span> <span class="o">==</span> <span class="nb">true</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> -en <span class="s2">&quot;(_dbm_check_ins_script_args: Found </span><span class="nv">$#</span><span class="s2"> params)\n&quot;</span>

  <span class="k">while</span> <span class="o">[</span> <span class="nv">$#</span> -gt <span class="m">0</span> <span class="o">]</span> <span class="p">;</span> <span class="k">do</span>
    <span class="k">case</span> <span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span> in

      -f<span class="o">)</span> <span class="nv">DBM_SCRIPT_FILENAME</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span><span class="p">;</span>shift<span class="p">;;</span>
      -t<span class="o">)</span> <span class="nv">DBM_SCRIPT_TYPE</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span><span class="p">;</span>shift<span class="p">;;</span>
      -a<span class="o">)</span> <span class="nv">DBM_SCRIPT_ACTIVE</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span><span class="p">;</span>shift<span class="p">;;</span>
      -d<span class="o">)</span> <span class="nv">DBM_SCRIPT_DIRECTORY</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span><span class="p">;</span>shift<span class="p">;;</span>
      -r<span class="o">)</span> <span class="nv">DBM_SCRIPT_ID_RELEASE</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span><span class="p">;</span>shift<span class="p">;;</span>
      -n<span class="o">)</span> <span class="nv">DBM_SCRIPT_REL_NAME</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span><span class="p">;</span>shift<span class="p">;;</span>
      -v<span class="o">)</span> <span class="nv">DBM_SCRIPT_REL_VERSION</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span><span class="p">;</span>shift<span class="p">;;</span>
      -o<span class="o">)</span> <span class="nv">DBM_SCRIPT_ID_ORDER</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span><span class="p">;</span>shift<span class="p">;;</span>
      -h<span class="o">)</span>
        _dbm_ins_script_help
        <span class="k">return</span> 1
        <span class="p">;;</span>
      --<span class="o">)</span> <span class="p">;;</span>
      *<span class="o">)</span>
        error_generate <span class="s2">&quot;Invalid parameter </span><span class="nv">$1</span><span class="s2">.&quot;</span>
        <span class="p">;;</span>
    <span class="k">esac</span>
    <span class="nb">shift</span>

  <span class="k">done</span>

  <span class="k">if</span> <span class="o">[</span> -z <span class="s2">&quot;</span><span class="nv">$DBM_SCRIPT_FILENAME</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;Missing Script Filename&quot;</span>
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="k">if</span> <span class="o">[</span> -z <span class="s2">&quot;</span><span class="nv">$DBM_SCRIPT_TYPE</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;Missing Script Type&quot;</span>
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="k">if</span> <span class="o">[</span> -z <span class="s2">&quot;</span><span class="nv">$DBM_SCRIPT_ID_RELEASE</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="k">if</span> <span class="o">[[</span> -z <span class="s2">&quot;</span><span class="nv">$DBM_SCRIPT_REL_VERSION</span><span class="s2">&quot;</span> <span class="o">||</span> -z <span class="s2">&quot;</span><span class="nv">$DBM_SCRIPT_REL_NAME</span><span class="s2">&quot;</span> <span class="o">]]</span> <span class="p">;</span> <span class="k">then</span>
      <span class="nb">echo</span> <span class="s2">&quot;Missing Release Version or Release Name or Id Release.&quot;</span>
      <span class="k">return</span> 1
    <span class="k">fi</span>
  <span class="k">fi</span>

  <span class="k">if</span> <span class="o">[</span> -z <span class="s2">&quot;</span><span class="nv">$DBM_SCRIPT_DIRECTORY</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;Missing Script Directory.&quot;</span>
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="k">if</span> <span class="o">[</span> -z <span class="s2">&quot;</span><span class="nv">$DBM_SCRIPT_ACTIVE</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="nv">DBM_SCRIPT_ACTIVE</span><span class="o">=</span><span class="s2">&quot;1&quot;</span>
  <span class="k">else</span>
    <span class="k">if</span> <span class="o">[[</span> x<span class="s2">&quot;</span><span class="nv">$DBM_SCRIPT_ACTIVE</span><span class="s2">&quot;</span> !<span class="o">=</span> x<span class="s2">&quot;1&quot;</span> <span class="o">&amp;&amp;</span> x<span class="s2">&quot;</span><span class="nv">$DBM_SCRIPT_ACTIVE</span><span class="s2">&quot;</span> !<span class="o">=</span> x<span class="s2">&quot;0&quot;</span> <span class="o">]]</span> <span class="p">;</span> <span class="k">then</span>
      <span class="nv">DBM_SCRIPT_ACTIVE</span><span class="o">=</span><span class="s2">&quot;1&quot;</span>
    <span class="k">fi</span>
  <span class="k">fi</span>

  <span class="k">return</span> 0
<span class="o">}</span>


_dbm_check_rel_dep_args <span class="o">()</span> <span class="o">{</span>

  <span class="o">[[</span> <span class="nv">$DEBUG</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> -en <span class="s2">&quot;(_dbm_check_ins_rel_dep_args args: </span><span class="nv">$@</span><span class="s2">)\n&quot;</span>

  <span class="c1"># Reinitialize opt index position</span>
  <span class="nv">OPTIND</span><span class="o">=</span>1
  <span class="k">while</span> <span class="nb">getopts</span> <span class="s2">&quot;n:t:f:h&quot;</span> opts <span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span> <span class="p">;</span> <span class="k">do</span>
    <span class="k">case</span> <span class="nv">$opts</span> in

      n<span class="o">)</span> <span class="nv">DBM_REL_NAME</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$OPTARG</span><span class="s2">&quot;</span><span class="p">;;</span>
      t<span class="o">)</span> <span class="nv">DBM_REL_VERSION_TO</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$OPTARG</span><span class="s2">&quot;</span><span class="p">;;</span>
      f<span class="o">)</span> <span class="nv">DBM_REL_VERSION_FROM</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$OPTARG</span><span class="s2">&quot;</span><span class="p">;;</span>
      h<span class="o">)</span>
        <span class="nb">echo</span> -en <span class="s2">&quot;[-n name]               Release Name.\n&quot;</span>
        <span class="nb">echo</span> -en <span class="s2">&quot;[-t version_to]         Release version that has a dependency.\n&quot;</span>
        <span class="nb">echo</span> -en <span class="s2">&quot;[-f version_from]       Release version needed.\n&quot;</span>
        <span class="k">return</span> 1
        <span class="p">;;</span>

    <span class="k">esac</span>
  <span class="k">done</span>

  <span class="k">if</span> <span class="o">[</span> -z <span class="s2">&quot;</span><span class="nv">$DBM_REL_NAME</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;Missing Release Name.&quot;</span>
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="k">if</span> <span class="o">[</span> -z <span class="s2">&quot;</span><span class="nv">$DBM_REL_VERSION_TO</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;Missing Release version that has a dependency.&quot;</span>
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="k">if</span> <span class="o">[</span> -z <span class="s2">&quot;</span><span class="nv">$DBM_REL_VERSION_FROM</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;Missing Release version needed on target.&quot;</span>
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="k">if</span> <span class="o">[</span> <span class="s2">&quot;</span><span class="nv">$DBM_REL_VERSION_FROM</span><span class="s2">&quot;</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="nv">$DBM_REL_VERSION_TO</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;Both version are equal. Error.&quot;</span>
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="k">return</span> 0
<span class="o">}</span>

_dbm_check_upd_script_args <span class="o">()</span> <span class="o">{</span>

  <span class="o">[[</span> <span class="nv">$DEBUG</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> -en <span class="s2">&quot;(_dbm_check_upd_script_args args: </span><span class="nv">$@</span><span class="s2">)\n&quot;</span>

  <span class="c1"># Reinitialize opt index position</span>
  <span class="nv">OPTIND</span><span class="o">=</span>1
  <span class="k">while</span> <span class="nb">getopts</span> <span class="s2">&quot;i:f:t:a:d:hr:n:v:o:&quot;</span> opts <span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span> <span class="p">;</span> <span class="k">do</span>
    <span class="k">case</span> <span class="nv">$opts</span> in

      i<span class="o">)</span> <span class="nv">DBM_SCRIPT_ID</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$OPTARG</span><span class="s2">&quot;</span><span class="p">;;</span>
      f<span class="o">)</span> <span class="nv">DBM_SCRIPT_FILENAME</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$OPTARG</span><span class="s2">&quot;</span><span class="p">;;</span>
      t<span class="o">)</span> <span class="nv">DBM_SCRIPT_TYPE</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$OPTARG</span><span class="s2">&quot;</span><span class="p">;;</span>
      a<span class="o">)</span> <span class="nv">DBM_SCRIPT_ACTIVE</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$OPTARG</span><span class="s2">&quot;</span><span class="p">;;</span>
      d<span class="o">)</span> <span class="nv">DBM_SCRIPT_DIRECTORY</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$OPTARG</span><span class="s2">&quot;</span><span class="p">;;</span>
      r<span class="o">)</span> <span class="nv">DBM_SCRIPT_ID_RELEASE</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$OPTARG</span><span class="s2">&quot;</span><span class="p">;;</span>
      n<span class="o">)</span> <span class="nv">DBM_SCRIPT_REL_NAME</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$OPTARG</span><span class="s2">&quot;</span><span class="p">;;</span>
      v<span class="o">)</span> <span class="nv">DBM_SCRIPT_REL_VERSION</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$OPTARG</span><span class="s2">&quot;</span><span class="p">;;</span>
      o<span class="o">)</span> <span class="nv">DBM_SCRIPT_ID_ORDER</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$OPTARG</span><span class="s2">&quot;</span><span class="p">;;</span>
      h<span class="o">)</span>
        <span class="nb">echo</span> -en <span class="s2">&quot;[-i id_script]          Id Script.\n&quot;</span>
        <span class="nb">echo</span> -en <span class="s2">&quot;[-f filename]           Script filename.\n&quot;</span>
        <span class="nb">echo</span> -en <span class="s2">&quot;[-n name]               Release Name.\n&quot;</span>
        <span class="nb">echo</span> -en <span class="s2">&quot;[-v version]            Release Version\n&quot;</span>
        <span class="nb">echo</span> -en <span class="s2">&quot;[-t script_type]        Script Type.\n&quot;</span>
        <span class="nb">echo</span> -en <span class="s2">&quot;[-a 0|1]                Set active flag.\n&quot;</span>
        <span class="nb">echo</span> -en <span class="s2">&quot;[-d directory]          Directory of the script.\n&quot;</span>
        <span class="nb">echo</span> -en <span class="s2">&quot;[-o id_order]           Script Id Order (optional). Default is used MAX(id) of the same id_release.\n&quot;</span>
        <span class="nb">echo</span> -en <span class="s2">&quot;[-r id_release]         Id_release of the script. Use this instead of release name and version.\n&quot;</span>
        <span class="k">return</span> 1
        <span class="p">;;</span>

    <span class="k">esac</span>
  <span class="k">done</span>

  <span class="k">if</span> <span class="o">[</span> -z <span class="s2">&quot;</span><span class="nv">$DBM_SCRIPT_ID</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;Missing Script Id.&quot;</span>
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="k">if</span> <span class="o">[</span> ! -z <span class="s2">&quot;</span><span class="nv">$DBM_SCRIPT_ACTIVE</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="k">if</span> <span class="o">[[</span> x<span class="s2">&quot;</span><span class="nv">$DBM_SCRIPT_ACTIVE</span><span class="s2">&quot;</span> !<span class="o">=</span> x<span class="s2">&quot;1&quot;</span> <span class="o">&amp;&amp;</span> x<span class="s2">&quot;</span><span class="nv">$DBM_SCRIPT_ACTIVE</span><span class="s2">&quot;</span> !<span class="o">=</span> x<span class="s2">&quot;0&quot;</span> <span class="o">]]</span> <span class="p">;</span> <span class="k">then</span>
      <span class="nv">DBM_SCRIPT_ACTIVE</span><span class="o">=</span><span class="s2">&quot;1&quot;</span>
    <span class="k">fi</span>
  <span class="k">fi</span>

  <span class="k">return</span> 0
<span class="o">}</span>

_dbm_rm_script_help <span class="o">()</span> <span class="o">{</span>

  <span class="nb">echo</span> -en <span class="s2">&quot;[-i id_script]          Id Script of the script to remove.\n&quot;</span>

  <span class="k">return</span> 0
<span class="o">}</span>


_dbm_check_rm_script_args <span class="o">()</span> <span class="o">{</span>

  <span class="o">[[</span> <span class="nv">$DEBUG</span> <span class="o">&amp;&amp;</span> <span class="nv">$DEBUG</span> <span class="o">==</span> <span class="nb">true</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> -en <span class="s2">&quot;(_dbm_check_rm_script_args args: </span><span class="nv">$@</span><span class="s2">)\n&quot;</span>

  <span class="nb">local</span> <span class="nv">short_options</span><span class="o">=</span><span class="s2">&quot;i:h&quot;</span>

  <span class="k">$(</span><span class="nb">set</span> -- <span class="k">$(</span>getopt -u -q -a -o <span class="s2">&quot;</span><span class="nv">$short_options</span><span class="s2">&quot;</span> -- <span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span><span class="k">))</span> <span class="o">||</span> error_handled <span class="s2">&quot;Invalid parameters&quot;</span>

  <span class="k">if</span> <span class="o">[</span> <span class="nv">$#</span> -lt <span class="m">2</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    _dbm_rm_script_help
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="o">[[</span> <span class="nv">$DEBUG</span> <span class="o">&amp;&amp;</span> <span class="nv">$DEBUG</span> <span class="o">==</span> <span class="nb">true</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> -en <span class="s2">&quot;(_dbm_check_rm_script_args: Found </span><span class="nv">$#</span><span class="s2"> params)\n&quot;</span>

  <span class="k">while</span> <span class="o">[</span> <span class="nv">$#</span> -gt <span class="m">0</span> <span class="o">]</span> <span class="p">;</span> <span class="k">do</span>
    <span class="k">case</span> <span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span> in

      -i<span class="o">)</span> <span class="nv">DBM_SCRIPT_ID</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span><span class="p">;</span>shift<span class="p">;;</span>
      -h<span class="o">)</span>
        _dbm_rm_script_help
        <span class="k">return</span> 1
        <span class="p">;;</span>
      --<span class="o">)</span> <span class="p">;;</span>
      *<span class="o">)</span>
        error_generate <span class="s2">&quot;Invalid parameter </span><span class="nv">$1</span><span class="s2">.&quot;</span>
        <span class="p">;;</span>
    <span class="k">esac</span>
    <span class="nb">shift</span>

  <span class="k">done</span>

  <span class="k">if</span> <span class="o">[</span> -z <span class="s2">&quot;</span><span class="nv">$DBM_SCRIPT_ID</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;Missing Script Id.&quot;</span>
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="k">return</span> 0
<span class="o">}</span>

_dbm_upd_release_help <span class="o">()</span> <span class="o">{</span>

  <span class="nb">echo</span> -en <span class="s2">&quot;[-n name]               Release Name.\n&quot;</span>
  <span class="nb">echo</span> -en <span class="s2">&quot;[-d YYYY-MM-DD]         Release Date.\n&quot;</span>
  <span class="nb">echo</span> -en <span class="s2">&quot;[-v version]            Release Version\n&quot;</span>
  <span class="nb">echo</span> -en <span class="s2">&quot;[-a adapter]            Release Adapter.\n&quot;</span>
  <span class="nb">echo</span> -en <span class="s2">&quot;[-b id_branch]          Id Branch.\n&quot;</span>
  <span class="nb">echo</span> -en <span class="s2">&quot;[-i id_release]         Id Release to update.\n&quot;</span>
  <span class="nb">echo</span> -en <span class="s2">&quot;[--dir directory]       Directory to update.\n&quot;</span>
  <span class="nb">echo</span> -en <span class="s2">&quot;\n&quot;</span>

  <span class="k">return</span> 0
<span class="o">}</span>

_dbm_check_upd_release_args <span class="o">()</span> <span class="o">{</span>

  <span class="o">[[</span> <span class="nv">$DEBUG</span> <span class="o">&amp;&amp;</span> <span class="nv">$DEBUG</span> <span class="o">==</span> <span class="nb">true</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> -en <span class="s2">&quot;(_dbm_check_upd_release_args: </span><span class="nv">$@</span><span class="s2">)\n&quot;</span>

  <span class="nv">DBM_REL_NAME_UPD</span><span class="o">=</span>0
  <span class="nv">DBM_REL_DATE_UPD</span><span class="o">=</span>0
  <span class="nv">DBM_REL_VERSION_UPD</span><span class="o">=</span>0
  <span class="nv">DBM_REL_ADAPTER_UPD</span><span class="o">=</span>0
  <span class="nv">DBM_REL_BRANCH_UPD</span><span class="o">=</span>0
  <span class="nv">DBM_REL_DIR_UPD</span><span class="o">=</span>0

  <span class="nb">local</span> <span class="nv">short_options</span><span class="o">=</span><span class="s2">&quot;b:n:d:a:v:i:h&quot;</span>
  <span class="nb">local</span> <span class="nv">long_options</span><span class="o">=</span><span class="s2">&quot;dir:&quot;</span>

  <span class="k">$(</span><span class="nb">set</span> -- <span class="k">$(</span>getopt -u -q -a -o <span class="s2">&quot;</span><span class="nv">$short_options</span><span class="s2">&quot;</span> -l <span class="s2">&quot;</span><span class="nv">$long_options</span><span class="s2">&quot;</span> -- <span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span><span class="k">))</span> <span class="o">||</span> error_handled <span class="s2">&quot;Invalid parameters&quot;</span>

  <span class="k">if</span> <span class="o">[</span> <span class="nv">$#</span> -lt <span class="m">2</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    _dbm_upd_release_help
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="o">[[</span> <span class="nv">$DEBUG</span> <span class="o">&amp;&amp;</span> <span class="nv">$DEBUG</span> <span class="o">==</span> <span class="nb">true</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> -en <span class="s2">&quot;(_dbm_check_upd_release_args: Found </span><span class="nv">$#</span><span class="s2"> params)\n&quot;</span>

  <span class="k">while</span> <span class="o">[</span> <span class="nv">$#</span> -gt <span class="m">0</span> <span class="o">]</span> <span class="p">;</span> <span class="k">do</span>
    <span class="k">case</span> <span class="nv">$1</span> in

      -n<span class="o">)</span>
        <span class="nv">DBM_REL_NAME</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span>
        <span class="nv">DBM_REL_NAME_UPD</span><span class="o">=</span>1
        <span class="nb">shift</span>
        <span class="p">;;</span>
      -d<span class="o">)</span>
        <span class="nv">DBM_REL_DATE</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span>
        <span class="nv">DBM_REL_DATE_UPD</span><span class="o">=</span>1
        <span class="nb">shift</span>
        <span class="p">;;</span>
      -v<span class="o">)</span>
        <span class="nv">DBM_REL_VERSION</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span>
        <span class="nv">DBM_REL_VERSION_UPD</span><span class="o">=</span>1
        <span class="nb">shift</span>
        <span class="p">;;</span>
      -a<span class="o">)</span>
        <span class="nv">DBM_REL_ADAPTER</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span>
        <span class="nv">DBM_REL_ADAPTER_UPD</span><span class="o">=</span>1
        <span class="nb">shift</span>
        <span class="p">;;</span>
      -b<span class="o">)</span>
        <span class="nv">DBM_REL_BRANCH</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span>
        <span class="nv">DBM_REL_BRANCH_UPD</span><span class="o">=</span>1
        <span class="nb">shift</span>
        <span class="p">;;</span>
      -i<span class="o">)</span>
        <span class="nv">DBM_REL_ID</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span>
        <span class="nb">shift</span>
        <span class="p">;;</span>
      -h<span class="o">)</span>
        _dbm_upd_release_help
        <span class="k">return</span> 1
        <span class="p">;;</span>
      --<span class="o">)</span>
        <span class="nv">DBM_REL_DIR</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span>
        <span class="nv">DBM_REL_DIR_UPD</span><span class="o">=</span>1
        <span class="nb">shift</span>
        <span class="p">;;</span>
      *<span class="o">)</span>
        error_generate <span class="s2">&quot;Invalid parameter </span><span class="nv">$1</span><span class="s2">.&quot;</span>
        <span class="p">;;</span>

    <span class="k">esac</span>

    <span class="nb">shift</span>

  <span class="k">done</span>

  <span class="k">if</span> <span class="o">[</span> -z <span class="s2">&quot;</span><span class="nv">$DBM_REL_ID</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;Missing Release Id.&quot;</span>
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="k">if</span> <span class="o">[[</span> <span class="nv">$DBM_REL_NAME_UPD</span> -eq <span class="m">0</span> <span class="o">&amp;&amp;</span> <span class="nv">$DBM_REL_DATE_UPD</span> -eq <span class="m">0</span> <span class="o">&amp;&amp;</span>
        <span class="nv">$DBM_REL_VERSION_UPD</span> -eq <span class="m">0</span> <span class="o">&amp;&amp;</span> <span class="nv">$DBM_REL_ADAPTER_UPD</span> -eq <span class="m">0</span> <span class="o">&amp;&amp;</span>
        <span class="nv">$DBM_REL_BRANCH_UPD</span> -eq <span class="m">0</span> <span class="o">&amp;&amp;</span> <span class="nv">$DBM_REL_DIR_UPD</span> -eq <span class="m">0</span> <span class="o">]]</span> <span class="p">;</span> <span class="k">then</span>

    <span class="nb">echo</span> -en <span class="s2">&quot;No fields to update.\n&quot;</span>
    <span class="k">return</span> 1

  <span class="k">fi</span>

  <span class="k">return</span> 0
<span class="o">}</span>

_dbm_mv_release_help <span class="o">()</span> <span class="o">{</span>
  <span class="nb">echo</span> -en <span class="s2">&quot;[-r version]            Release version.\n&quot;</span>
  <span class="nb">echo</span> -en <span class="s2">&quot;[-n name]               Release Name.\n&quot;</span>
  <span class="nb">echo</span> -en <span class="s2">&quot;[-a version_to]         After release version_to.\n&quot;</span>
  <span class="nb">echo</span> -en <span class="s2">&quot;[-b version_to]         Before release version_to.\n&quot;</span>
  <span class="nb">echo</span> -en <span class="s2">&quot;\n&quot;</span>
  <span class="nb">echo</span> -en <span class="s2">&quot;Example: -n &#39;Project1&#39; -r &#39;0.1.1&#39; -a &#39;0.1.0&#39; (Release 0.1.1 after release 0.1.0)\n&quot;</span>

  <span class="k">return</span> 0
<span class="o">}</span>

_dbm_check_move_release_args <span class="o">()</span> <span class="o">{</span>

  <span class="o">[[</span> <span class="nv">$DEBUG</span> <span class="o">&amp;&amp;</span> <span class="nv">$DEBUG</span> <span class="o">==</span> <span class="nb">true</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> -en <span class="s2">&quot;(_dbm_check_ins_inhibit_script_args args: </span><span class="nv">$@</span><span class="s2">)\n&quot;</span>

  <span class="nv">DBM_BEFORE</span><span class="o">=</span>0
  <span class="nv">DBM_AFTER</span><span class="o">=</span>0

  <span class="c1"># Reinitialize opt index position</span>
  <span class="nv">OPTIND</span><span class="o">=</span>1
  <span class="k">while</span> <span class="nb">getopts</span> <span class="s2">&quot;b:n:a:r:h&quot;</span> opts <span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span> <span class="p">;</span> <span class="k">do</span>
    <span class="k">case</span> <span class="nv">$opts</span> in

      n<span class="o">)</span> <span class="nv">DBM_REL_NAME</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$OPTARG</span><span class="s2">&quot;</span><span class="p">;;</span>
      b<span class="o">)</span> <span class="nv">DBM_BEFORE</span><span class="o">=</span>1
         <span class="nv">DBM_REL_VERSION_TO</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$OPTARG</span><span class="s2">&quot;</span><span class="p">;;</span>
      a<span class="o">)</span> <span class="nv">DBM_AFTER</span><span class="o">=</span>1
         <span class="nv">DBM_REL_VERSION_TO</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$OPTARG</span><span class="s2">&quot;</span><span class="p">;;</span>
      r<span class="o">)</span> <span class="nv">DBM_REL_VERSION_FROM</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$OPTARG</span><span class="s2">&quot;</span><span class="p">;;</span>
      h<span class="o">)</span>
        _dbm_mv_release_help
        <span class="k">return</span> 1
        <span class="p">;;</span>

    <span class="k">esac</span>
  <span class="k">done</span>

  <span class="k">if</span> <span class="o">[</span> -z <span class="s2">&quot;</span><span class="nv">$DBM_REL_NAME</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    _dbm_mv_release_help
    <span class="c1">#echo &quot;Missing Release Name.&quot;</span>
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="k">if</span> <span class="o">[</span> -z <span class="s2">&quot;</span><span class="nv">$DBM_REL_VERSION_FROM</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;Missing Release version.&quot;</span>
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="k">if</span> <span class="o">[[</span> <span class="nv">$DBM_BEFORE</span> <span class="o">==</span> <span class="m">1</span> <span class="o">&amp;&amp;</span> <span class="nv">$DBM_AFTER</span> <span class="o">==</span> <span class="m">1</span> <span class="o">]]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;Both after and before are used. Error.&quot;</span>
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="k">if</span> <span class="o">[[</span> <span class="nv">$DBM_BEFORE</span> <span class="o">==</span> <span class="m">0</span> <span class="o">&amp;&amp;</span> <span class="nv">$DBM_AFTER</span> <span class="o">==</span> <span class="m">0</span> <span class="o">]]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;Missing -a or -b parameter.&quot;</span>
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="k">return</span> 0

<span class="o">}</span>

_dbm_check_inhibit_script_args <span class="o">()</span> <span class="o">{</span>

  <span class="o">[[</span> <span class="nv">$DEBUG</span> <span class="o">&amp;&amp;</span> <span class="nv">$DEBUG</span> <span class="o">==</span> <span class="nb">true</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> -en <span class="s2">&quot;(_dbm_check_ins_inhibit_script_args args: </span><span class="nv">$@</span><span class="s2">)\n&quot;</span>

  <span class="c1"># Reinitialize opt index position</span>
  <span class="nv">OPTIND</span><span class="o">=</span>1
  <span class="k">while</span> <span class="nb">getopts</span> <span class="s2">&quot;i:n:t:f:h&quot;</span> opts <span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span> <span class="p">;</span> <span class="k">do</span>
    <span class="k">case</span> <span class="nv">$opts</span> in

      i<span class="o">)</span> <span class="nv">DBM_SCRIPT_ID</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$OPTARG</span><span class="s2">&quot;</span><span class="p">;;</span>
      n<span class="o">)</span> <span class="nv">DBM_REL_NAME</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$OPTARG</span><span class="s2">&quot;</span><span class="p">;;</span>
      t<span class="o">)</span> <span class="nv">DBM_REL_VERSION_TO</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$OPTARG</span><span class="s2">&quot;</span><span class="p">;;</span>
      f<span class="o">)</span> <span class="nv">DBM_REL_VERSION_FROM</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$OPTARG</span><span class="s2">&quot;</span><span class="p">;;</span>
      h<span class="o">)</span>
        <span class="nb">echo</span> -en <span class="s2">&quot;[-n name]               Release Name.\n&quot;</span>
        <span class="nb">echo</span> -en <span class="s2">&quot;[-i id_script]          Script Id.\n&quot;</span>
        <span class="nb">echo</span> -en <span class="s2">&quot;[-t version_to]         Release version target of the installation.\n&quot;</span>
        <span class="nb">echo</span> -en <span class="s2">&quot;[-f version_from]       Release version source of the installation.\n&quot;</span>
        <span class="k">return</span> 1
        <span class="p">;;</span>

    <span class="k">esac</span>
  <span class="k">done</span>

  <span class="k">if</span> <span class="o">[</span> -z <span class="s2">&quot;</span><span class="nv">$DBM_SCRIPT_ID</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;Missing Script Id.&quot;</span>
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="k">if</span> <span class="o">[</span> -z <span class="s2">&quot;</span><span class="nv">$DBM_REL_NAME</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;Missing Release Name.&quot;</span>
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="k">if</span> <span class="o">[</span> -z <span class="s2">&quot;</span><span class="nv">$DBM_REL_VERSION_TO</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;Missing Release version that has a dependency.&quot;</span>
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="k">if</span> <span class="o">[</span> -z <span class="s2">&quot;</span><span class="nv">$DBM_REL_VERSION_FROM</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;Missing Release version needed on target.&quot;</span>
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="k">if</span> <span class="o">[</span> <span class="s2">&quot;</span><span class="nv">$DBM_REL_VERSION_FROM</span><span class="s2">&quot;</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="nv">$DBM_REL_VERSION_TO</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;Both version are equal. Error.&quot;</span>
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="k">return</span> 0
<span class="o">}</span>

_dbm_move_script_help <span class="o">()</span> <span class="o">{</span>

  <span class="nb">echo</span> -en <span class="s2">&quot;[-i id_script]          Id script of the script to move.\n&quot;</span>
  <span class="nb">echo</span> -en <span class="s2">&quot;[-a x]                  After script with id x.\n&quot;</span>
  <span class="nb">echo</span> -en <span class="s2">&quot;[-b x]                  Before script with id x.\n&quot;</span>
  <span class="nb">echo</span> -en <span class="s2">&quot;[-r id_release]         Id Release of the script to move.\n&quot;</span>

  <span class="k">return</span> 0
<span class="o">}</span>

_dbm_check_move_script_args <span class="o">()</span> <span class="o">{</span>

  <span class="o">[[</span> <span class="nv">$DEBUG</span> <span class="o">&amp;&amp;</span> <span class="nv">$DEBUG</span> <span class="o">==</span> <span class="nb">true</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> -en <span class="s2">&quot;(_dbm_check_move_script_args: </span><span class="nv">$@</span><span class="s2">)\n&quot;</span>

  <span class="nv">DBM_BEFORE</span><span class="o">=</span>0
  <span class="nv">DBM_AFTER</span><span class="o">=</span>0

  <span class="c1"># Reinitialize opt index position</span>
  <span class="nv">OPTIND</span><span class="o">=</span>1
  <span class="k">while</span> <span class="nb">getopts</span> <span class="s2">&quot;b:i:a:r:h&quot;</span> opts <span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span> <span class="p">;</span> <span class="k">do</span>
    <span class="k">case</span> <span class="nv">$opts</span> in

      r<span class="o">)</span> <span class="nv">DBM_REL_ID</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$OPTARG</span><span class="s2">&quot;</span><span class="p">;;</span>
      b<span class="o">)</span> <span class="nv">DBM_BEFORE</span><span class="o">=</span>1
         <span class="nv">DBM_SCRIPT_ID_TO</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$OPTARG</span><span class="s2">&quot;</span><span class="p">;;</span>
      a<span class="o">)</span> <span class="nv">DBM_AFTER</span><span class="o">=</span>1
         <span class="nv">DBM_SCRIPT_ID_TO</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$OPTARG</span><span class="s2">&quot;</span><span class="p">;;</span>
      i<span class="o">)</span> <span class="nv">DBM_SCRIPT_ID_FROM</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$OPTARG</span><span class="s2">&quot;</span><span class="p">;;</span>
      h<span class="o">)</span>
        _dbm_move_script_help
        <span class="k">return</span> 1
        <span class="p">;;</span>

    <span class="k">esac</span>
  <span class="k">done</span>

  <span class="k">if</span> <span class="o">[</span> -z <span class="s2">&quot;</span><span class="nv">$DBM_REL_ID</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;Missing Release Id.&quot;</span>
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="k">if</span> <span class="o">[</span> -z <span class="s2">&quot;</span><span class="nv">$DBM_SCRIPT_ID_FROM</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;Missing Script Id.&quot;</span>
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="k">if</span> <span class="o">[[</span> <span class="nv">$DBM_BEFORE</span> <span class="o">==</span> <span class="m">1</span> <span class="o">&amp;&amp;</span> <span class="nv">$DBM_AFTER</span> <span class="o">==</span> <span class="m">1</span> <span class="o">]]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;Both after and before are used. Error.&quot;</span>
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="k">if</span> <span class="o">[[</span> <span class="nv">$DBM_BEFORE</span> <span class="o">==</span> <span class="m">0</span> <span class="o">&amp;&amp;</span> <span class="nv">$DBM_AFTER</span> <span class="o">==</span> <span class="m">0</span> <span class="o">]]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;Missing -a or -b parameter.&quot;</span>
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="k">return</span> 0
<span class="o">}</span>

_dbm_rem_rel_help <span class="o">()</span> <span class="o">{</span>

  <span class="nb">echo</span> -en <span class="s2">&quot;[-r id_release]         Id Release of the script to remove.\n&quot;</span>
  <span class="nb">echo</span> -en <span class="s2">&quot;[-f]                    Force remove without confirmation question.\n&quot;</span>

  <span class="k">return</span> 0
<span class="o">}</span>

_dbm_check_rem_rel_args <span class="o">()</span> <span class="o">{</span>

  <span class="o">[[</span> <span class="nv">$DEBUG</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> -en <span class="s2">&quot;(_dbm_check_rem_rel_args args: </span><span class="nv">$@</span><span class="s2">)\n&quot;</span>

  <span class="nb">local</span> <span class="nv">short_options</span><span class="o">=</span><span class="s2">&quot;r:hf&quot;</span>

  <span class="k">$(</span><span class="nb">set</span> -- <span class="k">$(</span>getopt -u -q -a -o <span class="s2">&quot;</span><span class="nv">$short_options</span><span class="s2">&quot;</span> -- <span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span><span class="k">))</span> <span class="o">||</span> error_handled <span class="s2">&quot;Invalid parameters&quot;</span>

  <span class="k">if</span> <span class="o">[</span> <span class="nv">$#</span> -lt <span class="m">2</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    _dbm_rem_rel_help
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="o">[[</span> <span class="nv">$DEBUG</span> <span class="o">&amp;&amp;</span> <span class="nv">$DEBUG</span> <span class="o">==</span> <span class="nb">true</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> -en <span class="s2">&quot;(_dbm_check_rem_rel_args: Found </span><span class="nv">$#</span><span class="s2"> params)\n&quot;</span>

  <span class="nv">DBM_FORCE_RM</span><span class="o">=</span>0

  <span class="k">while</span> <span class="o">[</span> <span class="nv">$#</span> -gt <span class="m">0</span> <span class="o">]</span> <span class="p">;</span> <span class="k">do</span>
    <span class="k">case</span> <span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span> in

      -r<span class="o">)</span> <span class="nv">DBM_REL_ID</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span>    <span class="p">;</span>shift<span class="p">;;</span>
      -f<span class="o">)</span> <span class="nv">DBM_FORCE_RM</span><span class="o">=</span><span class="s2">&quot;1&quot;</span> <span class="p">;;</span>
      -h<span class="o">)</span>
        _dbm_rem_rel_help
        <span class="k">return</span> 1
        <span class="p">;;</span>
      --<span class="o">)</span> <span class="p">;;</span>
      *<span class="o">)</span>
        error_generate <span class="s2">&quot;Invalid parameter </span><span class="nv">$1</span><span class="s2">.&quot;</span>
        <span class="p">;;</span>
    <span class="k">esac</span>
    <span class="nb">shift</span>

  <span class="k">done</span>

  <span class="k">if</span> <span class="o">[</span> -z <span class="s2">&quot;</span><span class="nv">$DBM_REL_ID</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;Missing Release Id.&quot;</span>
    <span class="k">return</span> 1
  <span class="k">fi</span>

  <span class="k">return</span> 0
<span class="o">}</span>

_dbm_show_rel_help <span class="o">()</span> <span class="o">{</span>

  <span class="nb">echo</span> -en <span class="s2">&quot;[-b id_branch]          Id branch to filter.\n&quot;</span>

  <span class="k">return</span> 0
<span class="o">}</span>

_dbm_show_rel_args <span class="o">()</span> <span class="o">{</span>

  <span class="o">[[</span> <span class="nv">$DEBUG</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> -en <span class="s2">&quot;(_dbm_check_show_rel_args args: </span><span class="nv">$@</span><span class="s2">)\n&quot;</span>

  <span class="nb">local</span> <span class="nv">short_options</span><span class="o">=</span><span class="s2">&quot;b:h&quot;</span>

  <span class="k">$(</span><span class="nb">set</span> -- <span class="k">$(</span>getopt -u -q -a -o <span class="s2">&quot;</span><span class="nv">$short_options</span><span class="s2">&quot;</span> -- <span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span><span class="k">))</span> <span class="o">||</span> error_handled <span class="s2">&quot;Invalid parameters&quot;</span>

  <span class="o">[[</span> <span class="nv">$DEBUG</span> <span class="o">&amp;&amp;</span> <span class="nv">$DEBUG</span> <span class="o">==</span> <span class="nb">true</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> -en <span class="s2">&quot;(_dbm_check_show_rel_args: Found </span><span class="nv">$#</span><span class="s2"> params)\n&quot;</span>

  <span class="k">while</span> <span class="o">[</span> <span class="nv">$#</span> -gt <span class="m">0</span> <span class="o">]</span> <span class="p">;</span> <span class="k">do</span>
    <span class="k">case</span> <span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span> in

      -b<span class="o">)</span> <span class="nv">DBM_BRANCH_ID</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span>    <span class="p">;</span>shift<span class="p">;;</span>
      -h<span class="o">)</span>
        _dbm_show_rel_help
        <span class="k">return</span> 1
        <span class="p">;;</span>
      --<span class="o">)</span> <span class="p">;;</span>
      *<span class="o">)</span>
        error_generate <span class="s2">&quot;Invalid parameter </span><span class="nv">$1</span><span class="s2">.&quot;</span>
        <span class="p">;;</span>
    <span class="k">esac</span>
    <span class="nb">shift</span>

  <span class="k">done</span>

  <span class="k">return</span> 0
<span class="o">}</span>


<span class="c1"># vim: syn=sh filetype=sh</span>
</pre></div>
</div>
</div></div>
<div class="section" id="dbm-check-initenv-args">
<span id="dbm-check-initenv-args"></span><h3>_dbm_check_initenv_args<a class="headerlink" href="#dbm-check-initenv-args" title="Permalink to this headline">¶</a></h3>
<p>Internal function for parse command line arguments related to
<code class="docutils literal"><span class="pre">initenv</span></code> command.</p>
<p><em>Command Arguments</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">--to-current-dir</span></code>: Initialize current directory.</li>
<li><code class="docutils literal"><span class="pre">--to-dir</span> <span class="pre">target</span></code>: Initialize target directory.</li>
<li><code class="docutils literal"><span class="pre">--enable-profiles</span></code>: Enable profiles mode.</li>
<li><code class="docutils literal"><span class="pre">--help|-h</span></code>: Show help message.</li>
</ul>
<p><em>Variables Used</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">DBM_INIT_CURRDIR</span></code>: Set to 1 if &#8211;to-current-dir option is used. Default is 0.</li>
<li><code class="docutils literal"><span class="pre">DBM_INIT_DIR</span></code>: Set with target directory of the &#8211;to-dir option.</li>
<li><code class="docutils literal"><span class="pre">DBM_INIT_TARGETDIR</span></code>: Set to 1 if &#8211;to-dir option is used. Default is 0.</li>
<li><code class="docutils literal"><span class="pre">DBM_INIT_PROFILES</span></code>: Set to 1 if &#8211;enable-profiles is present. Default is 0.</li>
</ul>
<p><em>Return</em>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">0</span></code>: on success</li>
<li><code class="docutils literal"><span class="pre">1</span></code>: on error</li>
</ul>
<script type="text/javascript">
    function showhide(element){
        if (!document.getElementById)
            return
        if (element.style.display == "block")
            element.style.display = "none"
        else
            element.style.display = "block"
    };
</script>
<a href="javascript:showhide(document.getElementById('hiddencodeblock143'))">(Show/Hide)</a><br /><div id="hiddencodeblock143" style="display: none"><div class="highlight-bash"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div></div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
      dbrm
        &copy; Copyright 2017, Geaaru.<br/>
      Last updated on May 01, 2017.<br/>
    </p>
  </div>
</footer>
  </body>
</html>